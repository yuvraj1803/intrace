digraph cflow {
    node [shape="box"]
    aa32_id_visibility [label="unsigned int aa32_id_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:1478"]
    aa32_id_visibility -> kvm_supports_32bit_el0
    aa32_id_visibility -> id_visibility
    kvm_supports_32bit_el0 [label="kvm_supports_32bit_el0()"]
    id_visibility [label="unsigned int id_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:1463"]
    id_visibility -> reg_to_encoding
    id_visibility -> vcpu_has_sve
    reg_to_encoding [label="reg_to_encoding()"]
    vcpu_has_sve [label="vcpu_has_sve()"]
    access_actlr [label="bool access_actlr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:277"]
    access_actlr -> ignore_write
    access_actlr -> get_access_mask
    access_actlr -> vcpu_read_sys_reg
    ignore_write [label="ignore_write()"]
    get_access_mask [label="void get_access_mask (const struct sys_reg_desc *r, u64 *mask, u64 *shift)
sys_regs.c:229"]
    get_access_mask -> GENMASK_ULL
    GENMASK_ULL [label="GENMASK_ULL()"]
    vcpu_read_sys_reg [label="u64 vcpu_read_sys_reg (const struct kvm_vcpu *vcpu, int reg)
sys_regs.c:68"]
    vcpu_read_sys_reg -> vcpu_get_flag
    vcpu_get_flag [label="vcpu_get_flag()"]
    access_arch_timer [label="bool access_arch_timer (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1242"]
    access_arch_timer -> reg_to_encoding
    access_arch_timer -> print_sys_reg_msg
    access_arch_timer -> kvm_inject_undefined
    access_arch_timer -> kvm_arm_timer_write_sysreg
    access_arch_timer -> kvm_arm_timer_read_sysreg
    print_sys_reg_msg [label="print_sys_reg_msg()"]
    kvm_inject_undefined [label="void kvm_inject_undefined (struct kvm_vcpu *vcpu)
inject_fault.c:225"]
    kvm_inject_undefined -> vcpu_el1_is_32bit
    kvm_inject_undefined -> inject_undef32
    kvm_inject_undefined -> inject_undef64
    vcpu_el1_is_32bit [label="vcpu_el1_is_32bit()"]
    inject_undef32 [label="void inject_undef32 (struct kvm_vcpu *vcpu)
inject_fault.c:119"]
    inject_undef32 -> kvm_pend_exception
    kvm_pend_exception [label="kvm_pend_exception()"]
    inject_undef64 [label="void inject_undef64 (struct kvm_vcpu *vcpu)
inject_fault.c:95"]
    inject_undef64 -> pend_sync_exception
    inject_undef64 -> kvm_vcpu_trap_il_is32bit
    inject_undef64 -> match_target_el
    inject_undef64 -> unpack_vcpu_flag
    inject_undef64 -> vcpu_write_sys_reg
    pend_sync_exception [label="void pend_sync_exception (struct kvm_vcpu *vcpu)
inject_fault.c:18"]
    pend_sync_exception -> likely
    pend_sync_exception -> vcpu_has_nv
    pend_sync_exception -> kvm_pend_exception
    pend_sync_exception -> vcpu_cpsr
    pend_sync_exception -> vcpu_el2_tge_is_set
    pend_sync_exception -> BUG
    likely [label="likely()"]
    vcpu_has_nv [label="vcpu_has_nv()"]
    vcpu_cpsr [label="vcpu_cpsr()"]
    vcpu_el2_tge_is_set [label="vcpu_el2_tge_is_set()"]
    BUG [label="BUG()"]
    kvm_vcpu_trap_il_is32bit [label="kvm_vcpu_trap_il_is32bit()"]
    match_target_el [label="bool match_target_el (struct kvm_vcpu *vcpu, unsigned long target)
inject_fault.c:52"]
    match_target_el -> vcpu_get_flag
    unpack_vcpu_flag [label="unpack_vcpu_flag()"]
    vcpu_write_sys_reg [label="void vcpu_write_sys_reg (struct kvm_vcpu *vcpu, u64 val, int reg)
sys_regs.c:79"]
    vcpu_write_sys_reg -> vcpu_get_flag
    kvm_arm_timer_write_sysreg [label="void kvm_arm_timer_write_sysreg (struct kvm_vcpu *vcpu, enum kvm_arch_timers tmr, enum kvm_arch_timer_regs treg, u64 val)
arch_timer.c:1220"]
    kvm_arm_timer_write_sysreg -> get_timer_map
    kvm_arm_timer_write_sysreg -> vcpu_get_timer
    kvm_arm_timer_write_sysreg -> soft_timer_cancel
    kvm_arm_timer_write_sysreg -> kvm_arm_timer_write
    kvm_arm_timer_write_sysreg -> timer_emulate
    kvm_arm_timer_write_sysreg -> preempt_disable
    kvm_arm_timer_write_sysreg -> timer_save_state
    kvm_arm_timer_write_sysreg -> timer_restore_state
    kvm_arm_timer_write_sysreg -> preempt_enable
    get_timer_map [label="void get_timer_map (struct kvm_vcpu *vcpu, struct timer_map *map)
arch_timer.c:178"]
    get_timer_map -> vcpu_has_nv
    get_timer_map -> is_hyp_ctxt
    get_timer_map -> vcpu_hvtimer
    get_timer_map -> vcpu_hptimer
    get_timer_map -> vcpu_vtimer
    get_timer_map -> vcpu_ptimer
    get_timer_map -> has_vhe
    get_timer_map -> trace_kvm_get_timer_map
    is_hyp_ctxt [label="is_hyp_ctxt()"]
    vcpu_hvtimer [label="vcpu_hvtimer()"]
    vcpu_hptimer [label="vcpu_hptimer()"]
    vcpu_vtimer [label="vcpu_vtimer()"]
    vcpu_ptimer [label="vcpu_ptimer()"]
    has_vhe [label="has_vhe()"]
    trace_kvm_get_timer_map [label="trace_kvm_get_timer_map()"]
    vcpu_get_timer [label="vcpu_get_timer()"]
    soft_timer_cancel [label="void soft_timer_cancel (struct hrtimer *hrt)
arch_timer.c:219"]
    soft_timer_cancel -> hrtimer_cancel
    hrtimer_cancel [label="hrtimer_cancel()"]
    kvm_arm_timer_write [label="void kvm_arm_timer_write (struct kvm_vcpu *vcpu, struct arch_timer_context *timer, enum kvm_arch_timer_regs treg, u64 val)
arch_timer.c:1193"]
    kvm_arm_timer_write -> timer_set_cval
    kvm_arm_timer_write -> kvm_phys_timer_read
    kvm_arm_timer_write -> timer_get_offset
    kvm_arm_timer_write -> timer_set_ctl
    kvm_arm_timer_write -> BUG
    timer_set_cval [label="void timer_set_cval (struct arch_timer_context *ctxt, u64 cval)
arch_timer.c:141"]
    timer_set_cval -> arch_timer_ctx_index
    timer_set_cval -> WARN_ON
    arch_timer_ctx_index [label="arch_timer_ctx_index()"]
    WARN_ON [label="WARN_ON()"]
    kvm_phys_timer_read [label="u64 kvm_phys_timer_read (void)
arch_timer.c:173"]
    timer_get_offset [label="u64 timer_get_offset (struct arch_timer_context *ctxt)
arch_timer.c:104"]
    timer_set_ctl [label="void timer_set_ctl (struct arch_timer_context *ctxt, u32 ctl)
arch_timer.c:119"]
    timer_set_ctl -> arch_timer_ctx_index
    timer_set_ctl -> WARN_ON
    timer_emulate [label="void timer_emulate (struct arch_timer_context *ctx)
arch_timer.c:465"]
    timer_emulate -> kvm_timer_should_fire
    timer_emulate -> trace_kvm_timer_emulate
    timer_emulate -> kvm_timer_update_irq
    timer_emulate -> kvm_timer_irq_can_fire
    timer_emulate -> soft_timer_start
    timer_emulate -> kvm_timer_compute_delta
    kvm_timer_should_fire [label="bool kvm_timer_should_fire (struct arch_timer_context *timer_ctx)
arch_timer.c:381"]
    kvm_timer_should_fire -> arch_timer_ctx_index
    kvm_timer_should_fire -> read_sysreg_el0
    kvm_timer_should_fire -> kvm_timer_irq_can_fire
    kvm_timer_should_fire -> timer_get_cval
    kvm_timer_should_fire -> kvm_phys_timer_read
    kvm_timer_should_fire -> timer_get_offset
    read_sysreg_el0 [label="read_sysreg_el0()"]
    kvm_timer_irq_can_fire [label="bool kvm_timer_irq_can_fire (struct arch_timer_context *timer_ctx)
arch_timer.c:279"]
    kvm_timer_irq_can_fire -> WARN_ON
    kvm_timer_irq_can_fire -> timer_get_ctl
    timer_get_ctl [label="u32 timer_get_ctl (struct arch_timer_context *ctxt)
arch_timer.c:66"]
    timer_get_ctl -> arch_timer_ctx_index
    timer_get_ctl -> WARN_ON
    timer_get_cval [label="u64 timer_get_cval (struct arch_timer_context *ctxt)
arch_timer.c:85"]
    timer_get_cval -> arch_timer_ctx_index
    timer_get_cval -> WARN_ON
    trace_kvm_timer_emulate [label="trace_kvm_timer_emulate()"]
    kvm_timer_update_irq [label="void kvm_timer_update_irq (struct kvm_vcpu *vcpu, bool new_level, struct arch_timer_context *timer_ctx)
arch_timer.c:446"]
    kvm_timer_update_irq -> trace_kvm_timer_update_irq
    kvm_timer_update_irq -> timer_irq
    kvm_timer_update_irq -> userspace_irqchip
    kvm_timer_update_irq -> kvm_vgic_inject_irq
    kvm_timer_update_irq -> WARN_ON
    trace_kvm_timer_update_irq [label="trace_kvm_timer_update_irq()"]
    timer_irq [label="timer_irq()"]
    userspace_irqchip [label="inline bool userspace_irqchip (struct kvm *kvm)
arch_timer.c:207"]
    userspace_irqchip -> static_branch_unlikely
    userspace_irqchip -> unlikely
    userspace_irqchip -> irqchip_in_kernel
    static_branch_unlikely [label="static_branch_unlikely()"]
    unlikely [label="unlikely()"]
    irqchip_in_kernel [label="irqchip_in_kernel()"]
    kvm_vgic_inject_irq [label="kvm_vgic_inject_irq()"]
    soft_timer_start [label="void soft_timer_start (struct hrtimer *hrt, u64 ns)
arch_timer.c:213"]
    soft_timer_start -> hrtimer_start
    soft_timer_start -> ktime_add_ns
    soft_timer_start -> ktime_get
    hrtimer_start [label="hrtimer_start()"]
    ktime_add_ns [label="ktime_add_ns()"]
    ktime_get [label="ktime_get()"]
    kvm_timer_compute_delta [label="u64 kvm_timer_compute_delta (struct arch_timer_context *timer_ctx)
arch_timer.c:274"]
    kvm_timer_compute_delta -> kvm_counter_compute_delta
    kvm_timer_compute_delta -> timer_get_cval
    kvm_counter_compute_delta [label="u64 kvm_counter_compute_delta (struct arch_timer_context *timer_ctx, u64 val)
arch_timer.c:256"]
    kvm_counter_compute_delta -> kvm_phys_timer_read
    kvm_counter_compute_delta -> timer_get_offset
    kvm_counter_compute_delta -> cyclecounter_cyc2ns
    cyclecounter_cyc2ns [label="cyclecounter_cyc2ns()"]
    preempt_disable [label="preempt_disable()"]
    timer_save_state [label="void timer_save_state (struct arch_timer_context *ctx)
arch_timer.c:498"]
    timer_save_state -> vcpu_timer
    timer_save_state -> arch_timer_ctx_index
    timer_save_state -> local_irq_save
    timer_save_state -> timer_set_ctl
    timer_save_state -> read_sysreg_el0
    timer_save_state -> timer_set_cval
    timer_save_state -> write_sysreg_el0
    timer_save_state -> isb
    timer_save_state -> set_cntvoff
    timer_save_state -> timer_get_offset
    timer_save_state -> set_cntpoff
    timer_save_state -> BUG
    timer_save_state -> trace_kvm_timer_save_state
    timer_save_state -> local_irq_restore
    vcpu_timer [label="vcpu_timer()"]
    local_irq_save [label="local_irq_save()"]
    write_sysreg_el0 [label="write_sysreg_el0()"]
    isb [label="isb()"]
    set_cntvoff [label="void set_cntvoff (u64 cntvoff)
arch_timer.c:487"]
    set_cntvoff -> kvm_call_hyp
    kvm_call_hyp [label="kvm_call_hyp()"]
    set_cntpoff [label="void set_cntpoff (u64 cntpoff)
arch_timer.c:492"]
    set_cntpoff -> has_cntpoff
    set_cntpoff -> write_sysreg_s
    has_cntpoff [label="has_cntpoff()"]
    write_sysreg_s [label="write_sysreg_s()"]
    trace_kvm_timer_save_state [label="trace_kvm_timer_save_state()"]
    local_irq_restore [label="local_irq_restore()"]
    timer_restore_state [label="void timer_restore_state (struct arch_timer_context *ctx)
arch_timer.c:604"]
    timer_restore_state -> vcpu_timer
    timer_restore_state -> arch_timer_ctx_index
    timer_restore_state -> local_irq_save
    timer_restore_state -> set_cntvoff
    timer_restore_state -> timer_get_offset
    timer_restore_state -> write_sysreg_el0
    timer_restore_state -> timer_get_cval
    timer_restore_state -> isb
    timer_restore_state -> timer_get_ctl
    timer_restore_state -> set_cntpoff
    timer_restore_state -> BUG
    timer_restore_state -> trace_kvm_timer_restore_state
    timer_restore_state -> local_irq_restore
    trace_kvm_timer_restore_state [label="trace_kvm_timer_restore_state()"]
    preempt_enable [label="preempt_enable()"]
    kvm_arm_timer_read_sysreg [label="u64 kvm_arm_timer_read_sysreg (struct kvm_vcpu *vcpu, enum kvm_arch_timers tmr, enum kvm_arch_timer_regs treg)
arch_timer.c:1168"]
    kvm_arm_timer_read_sysreg -> get_timer_map
    kvm_arm_timer_read_sysreg -> vcpu_get_timer
    kvm_arm_timer_read_sysreg -> kvm_arm_timer_read
    kvm_arm_timer_read_sysreg -> preempt_disable
    kvm_arm_timer_read_sysreg -> timer_save_state
    kvm_arm_timer_read_sysreg -> timer_restore_state
    kvm_arm_timer_read_sysreg -> preempt_enable
    kvm_arm_timer_read [label="u64 kvm_arm_timer_read (struct kvm_vcpu *vcpu, struct arch_timer_context *timer, enum kvm_arch_timer_regs treg)
arch_timer.c:1133"]
    kvm_arm_timer_read -> timer_get_cval
    kvm_arm_timer_read -> kvm_phys_timer_read
    kvm_arm_timer_read -> timer_get_offset
    kvm_arm_timer_read -> lower_32_bits
    kvm_arm_timer_read -> read_timer_ctl
    kvm_arm_timer_read -> BUG
    lower_32_bits [label="lower_32_bits()"]
    read_timer_ctl [label="u64 read_timer_ctl (struct arch_timer_context *timer)
arch_timer.c:1092"]
    read_timer_ctl -> timer_get_ctl
    read_timer_ctl -> kvm_timer_compute_delta
    access_ccsidr [label="bool access_ccsidr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1846"]
    access_ccsidr -> write_to_read_only
    access_ccsidr -> vcpu_read_sys_reg
    access_ccsidr -> get_ccsidr
    write_to_read_only [label="bool write_to_read_only (struct kvm_vcpu *vcpu, struct sys_reg_params *params, const struct sys_reg_desc *r)
sys_regs.c:58"]
    write_to_read_only -> WARN_ONCE
    write_to_read_only -> print_sys_reg_instr
    write_to_read_only -> kvm_inject_undefined
    WARN_ONCE [label="WARN_ONCE()"]
    print_sys_reg_instr [label="print_sys_reg_instr()"]
    get_ccsidr [label="u32 get_ccsidr (struct kvm_vcpu *vcpu, u32 csselr)
sys_regs.c:117"]
    get_ccsidr -> get_min_cache_line_size
    get_ccsidr -> SYS_FIELD_PREP
    get_min_cache_line_size [label="u8 get_min_cache_line_size (bool icache)
sys_regs.c:95"]
    get_min_cache_line_size -> read_sanitised_ftr_reg
    get_min_cache_line_size -> SYS_FIELD_GET
    read_sanitised_ftr_reg [label="read_sanitised_ftr_reg()"]
    SYS_FIELD_GET [label="SYS_FIELD_GET()"]
    SYS_FIELD_PREP [label="SYS_FIELD_PREP()"]
    access_clidr [label="bool access_clidr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1754"]
    access_clidr -> write_to_read_only
    access_csselr [label="bool access_csselr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1834"]
    access_csselr -> vcpu_write_sys_reg
    access_csselr -> vcpu_read_sys_reg
    access_ctr [label="bool access_ctr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1744"]
    access_ctr -> write_to_read_only
    access_ctr -> read_sanitised_ftr_reg
    access_dcgsw [label="bool access_dcgsw (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:216"]
    access_dcgsw -> kvm_has_mte
    access_dcgsw -> kvm_inject_undefined
    access_dcgsw -> access_dcsw
    kvm_has_mte [label="kvm_has_mte()"]
    access_dcsw [label="bool access_dcsw (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:196"]
    access_dcsw -> read_from_write_only
    access_dcsw -> cpus_have_final_cap
    access_dcsw -> kvm_set_way_flush
    read_from_write_only [label="bool read_from_write_only (struct kvm_vcpu *vcpu, struct sys_reg_params *params, const struct sys_reg_desc *r)
sys_regs.c:48"]
    read_from_write_only -> WARN_ONCE
    read_from_write_only -> print_sys_reg_instr
    read_from_write_only -> kvm_inject_undefined
    cpus_have_final_cap [label="cpus_have_final_cap()"]
    kvm_set_way_flush [label="void kvm_set_way_flush (struct kvm_vcpu *vcpu)
mmu.c:2101"]
    kvm_set_way_flush -> vcpu_hcr
    kvm_set_way_flush -> trace_kvm_set_way_flush
    kvm_set_way_flush -> vcpu_pc
    kvm_set_way_flush -> vcpu_has_cache_enabled
    kvm_set_way_flush -> stage2_flush_vm
    vcpu_hcr [label="vcpu_hcr()"]
    trace_kvm_set_way_flush [label="trace_kvm_set_way_flush()"]
    vcpu_pc [label="vcpu_pc()"]
    vcpu_has_cache_enabled [label="vcpu_has_cache_enabled()"]
    stage2_flush_vm [label="void stage2_flush_vm (struct kvm *kvm)
mmu.c:352"]
    stage2_flush_vm -> srcu_read_lock
    stage2_flush_vm -> write_lock
    stage2_flush_vm -> kvm_memslots
    stage2_flush_vm -> kvm_for_each_memslot
    stage2_flush_vm -> stage2_flush_memslot
    stage2_flush_vm -> write_unlock
    stage2_flush_vm -> srcu_read_unlock
    srcu_read_lock [label="srcu_read_lock()"]
    write_lock [label="write_lock()"]
    kvm_memslots [label="kvm_memslots()"]
    kvm_for_each_memslot [label="kvm_for_each_memslot()"]
    stage2_flush_memslot [label="void stage2_flush_memslot (struct kvm *kvm, struct kvm_memory_slot *memslot)
mmu.c:336"]
    stage2_flush_memslot -> stage2_apply_range_resched
    stage2_apply_range_resched [label="stage2_apply_range_resched()"]
    write_unlock [label="write_unlock()"]
    srcu_read_unlock [label="srcu_read_unlock()"]
    access_elr [label="bool access_elr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:2000"]
    access_elr -> vcpu_write_sys_reg
    access_elr -> vcpu_read_sys_reg
    access_gic_sgi [label="bool access_gic_sgi (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:298"]
    access_gic_sgi -> read_from_write_only
    access_gic_sgi -> vgic_v3_dispatch_sgi
    vgic_v3_dispatch_sgi [label="vgic_v3_dispatch_sgi()"]
    access_gic_sre [label="bool access_gic_sre (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:343"]
    access_gic_sre -> ignore_write
    access_id_reg [label="bool access_id_reg (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1500"]
    access_id_reg -> write_to_read_only
    access_id_reg -> read_id_reg
    access_id_reg -> vcpu_has_nv
    access_id_reg -> access_nested_id_reg
    read_id_reg [label="u64 read_id_reg (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:1440"]
    read_id_reg -> IDREG
    read_id_reg -> reg_to_encoding
    IDREG [label="IDREG()"]
    access_nested_id_reg [label="void access_nested_id_reg (struct kvm_vcpu *v, struct sys_reg_params *p, const struct sys_reg_desc *r)
nested.c:26"]
    access_nested_id_reg -> reg_to_encoding
    access_nested_id_reg -> NV_FTR
    access_nested_id_reg -> GENMASK_ULL
    access_nested_id_reg -> FIELD_PREP
    access_nested_id_reg -> FIELD_GET
    NV_FTR [label="NV_FTR()"]
    FIELD_PREP [label="FIELD_PREP()"]
    FIELD_GET [label="FIELD_GET()"]
    access_pmceid [label="bool access_pmceid (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:854"]
    access_pmceid -> BUG_ON
    access_pmceid -> pmu_access_el0_disabled
    access_pmceid -> get_access_mask
    access_pmceid -> kvm_pmu_get_pmceid
    BUG_ON [label="BUG_ON()"]
    pmu_access_el0_disabled [label="bool pmu_access_el0_disabled (struct kvm_vcpu *vcpu)
sys_regs.c:789"]
    pmu_access_el0_disabled -> check_pmu_access_disabled
    check_pmu_access_disabled [label="bool check_pmu_access_disabled (struct kvm_vcpu *vcpu, u64 flags)
sys_regs.c:778"]
    check_pmu_access_disabled -> vcpu_mode_priv
    check_pmu_access_disabled -> kvm_inject_undefined
    vcpu_mode_priv [label="vcpu_mode_priv()"]
    kvm_pmu_get_pmceid [label="u64 kvm_pmu_get_pmceid (struct kvm_vcpu *vcpu, bool pmceid1)
pmu-emul.c:761"]
    kvm_pmu_get_pmceid -> kvm_vcpu_has_pmu
    kvm_pmu_get_pmceid -> read_sysreg
    kvm_pmu_get_pmceid -> BIT
    kvm_pmu_get_pmceid -> BIT_ULL
    kvm_pmu_get_pmceid -> kvm_pmu_event_mask
    kvm_pmu_get_pmceid -> bitmap_get_value8
    kvm_vcpu_has_pmu [label="kvm_vcpu_has_pmu()"]
    read_sysreg [label="read_sysreg()"]
    BIT [label="BIT()"]
    BIT_ULL [label="BIT_ULL()"]
    kvm_pmu_event_mask [label="u32 kvm_pmu_event_mask (struct kvm *kvm)
pmu-emul.c:55"]
    kvm_pmu_event_mask -> IDREG
    kvm_pmu_event_mask -> SYS_FIELD_GET
    bitmap_get_value8 [label="bitmap_get_value8()"]
    access_pmcnten [label="bool access_pmcnten (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1027"]
    access_pmcnten -> pmu_access_el0_disabled
    access_pmcnten -> kvm_pmu_valid_counter_mask
    access_pmcnten -> kvm_pmu_enable_counter_mask
    access_pmcnten -> kvm_vcpu_pmu_restore_guest
    access_pmcnten -> kvm_pmu_disable_counter_mask
    kvm_pmu_valid_counter_mask [label="u64 kvm_pmu_valid_counter_mask (struct kvm_vcpu *vcpu)
pmu-emul.c:268"]
    kvm_pmu_valid_counter_mask -> kvm_vcpu_read_pmcr
    kvm_pmu_valid_counter_mask -> BIT
    kvm_pmu_valid_counter_mask -> GENMASK
    kvm_vcpu_read_pmcr [label="u64 kvm_vcpu_read_pmcr (struct kvm_vcpu *vcpu)
pmu-emul.c:1137"]
    GENMASK [label="GENMASK()"]
    kvm_pmu_enable_counter_mask [label="void kvm_pmu_enable_counter_mask (struct kvm_vcpu *vcpu, u64 val)
pmu-emul.c:286"]
    kvm_pmu_enable_counter_mask -> kvm_vcpu_has_pmu
    kvm_pmu_enable_counter_mask -> kvm_vcpu_read_pmcr
    kvm_pmu_enable_counter_mask -> BIT
    kvm_pmu_enable_counter_mask -> kvm_vcpu_idx_to_pmc
    kvm_pmu_enable_counter_mask -> kvm_pmu_create_perf_event
    kvm_pmu_enable_counter_mask -> perf_event_enable
    kvm_pmu_enable_counter_mask -> kvm_debug
    kvm_vcpu_idx_to_pmc [label="struct kvm_pmc *kvm_vcpu_idx_to_pmc (struct kvm_vcpu *vcpu, int cnt_idx)
pmu-emul.c:34"]
    kvm_pmu_create_perf_event [label="void kvm_pmu_create_perf_event (struct kvm_pmc *pmc)
pmu-emul.c:597"]
    kvm_pmu_create_perf_event -> kvm_pmc_to_vcpu
    kvm_pmu_create_perf_event -> counter_index_to_evtreg
    kvm_pmu_create_perf_event -> kvm_pmu_stop_counter
    kvm_pmu_create_perf_event -> kvm_pmu_event_mask
    kvm_pmu_create_perf_event -> test_bit
    kvm_pmu_create_perf_event -> memset
    kvm_pmu_create_perf_event -> kvm_pmu_counter_is_enabled
    kvm_pmu_create_perf_event -> kvm_pmc_is_64bit
    kvm_pmu_create_perf_event -> compute_period
    kvm_pmu_create_perf_event -> kvm_pmu_get_pmc_value
    kvm_pmu_create_perf_event -> perf_event_create_kernel_counter
    kvm_pmu_create_perf_event -> kvm_pmu_perf_overflow
    kvm_pmu_create_perf_event -> IS_ERR
    kvm_pmu_create_perf_event -> pr_err_once
    kvm_pmu_create_perf_event -> PTR_ERR
    kvm_pmc_to_vcpu [label="struct kvm_vcpu *kvm_pmc_to_vcpu (const struct kvm_pmc *pmc)
pmu-emul.c:29"]
    kvm_pmc_to_vcpu -> container_of
    container_of [label="container_of()"]
    counter_index_to_evtreg [label="u32 counter_index_to_evtreg (u64 idx)
pmu-emul.c:109"]
    kvm_pmu_stop_counter [label="void kvm_pmu_stop_counter (struct kvm_pmc *pmc)
pmu-emul.c:209"]
    kvm_pmu_stop_counter -> kvm_pmc_to_vcpu
    kvm_pmu_stop_counter -> kvm_pmu_get_pmc_value
    kvm_pmu_stop_counter -> counter_index_to_reg
    kvm_pmu_stop_counter -> kvm_pmu_release_perf_event
    kvm_pmu_get_pmc_value [label="u64 kvm_pmu_get_pmc_value (struct kvm_pmc *pmc)
pmu-emul.c:114"]
    kvm_pmu_get_pmc_value -> kvm_pmc_to_vcpu
    kvm_pmu_get_pmc_value -> counter_index_to_reg
    kvm_pmu_get_pmc_value -> perf_event_read_value
    kvm_pmu_get_pmc_value -> kvm_pmc_is_64bit
    kvm_pmu_get_pmc_value -> lower_32_bits
    counter_index_to_reg [label="u32 counter_index_to_reg (u64 idx)
pmu-emul.c:104"]
    perf_event_read_value [label="perf_event_read_value()"]
    kvm_pmc_is_64bit [label="bool kvm_pmc_is_64bit (struct kvm_pmc *pmc)
pmu-emul.c:84"]
    kvm_pmc_is_64bit -> kvm_pmu_is_3p5
    kvm_pmc_is_64bit -> kvm_pmc_to_vcpu
    kvm_pmu_is_3p5 [label="kvm_pmu_is_3p5()"]
    kvm_pmu_release_perf_event [label="void kvm_pmu_release_perf_event (struct kvm_pmc *pmc)
pmu-emul.c:194"]
    kvm_pmu_release_perf_event -> perf_event_disable
    kvm_pmu_release_perf_event -> perf_event_release_kernel
    perf_event_disable [label="perf_event_disable()"]
    perf_event_release_kernel [label="perf_event_release_kernel()"]
    test_bit [label="test_bit()"]
    memset [label="memset()"]
    kvm_pmu_counter_is_enabled [label="bool kvm_pmu_counter_is_enabled (struct kvm_pmc *pmc)
pmu-emul.c:586"]
    kvm_pmu_counter_is_enabled -> kvm_pmc_to_vcpu
    kvm_pmu_counter_is_enabled -> kvm_vcpu_read_pmcr
    kvm_pmu_counter_is_enabled -> BIT
    compute_period [label="u64 compute_period (struct kvm_pmc *pmc, u64 counter)
pmu-emul.c:482"]
    compute_period -> kvm_pmc_is_64bit
    compute_period -> kvm_pmc_has_64bit_overflow
    compute_period -> GENMASK
    kvm_pmc_has_64bit_overflow [label="bool kvm_pmc_has_64bit_overflow (struct kvm_pmc *pmc)
pmu-emul.c:90"]
    kvm_pmc_has_64bit_overflow -> kvm_vcpu_read_pmcr
    kvm_pmc_has_64bit_overflow -> kvm_pmc_to_vcpu
    perf_event_create_kernel_counter [label="perf_event_create_kernel_counter()"]
    kvm_pmu_perf_overflow [label="void kvm_pmu_perf_overflow (struct perf_event *perf_event, struct perf_sample_data *data, struct pt_regs *regs)
pmu-emul.c:497"]
    kvm_pmu_perf_overflow -> to_arm_pmu
    kvm_pmu_perf_overflow -> kvm_pmc_to_vcpu
    kvm_pmu_perf_overflow -> compute_period
    kvm_pmu_perf_overflow -> local64_read
    kvm_pmu_perf_overflow -> local64_set
    kvm_pmu_perf_overflow -> BIT
    kvm_pmu_perf_overflow -> kvm_pmu_counter_can_chain
    kvm_pmu_perf_overflow -> kvm_pmu_counter_increment
    kvm_pmu_perf_overflow -> kvm_pmu_overflow_status
    kvm_pmu_perf_overflow -> kvm_make_request
    kvm_pmu_perf_overflow -> in_nmi
    kvm_pmu_perf_overflow -> kvm_vcpu_kick
    kvm_pmu_perf_overflow -> irq_work_queue
    to_arm_pmu [label="to_arm_pmu()"]
    local64_read [label="local64_read()"]
    local64_set [label="local64_set()"]
    kvm_pmu_counter_can_chain [label="bool kvm_pmu_counter_can_chain (struct kvm_pmc *pmc)
pmu-emul.c:98"]
    kvm_pmu_counter_can_chain -> kvm_pmc_has_64bit_overflow
    kvm_pmu_counter_increment [label="void kvm_pmu_counter_increment (struct kvm_vcpu *vcpu, unsigned long mask, u32 event)
pmu-emul.c:441"]
    kvm_pmu_counter_increment -> kvm_vcpu_read_pmcr
    kvm_pmu_counter_increment -> for_each_set_bit
    kvm_pmu_counter_increment -> kvm_vcpu_idx_to_pmc
    kvm_pmu_counter_increment -> counter_index_to_evtreg
    kvm_pmu_counter_increment -> kvm_pmu_event_mask
    kvm_pmu_counter_increment -> counter_index_to_reg
    kvm_pmu_counter_increment -> kvm_pmc_is_64bit
    kvm_pmu_counter_increment -> lower_32_bits
    kvm_pmu_counter_increment -> kvm_pmc_has_64bit_overflow
    kvm_pmu_counter_increment -> BIT
    kvm_pmu_counter_increment -> kvm_pmu_counter_can_chain
    kvm_pmu_counter_increment -> kvm_pmu_counter_increment
    for_each_set_bit [label="for_each_set_bit()"]
    kvm_pmu_overflow_status [label="u64 kvm_pmu_overflow_status (struct kvm_vcpu *vcpu)
pmu-emul.c:340"]
    kvm_pmu_overflow_status -> kvm_vcpu_read_pmcr
    kvm_make_request [label="kvm_make_request()"]
    in_nmi [label="in_nmi()"]
    kvm_vcpu_kick [label="kvm_vcpu_kick()"]
    irq_work_queue [label="irq_work_queue()"]
    IS_ERR [label="IS_ERR()"]
    pr_err_once [label="pr_err_once()"]
    PTR_ERR [label="PTR_ERR()"]
    perf_event_enable [label="perf_event_enable()"]
    kvm_debug [label="kvm_debug()"]
    kvm_vcpu_pmu_restore_guest [label="void kvm_vcpu_pmu_restore_guest (struct kvm_vcpu *vcpu)
pmu.c:176"]
    kvm_vcpu_pmu_restore_guest -> kvm_arm_support_pmu_v3
    kvm_vcpu_pmu_restore_guest -> has_vhe
    kvm_vcpu_pmu_restore_guest -> preempt_disable
    kvm_vcpu_pmu_restore_guest -> kvm_get_pmu_events
    kvm_vcpu_pmu_restore_guest -> kvm_vcpu_pmu_enable_el0
    kvm_vcpu_pmu_restore_guest -> kvm_vcpu_pmu_disable_el0
    kvm_vcpu_pmu_restore_guest -> preempt_enable
    kvm_arm_support_pmu_v3 [label="kvm_arm_support_pmu_v3()"]
    kvm_get_pmu_events [label="struct kvm_pmu_events *kvm_get_pmu_events (void)
pmu.c:29"]
    kvm_get_pmu_events -> this_cpu_ptr
    this_cpu_ptr [label="this_cpu_ptr()"]
    kvm_vcpu_pmu_enable_el0 [label="void kvm_vcpu_pmu_enable_el0 (unsigned long events)
pmu.c:143"]
    kvm_vcpu_pmu_enable_el0 -> for_each_set_bit
    kvm_vcpu_pmu_enable_el0 -> kvm_vcpu_pmu_read_evtype_direct
    kvm_vcpu_pmu_enable_el0 -> kvm_vcpu_pmu_write_evtype_direct
    kvm_vcpu_pmu_read_evtype_direct [label="u64 kvm_vcpu_pmu_read_evtype_direct (int idx)
pmu.c:111"]
    kvm_vcpu_pmu_read_evtype_direct -> PMEVTYPER_CASES
    kvm_vcpu_pmu_read_evtype_direct -> read_sysreg
    kvm_vcpu_pmu_read_evtype_direct -> WARN_ON
    PMEVTYPER_CASES [label="PMEVTYPER_CASES()"]
    kvm_vcpu_pmu_write_evtype_direct [label="void kvm_vcpu_pmu_write_evtype_direct (int idx, u32 val)
pmu.c:128"]
    kvm_vcpu_pmu_write_evtype_direct -> PMEVTYPER_CASES
    kvm_vcpu_pmu_write_evtype_direct -> write_sysreg
    kvm_vcpu_pmu_write_evtype_direct -> WARN_ON
    write_sysreg [label="write_sysreg()"]
    kvm_vcpu_pmu_disable_el0 [label="void kvm_vcpu_pmu_disable_el0 (unsigned long events)
pmu.c:158"]
    kvm_vcpu_pmu_disable_el0 -> for_each_set_bit
    kvm_vcpu_pmu_disable_el0 -> kvm_vcpu_pmu_read_evtype_direct
    kvm_vcpu_pmu_disable_el0 -> kvm_vcpu_pmu_write_evtype_direct
    kvm_pmu_disable_counter_mask [label="void kvm_pmu_disable_counter_mask (struct kvm_vcpu *vcpu, u64 val)
pmu-emul.c:320"]
    kvm_pmu_disable_counter_mask -> kvm_vcpu_has_pmu
    kvm_pmu_disable_counter_mask -> BIT
    kvm_pmu_disable_counter_mask -> kvm_vcpu_idx_to_pmc
    kvm_pmu_disable_counter_mask -> perf_event_disable
    access_pmcr [label="bool access_pmcr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:809"]
    access_pmcr -> pmu_access_el0_disabled
    access_pmcr -> kvm_vcpu_read_pmcr
    access_pmcr -> kvm_supports_32bit_el0
    access_pmcr -> kvm_pmu_handle_pmcr
    kvm_pmu_handle_pmcr [label="void kvm_pmu_handle_pmcr (struct kvm_vcpu *vcpu, u64 val)
pmu-emul.c:552"]
    kvm_pmu_handle_pmcr -> kvm_vcpu_has_pmu
    kvm_pmu_handle_pmcr -> kvm_pmu_is_3p5
    kvm_pmu_handle_pmcr -> kvm_pmu_enable_counter_mask
    kvm_pmu_handle_pmcr -> kvm_pmu_disable_counter_mask
    kvm_pmu_handle_pmcr -> kvm_pmu_set_counter_value
    kvm_pmu_handle_pmcr -> kvm_pmu_valid_counter_mask
    kvm_pmu_handle_pmcr -> BIT
    kvm_pmu_handle_pmcr -> for_each_set_bit
    kvm_pmu_handle_pmcr -> kvm_pmu_set_pmc_value
    kvm_pmu_handle_pmcr -> kvm_vcpu_idx_to_pmc
    kvm_pmu_handle_pmcr -> kvm_vcpu_pmu_restore_guest
    kvm_pmu_set_counter_value [label="void kvm_pmu_set_counter_value (struct kvm_vcpu *vcpu, u64 select_idx, u64 val)
pmu-emul.c:182"]
    kvm_pmu_set_counter_value -> kvm_vcpu_has_pmu
    kvm_pmu_set_counter_value -> kvm_pmu_set_pmc_value
    kvm_pmu_set_counter_value -> kvm_vcpu_idx_to_pmc
    kvm_pmu_set_pmc_value [label="void kvm_pmu_set_pmc_value (struct kvm_pmc *pmc, u64 val, bool force)
pmu-emul.c:149"]
    kvm_pmu_set_pmc_value -> kvm_pmc_to_vcpu
    kvm_pmu_set_pmc_value -> kvm_pmu_release_perf_event
    kvm_pmu_set_pmc_value -> counter_index_to_reg
    kvm_pmu_set_pmc_value -> vcpu_mode_is_32bit
    kvm_pmu_set_pmc_value -> GENMASK
    kvm_pmu_set_pmc_value -> lower_32_bits
    kvm_pmu_set_pmc_value -> kvm_pmu_create_perf_event
    vcpu_mode_is_32bit [label="vcpu_mode_is_32bit()"]
    access_pminten [label="bool access_pminten (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1055"]
    access_pminten -> kvm_pmu_valid_counter_mask
    access_pminten -> check_pmu_access_disabled
    access_pmovs [label="bool access_pmovs (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1079"]
    access_pmovs -> kvm_pmu_valid_counter_mask
    access_pmovs -> pmu_access_el0_disabled
    access_pmselr [label="bool access_pmselr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:838"]
    access_pmselr -> pmu_access_event_counter_el0_disabled
    pmu_access_event_counter_el0_disabled [label="bool pmu_access_event_counter_el0_disabled (struct kvm_vcpu *vcpu)
sys_regs.c:804"]
    pmu_access_event_counter_el0_disabled -> check_pmu_access_disabled
    access_pmswinc [label="bool access_pmswinc (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1101"]
    access_pmswinc -> read_from_write_only
    access_pmswinc -> pmu_write_swinc_el0_disabled
    access_pmswinc -> kvm_pmu_valid_counter_mask
    access_pmswinc -> kvm_pmu_software_increment
    pmu_write_swinc_el0_disabled [label="bool pmu_write_swinc_el0_disabled (struct kvm_vcpu *vcpu)
sys_regs.c:794"]
    pmu_write_swinc_el0_disabled -> check_pmu_access_disabled
    kvm_pmu_software_increment [label="void kvm_pmu_software_increment (struct kvm_vcpu *vcpu, u64 val)
pmu-emul.c:542"]
    kvm_pmu_software_increment -> kvm_pmu_counter_increment
    access_pmu_evcntr [label="bool access_pmu_evcntr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:905"]
    access_pmu_evcntr -> pmu_access_event_counter_el0_disabled
    access_pmu_evcntr -> pmu_access_cycle_counter_el0_disabled
    access_pmu_evcntr -> WARN_ON
    access_pmu_evcntr -> pmu_counter_idx_valid
    access_pmu_evcntr -> pmu_access_el0_disabled
    access_pmu_evcntr -> kvm_pmu_set_counter_value
    access_pmu_evcntr -> kvm_pmu_get_counter_value
    pmu_access_cycle_counter_el0_disabled [label="bool pmu_access_cycle_counter_el0_disabled (struct kvm_vcpu *vcpu)
sys_regs.c:799"]
    pmu_access_cycle_counter_el0_disabled -> check_pmu_access_disabled
    pmu_counter_idx_valid [label="bool pmu_counter_idx_valid (struct kvm_vcpu *vcpu, u64 idx)
sys_regs.c:875"]
    pmu_counter_idx_valid -> kvm_vcpu_read_pmcr
    pmu_counter_idx_valid -> kvm_inject_undefined
    kvm_pmu_get_counter_value [label="u64 kvm_pmu_get_counter_value (struct kvm_vcpu *vcpu, u64 select_idx)
pmu-emul.c:141"]
    kvm_pmu_get_counter_value -> kvm_vcpu_has_pmu
    kvm_pmu_get_counter_value -> kvm_pmu_get_pmc_value
    kvm_pmu_get_counter_value -> kvm_vcpu_idx_to_pmc
    access_pmu_evtyper [label="bool access_pmu_evtyper (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:958"]
    access_pmu_evtyper -> pmu_access_el0_disabled
    access_pmu_evtyper -> BUG
    access_pmu_evtyper -> pmu_counter_idx_valid
    access_pmu_evtyper -> kvm_pmu_set_counter_event_type
    access_pmu_evtyper -> kvm_vcpu_pmu_restore_guest
    kvm_pmu_set_counter_event_type [label="void kvm_pmu_set_counter_event_type (struct kvm_vcpu *vcpu, u64 data, u64 select_idx)
pmu-emul.c:679"]
    kvm_pmu_set_counter_event_type -> kvm_vcpu_idx_to_pmc
    kvm_pmu_set_counter_event_type -> kvm_vcpu_has_pmu
    kvm_pmu_set_counter_event_type -> counter_index_to_evtreg
    kvm_pmu_set_counter_event_type -> kvm_pmu_evtyper_mask
    kvm_pmu_set_counter_event_type -> kvm_pmu_create_perf_event
    kvm_pmu_evtyper_mask [label="u64 kvm_pmu_evtyper_mask (struct kvm *kvm)
pmu-emul.c:63"]
    kvm_pmu_evtyper_mask -> kvm_pmu_event_mask
    kvm_pmu_evtyper_mask -> IDREG
    kvm_pmu_evtyper_mask -> SYS_FIELD_GET
    access_pmuserenr [label="bool access_pmuserenr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1117"]
    access_pmuserenr -> vcpu_mode_priv
    access_pmuserenr -> kvm_inject_undefined
    access_sp_el1 [label="bool access_sp_el1 (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1988"]
    access_spsr [label="bool access_spsr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:2012"]
    access_vm_reg [label="bool access_vm_reg (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:252"]
    access_vm_reg -> vcpu_has_cache_enabled
    access_vm_reg -> BUG_ON
    access_vm_reg -> get_access_mask
    access_vm_reg -> vcpu_read_sys_reg
    access_vm_reg -> vcpu_write_sys_reg
    access_vm_reg -> kvm_toggle_cache
    kvm_toggle_cache [label="void kvm_toggle_cache (struct kvm_vcpu *vcpu, bool was_enabled)
mmu.c:2122"]
    kvm_toggle_cache -> vcpu_has_cache_enabled
    kvm_toggle_cache -> stage2_flush_vm
    kvm_toggle_cache -> vcpu_hcr
    kvm_toggle_cache -> trace_kvm_toggle_cache
    kvm_toggle_cache -> vcpu_pc
    trace_kvm_toggle_cache [label="trace_kvm_toggle_cache()"]
    check_cnthctl_el1pcten [label="enum trap_behaviour check_cnthctl_el1pcten (struct kvm_vcpu *vcpu)
emulate-nested.c:397"]
    check_cnthctl_el1pcten -> get_sanitized_cnthctl
    get_sanitized_cnthctl [label="u64 get_sanitized_cnthctl (struct kvm_vcpu *vcpu)
emulate-nested.c:387"]
    get_sanitized_cnthctl -> vcpu_el2_e2h_is_set
    vcpu_el2_e2h_is_set [label="vcpu_el2_e2h_is_set()"]
    check_cnthctl_el1pten [label="enum trap_behaviour check_cnthctl_el1pten (struct kvm_vcpu *vcpu)
emulate-nested.c:405"]
    check_cnthctl_el1pten -> get_sanitized_cnthctl
    clean_dcache_guest_page [label="void clean_dcache_guest_page (void *va, size_t size)
mmu.c:273"]
    create_hyp_io_mappings [label="int create_hyp_io_mappings (phys_addr_t phys_addr, size_t size, void __iomem **kaddr, void __iomem **haddr)
mmu.c:740"]
    create_hyp_io_mappings -> is_protected_kvm_enabled
    create_hyp_io_mappings -> ioremap
    create_hyp_io_mappings -> is_kernel_in_hyp_mode
    create_hyp_io_mappings -> iounmap
    is_protected_kvm_enabled [label="is_protected_kvm_enabled()"]
    ioremap [label="ioremap()"]
    is_kernel_in_hyp_mode [label="is_kernel_in_hyp_mode()"]
    iounmap [label="iounmap()"]
    early_kvm_mode_cfg [label="int __init early_kvm_mode_cfg (char *arg)
arm.c:2609"]
    early_kvm_mode_cfg -> strcmp
    early_kvm_mode_cfg -> is_hyp_mode_available
    early_kvm_mode_cfg -> pr_warn_once
    early_kvm_mode_cfg -> is_kernel_in_hyp_mode
    early_kvm_mode_cfg -> WARN_ON
    strcmp [label="strcmp()"]
    is_hyp_mode_available [label="is_hyp_mode_available()"]
    pr_warn_once [label="pr_warn_once()"]
    el2_visibility [label="unsigned int el2_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1879"]
    el2_visibility -> vcpu_has_nv
    finalize_pkvm [label="int __init finalize_pkvm (void)
pkvm.c:250"]
    finalize_pkvm -> is_protected_kvm_enabled
    finalize_pkvm -> is_kvm_arm_initialised
    finalize_pkvm -> kmemleak_free_part
    finalize_pkvm -> kmemleak_free_part_phys
    finalize_pkvm -> pkvm_drop_host_privileges
    finalize_pkvm -> pr_err
    is_kvm_arm_initialised [label="bool is_kvm_arm_initialised (void)
arm.c:62"]
    kmemleak_free_part [label="kmemleak_free_part()"]
    kmemleak_free_part_phys [label="kmemleak_free_part_phys()"]
    pkvm_drop_host_privileges [label="int __init pkvm_drop_host_privileges (void)
pkvm.c:237"]
    pkvm_drop_host_privileges -> static_branch_enable
    pkvm_drop_host_privileges -> on_each_cpu
    static_branch_enable [label="static_branch_enable()"]
    on_each_cpu [label="on_each_cpu()"]
    pr_err [label="pr_err()"]
    get_bcr [label="int get_bcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 *val)
sys_regs.c:588"]
    get_bvr [label="int get_bvr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 *val)
sys_regs.c:551"]
    get_gic_ap0r [label="int get_gic_ap0r (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:241"]
    get_gic_ap0r -> vgic_v3_max_apr_idx
    get_gic_ap0r -> get_apr_reg
    vgic_v3_max_apr_idx [label="vgic_v3_max_apr_idx()"]
    get_apr_reg [label="u64 get_apr_reg (struct kvm_vcpu *vcpu, u8 apr, u8 idx)
vgic-sys-reg-v3.c:218"]
    get_gic_ap1r [label="int get_gic_ap1r (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:267"]
    get_gic_ap1r -> vgic_v3_max_apr_idx
    get_gic_ap1r -> get_apr_reg
    get_gic_bpr0 [label="int get_gic_bpr0 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:122"]
    get_gic_bpr0 -> vgic_get_vmcr
    get_gic_bpr0 -> FIELD_PREP
    vgic_get_vmcr [label="vgic_get_vmcr()"]
    get_gic_bpr1 [label="int get_gic_bpr1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:147"]
    get_gic_bpr1 -> vgic_get_vmcr
    get_gic_bpr1 -> FIELD_PREP
    get_gic_bpr1 -> min
    min [label="min()"]
    get_gic_ctlr [label="int get_gic_ctlr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *valp)
vgic-sys-reg-v3.c:59"]
    get_gic_ctlr -> vgic_get_vmcr
    get_gic_ctlr -> FIELD_PREP
    get_gic_ctlr -> FIELD_GET
    get_gic_grpen0 [label="int get_gic_grpen0 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:174"]
    get_gic_grpen0 -> vgic_get_vmcr
    get_gic_grpen0 -> FIELD_PREP
    get_gic_grpen1 [label="int get_gic_grpen1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:197"]
    get_gic_grpen1 -> vgic_get_vmcr
    get_gic_grpen1 -> FIELD_GET
    get_gic_pmr [label="int get_gic_pmr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:99"]
    get_gic_pmr -> vgic_get_vmcr
    get_gic_pmr -> FIELD_PREP
    get_gic_sre [label="int get_gic_sre (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
vgic-sys-reg-v3.c:290"]
    get_id_reg [label="int get_id_reg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 *val)
sys_regs.c:1672"]
    get_id_reg -> kvm_vm_has_ran_once
    get_id_reg -> read_id_reg
    get_id_reg -> mutex_lock
    get_id_reg -> mutex_unlock
    kvm_vm_has_ran_once [label="kvm_vm_has_ran_once()"]
    mutex_lock [label="mutex_lock()"]
    mutex_unlock [label="mutex_unlock()"]
    get_pmcr [label="int get_pmcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
sys_regs.c:1136"]
    get_pmcr -> kvm_vcpu_read_pmcr
    get_pmreg [label="int get_pmreg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
sys_regs.c:1019"]
    get_pmreg -> kvm_pmu_valid_counter_mask
    get_pmu_evcntr [label="int get_pmu_evcntr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 *val)
sys_regs.c:889"]
    get_pmu_evcntr -> kvm_pmu_get_counter_value
    get_raz_reg [label="int get_raz_reg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 *val)
sys_regs.c:1731"]
    get_wcr [label="int get_wcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 *val)
sys_regs.c:663"]
    get_wvr [label="int get_wvr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 *val)
sys_regs.c:626"]
    handle_hvc [label="int handle_hvc (struct kvm_vcpu *vcpu)
handle_exit.c:37"]
    handle_hvc -> trace_kvm_hvc_arm64
    handle_hvc -> vcpu_pc
    handle_hvc -> vcpu_get_reg
    handle_hvc -> kvm_vcpu_hvc_get_imm
    handle_hvc -> vcpu_has_nv
    handle_hvc -> vcpu_read_sys_reg
    handle_hvc -> kvm_inject_undefined
    handle_hvc -> kvm_inject_nested_sync
    handle_hvc -> kvm_vcpu_get_esr
    handle_hvc -> kvm_smccc_call_handler
    trace_kvm_hvc_arm64 [label="trace_kvm_hvc_arm64()"]
    vcpu_get_reg [label="vcpu_get_reg()"]
    kvm_vcpu_hvc_get_imm [label="kvm_vcpu_hvc_get_imm()"]
    kvm_inject_nested_sync [label="int kvm_inject_nested_sync (struct kvm_vcpu *vcpu, u64 esr_el2)
emulate-nested.c:2099"]
    kvm_inject_nested_sync -> kvm_inject_nested
    kvm_inject_nested [label="int kvm_inject_nested (struct kvm_vcpu *vcpu, u64 esr_el2, enum exception_type type)
emulate-nested.c:2038"]
    kvm_inject_nested -> vcpu_has_nv
    kvm_inject_nested -> kvm_err
    kvm_inject_nested -> vcpu_cpsr
    kvm_inject_nested -> vcpu_el2_e2h_is_set
    kvm_inject_nested -> vcpu_el2_tge_is_set
    kvm_inject_nested -> kvm_inject_el2_exception
    kvm_inject_nested -> preempt_disable
    kvm_inject_nested -> kvm_arch_vcpu_put
    kvm_inject_nested -> kvm_arch_vcpu_load
    kvm_inject_nested -> smp_processor_id
    kvm_inject_nested -> preempt_enable
    kvm_err [label="kvm_err()"]
    kvm_inject_el2_exception [label="void kvm_inject_el2_exception (struct kvm_vcpu *vcpu, u64 esr_el2, enum exception_type type)
emulate-nested.c:2016"]
    kvm_inject_el2_exception -> trace_kvm_inject_nested_exception
    kvm_inject_el2_exception -> kvm_pend_exception
    kvm_inject_el2_exception -> vcpu_write_sys_reg
    kvm_inject_el2_exception -> WARN_ONCE
    trace_kvm_inject_nested_exception [label="trace_kvm_inject_nested_exception()"]
    kvm_arch_vcpu_put [label="void kvm_arch_vcpu_put (struct kvm_vcpu *vcpu)
arm.c:473"]
    kvm_arch_vcpu_put -> kvm_arch_vcpu_put_debug_state_flags
    kvm_arch_vcpu_put -> kvm_arch_vcpu_put_fp
    kvm_arch_vcpu_put -> has_vhe
    kvm_arch_vcpu_put -> kvm_vcpu_put_vhe
    kvm_arch_vcpu_put -> kvm_timer_vcpu_put
    kvm_arch_vcpu_put -> kvm_vgic_put
    kvm_arch_vcpu_put -> kvm_vcpu_pmu_restore_host
    kvm_arch_vcpu_put -> kvm_arm_vmid_clear_active
    kvm_arch_vcpu_put -> vcpu_clear_on_unsupported_cpu
    kvm_arch_vcpu_put_debug_state_flags [label="void kvm_arch_vcpu_put_debug_state_flags (struct kvm_vcpu *vcpu)
debug.c:340"]
    kvm_arch_vcpu_put_debug_state_flags -> vcpu_clear_flag
    vcpu_clear_flag [label="vcpu_clear_flag()"]
    kvm_arch_vcpu_put_fp [label="void kvm_arch_vcpu_put_fp (struct kvm_vcpu *vcpu)
fpsimd.c:175"]
    kvm_arch_vcpu_put_fp -> local_irq_save
    kvm_arch_vcpu_put_fp -> has_vhe
    kvm_arch_vcpu_put_fp -> system_supports_sme
    kvm_arch_vcpu_put_fp -> vcpu_get_flag
    kvm_arch_vcpu_put_fp -> sysreg_clear_set
    kvm_arch_vcpu_put_fp -> isb
    kvm_arch_vcpu_put_fp -> vcpu_has_sve
    kvm_arch_vcpu_put_fp -> read_sysreg_el1
    kvm_arch_vcpu_put_fp -> sve_cond_update_zcr_vq
    kvm_arch_vcpu_put_fp -> vcpu_sve_max_vq
    kvm_arch_vcpu_put_fp -> fpsimd_save_and_flush_cpu_state
    kvm_arch_vcpu_put_fp -> system_supports_sve
    kvm_arch_vcpu_put_fp -> local_irq_restore
    system_supports_sme [label="system_supports_sme()"]
    sysreg_clear_set [label="sysreg_clear_set()"]
    read_sysreg_el1 [label="read_sysreg_el1()"]
    sve_cond_update_zcr_vq [label="sve_cond_update_zcr_vq()"]
    vcpu_sve_max_vq [label="vcpu_sve_max_vq()"]
    fpsimd_save_and_flush_cpu_state [label="fpsimd_save_and_flush_cpu_state()"]
    system_supports_sve [label="system_supports_sve()"]
    kvm_vcpu_put_vhe [label="kvm_vcpu_put_vhe()"]
    kvm_timer_vcpu_put [label="void kvm_timer_vcpu_put (struct kvm_vcpu *vcpu)
arch_timer.c:878"]
    kvm_timer_vcpu_put -> vcpu_timer
    kvm_timer_vcpu_put -> unlikely
    kvm_timer_vcpu_put -> get_timer_map
    kvm_timer_vcpu_put -> timer_save_state
    kvm_timer_vcpu_put -> soft_timer_cancel
    kvm_timer_vcpu_put -> kvm_vcpu_is_blocking
    kvm_timer_vcpu_put -> kvm_timer_blocking
    kvm_vcpu_is_blocking [label="kvm_vcpu_is_blocking()"]
    kvm_timer_blocking [label="void kvm_timer_blocking (struct kvm_vcpu *vcpu)
arch_timer.c:572"]
    kvm_timer_blocking -> vcpu_timer
    kvm_timer_blocking -> get_timer_map
    kvm_timer_blocking -> kvm_timer_irq_can_fire
    kvm_timer_blocking -> vcpu_has_wfit_active
    kvm_timer_blocking -> soft_timer_start
    kvm_timer_blocking -> kvm_timer_earliest_exp
    vcpu_has_wfit_active [label="bool vcpu_has_wfit_active (struct kvm_vcpu *vcpu)
arch_timer.c:287"]
    vcpu_has_wfit_active -> cpus_have_final_cap
    vcpu_has_wfit_active -> vcpu_get_flag
    kvm_timer_earliest_exp [label="u64 kvm_timer_earliest_exp (struct kvm_vcpu *vcpu)
arch_timer.c:308"]
    kvm_timer_earliest_exp -> nr_timers
    kvm_timer_earliest_exp -> WARN
    kvm_timer_earliest_exp -> kvm_timer_irq_can_fire
    kvm_timer_earliest_exp -> min
    kvm_timer_earliest_exp -> kvm_timer_compute_delta
    kvm_timer_earliest_exp -> vcpu_has_wfit_active
    kvm_timer_earliest_exp -> wfit_delay_ns
    nr_timers [label="int nr_timers (struct kvm_vcpu *vcpu)
arch_timer.c:58"]
    nr_timers -> vcpu_has_nv
    WARN [label="WARN()"]
    wfit_delay_ns [label="u64 wfit_delay_ns (struct kvm_vcpu *vcpu)
arch_timer.c:293"]
    wfit_delay_ns -> vcpu_get_reg
    wfit_delay_ns -> kvm_vcpu_sys_get_rt
    wfit_delay_ns -> vcpu_has_nv
    wfit_delay_ns -> is_hyp_ctxt
    wfit_delay_ns -> vcpu_hvtimer
    wfit_delay_ns -> vcpu_vtimer
    wfit_delay_ns -> kvm_counter_compute_delta
    kvm_vcpu_sys_get_rt [label="kvm_vcpu_sys_get_rt()"]
    kvm_vgic_put [label="kvm_vgic_put()"]
    kvm_vcpu_pmu_restore_host [label="void kvm_vcpu_pmu_restore_host (struct kvm_vcpu *vcpu)
pmu.c:197"]
    kvm_vcpu_pmu_restore_host -> kvm_arm_support_pmu_v3
    kvm_vcpu_pmu_restore_host -> has_vhe
    kvm_vcpu_pmu_restore_host -> kvm_get_pmu_events
    kvm_vcpu_pmu_restore_host -> kvm_vcpu_pmu_enable_el0
    kvm_vcpu_pmu_restore_host -> kvm_vcpu_pmu_disable_el0
    kvm_arm_vmid_clear_active [label="void kvm_arm_vmid_clear_active (void)
vmid.c:133"]
    kvm_arm_vmid_clear_active -> atomic64_set
    kvm_arm_vmid_clear_active -> this_cpu_ptr
    atomic64_set [label="atomic64_set()"]
    vcpu_clear_on_unsupported_cpu [label="vcpu_clear_on_unsupported_cpu()"]
    kvm_arch_vcpu_load [label="void kvm_arch_vcpu_load (struct kvm_vcpu *vcpu, int cpu)
arm.c:427"]
    kvm_arch_vcpu_load -> this_cpu_ptr
    kvm_arch_vcpu_load -> kvm_call_hyp
    kvm_arch_vcpu_load -> kvm_vgic_load
    kvm_arch_vcpu_load -> kvm_timer_vcpu_load
    kvm_arch_vcpu_load -> has_vhe
    kvm_arch_vcpu_load -> kvm_vcpu_load_vhe
    kvm_arch_vcpu_load -> kvm_arch_vcpu_load_fp
    kvm_arch_vcpu_load -> kvm_vcpu_pmu_restore_guest
    kvm_arch_vcpu_load -> kvm_arm_is_pvtime_enabled
    kvm_arch_vcpu_load -> kvm_make_request
    kvm_arch_vcpu_load -> single_task_running
    kvm_arch_vcpu_load -> vcpu_clear_wfx_traps
    kvm_arch_vcpu_load -> vcpu_set_wfx_traps
    kvm_arch_vcpu_load -> vcpu_has_ptrauth
    kvm_arch_vcpu_load -> vcpu_ptrauth_disable
    kvm_arch_vcpu_load -> kvm_arch_vcpu_load_debug_state_flags
    kvm_arch_vcpu_load -> cpumask_test_cpu
    kvm_arch_vcpu_load -> vcpu_set_on_unsupported_cpu
    kvm_vgic_load [label="kvm_vgic_load()"]
    kvm_timer_vcpu_load [label="void kvm_timer_vcpu_load (struct kvm_vcpu *vcpu)
arch_timer.c:827"]
    kvm_timer_vcpu_load -> vcpu_timer
    kvm_timer_vcpu_load -> unlikely
    kvm_timer_vcpu_load -> get_timer_map
    kvm_timer_vcpu_load -> static_branch_likely
    kvm_timer_vcpu_load -> vcpu_has_nv
    kvm_timer_vcpu_load -> kvm_timer_vcpu_load_nested_switch
    kvm_timer_vcpu_load -> kvm_timer_vcpu_load_gic
    kvm_timer_vcpu_load -> kvm_timer_vcpu_load_nogic
    kvm_timer_vcpu_load -> kvm_timer_unblocking
    kvm_timer_vcpu_load -> timer_restore_state
    kvm_timer_vcpu_load -> timer_emulate
    kvm_timer_vcpu_load -> timer_set_traps
    static_branch_likely [label="static_branch_likely()"]
    kvm_timer_vcpu_load_nested_switch [label="void kvm_timer_vcpu_load_nested_switch (struct kvm_vcpu *vcpu, struct timer_map *map)
arch_timer.c:714"]
    kvm_timer_vcpu_load_nested_switch -> irqchip_in_kernel
    kvm_timer_vcpu_load_nested_switch -> kvm_vgic_get_map
    kvm_timer_vcpu_load_nested_switch -> timer_irq
    kvm_timer_vcpu_load_nested_switch -> kvm_vgic_unmap_phys_irq
    kvm_timer_vcpu_load_nested_switch -> kvm_vgic_map_phys_irq
    kvm_timer_vcpu_load_nested_switch -> WARN_ON_ONCE
    kvm_timer_vcpu_load_nested_switch -> vcpu_hvtimer
    kvm_timer_vcpu_load_nested_switch -> vcpu_el2_e2h_is_set
    kvm_vgic_get_map [label="kvm_vgic_get_map()"]
    kvm_vgic_unmap_phys_irq [label="kvm_vgic_unmap_phys_irq()"]
    kvm_vgic_map_phys_irq [label="kvm_vgic_map_phys_irq()"]
    WARN_ON_ONCE [label="WARN_ON_ONCE()"]
    kvm_timer_vcpu_load_gic [label="void kvm_timer_vcpu_load_gic (struct arch_timer_context *ctx)
arch_timer.c:656"]
    kvm_timer_vcpu_load_gic -> kvm_timer_update_irq
    kvm_timer_vcpu_load_gic -> kvm_timer_should_fire
    kvm_timer_vcpu_load_gic -> irqchip_in_kernel
    kvm_timer_vcpu_load_gic -> kvm_vgic_map_is_active
    kvm_timer_vcpu_load_gic -> timer_irq
    kvm_timer_vcpu_load_gic -> set_timer_irq_phys_active
    kvm_vgic_map_is_active [label="kvm_vgic_map_is_active()"]
    set_timer_irq_phys_active [label="inline void set_timer_irq_phys_active (struct arch_timer_context *ctx, bool active)
arch_timer.c:649"]
    set_timer_irq_phys_active -> irq_set_irqchip_state
    set_timer_irq_phys_active -> WARN_ON
    irq_set_irqchip_state [label="irq_set_irqchip_state()"]
    kvm_timer_vcpu_load_nogic [label="void kvm_timer_vcpu_load_nogic (struct kvm_vcpu *vcpu)
arch_timer.c:677"]
    kvm_timer_vcpu_load_nogic -> vcpu_vtimer
    kvm_timer_vcpu_load_nogic -> kvm_timer_update_irq
    kvm_timer_vcpu_load_nogic -> kvm_timer_should_fire
    kvm_timer_vcpu_load_nogic -> disable_percpu_irq
    kvm_timer_vcpu_load_nogic -> enable_percpu_irq
    disable_percpu_irq [label="disable_percpu_irq()"]
    enable_percpu_irq [label="enable_percpu_irq()"]
    kvm_timer_unblocking [label="void kvm_timer_unblocking (struct kvm_vcpu *vcpu)
arch_timer.c:597"]
    kvm_timer_unblocking -> vcpu_timer
    kvm_timer_unblocking -> soft_timer_cancel
    timer_set_traps [label="void timer_set_traps (struct kvm_vcpu *vcpu, struct timer_map *map)
arch_timer.c:765"]
    timer_set_traps -> has_vhe
    timer_set_traps -> has_cntpoff
    timer_set_traps -> timer_get_offset
    timer_set_traps -> vcpu_has_nv
    timer_set_traps -> is_hyp_ctxt
    timer_set_traps -> vcpu_el2_e2h_is_set
    timer_set_traps -> assign_clear_set_bit
    timer_set_traps -> sysreg_clear_set
    assign_clear_set_bit [label="assign_clear_set_bit()"]
    kvm_vcpu_load_vhe [label="kvm_vcpu_load_vhe()"]
    kvm_arch_vcpu_load_fp [label="void kvm_arch_vcpu_load_fp (struct kvm_vcpu *vcpu)
fpsimd.c:75"]
    kvm_arch_vcpu_load_fp -> BUG_ON
    kvm_arch_vcpu_load_fp -> system_supports_fpsimd
    kvm_arch_vcpu_load_fp -> fpsimd_kvm_prepare
    kvm_arch_vcpu_load_fp -> vcpu_clear_flag
    kvm_arch_vcpu_load_fp -> read_sysreg
    kvm_arch_vcpu_load_fp -> vcpu_set_flag
    kvm_arch_vcpu_load_fp -> system_supports_sme
    kvm_arch_vcpu_load_fp -> read_sysreg_s
    kvm_arch_vcpu_load_fp -> fpsimd_save_and_flush_cpu_state
    system_supports_fpsimd [label="system_supports_fpsimd()"]
    fpsimd_kvm_prepare [label="fpsimd_kvm_prepare()"]
    vcpu_set_flag [label="vcpu_set_flag()"]
    read_sysreg_s [label="read_sysreg_s()"]
    kvm_arm_is_pvtime_enabled [label="kvm_arm_is_pvtime_enabled()"]
    single_task_running [label="single_task_running()"]
    vcpu_clear_wfx_traps [label="vcpu_clear_wfx_traps()"]
    vcpu_set_wfx_traps [label="vcpu_set_wfx_traps()"]
    vcpu_has_ptrauth [label="vcpu_has_ptrauth()"]
    vcpu_ptrauth_disable [label="vcpu_ptrauth_disable()"]
    kvm_arch_vcpu_load_debug_state_flags [label="void kvm_arch_vcpu_load_debug_state_flags (struct kvm_vcpu *vcpu)
debug.c:317"]
    kvm_arch_vcpu_load_debug_state_flags -> has_vhe
    kvm_arch_vcpu_load_debug_state_flags -> read_sysreg
    kvm_arch_vcpu_load_debug_state_flags -> cpuid_feature_extract_unsigned_field
    kvm_arch_vcpu_load_debug_state_flags -> read_sysreg_s
    kvm_arch_vcpu_load_debug_state_flags -> BIT
    kvm_arch_vcpu_load_debug_state_flags -> vcpu_set_flag
    cpuid_feature_extract_unsigned_field [label="cpuid_feature_extract_unsigned_field()"]
    cpumask_test_cpu [label="cpumask_test_cpu()"]
    vcpu_set_on_unsupported_cpu [label="vcpu_set_on_unsupported_cpu()"]
    smp_processor_id [label="smp_processor_id()"]
    kvm_vcpu_get_esr [label="kvm_vcpu_get_esr()"]
    kvm_smccc_call_handler [label="int kvm_smccc_call_handler (struct kvm_vcpu *vcpu)
hypercalls.c:263"]
    kvm_smccc_call_handler -> smccc_get_function
    kvm_smccc_call_handler -> kvm_smccc_get_action
    kvm_smccc_call_handler -> kvm_prepare_hypercall_exit
    kvm_smccc_call_handler -> WARN_RATELIMIT
    kvm_smccc_call_handler -> smccc_get_arg1
    kvm_smccc_call_handler -> arm64_get_spectre_v2_state
    kvm_smccc_call_handler -> arm64_get_spectre_v4_state
    kvm_smccc_call_handler -> cpus_have_final_cap
    kvm_smccc_call_handler -> arm64_get_spectre_bhb_state
    kvm_smccc_call_handler -> test_bit
    kvm_smccc_call_handler -> kvm_hypercall_pv_features
    kvm_smccc_call_handler -> kvm_init_stolen_time
    kvm_smccc_call_handler -> kvm_ptp_get_time
    kvm_smccc_call_handler -> kvm_trng_call
    kvm_smccc_call_handler -> kvm_psci_call
    kvm_smccc_call_handler -> smccc_set_retval
    smccc_get_function [label="smccc_get_function()"]
    kvm_smccc_get_action [label="u8 kvm_smccc_get_action (struct kvm_vcpu *vcpu, u32 func_id)
hypercalls.c:227"]
    kvm_smccc_get_action -> kvm_smccc_filter_get_action
    kvm_smccc_get_action -> kvm_smccc_test_fw_bmap
    kvm_smccc_get_action -> kvm_smccc_default_allowed
    kvm_smccc_filter_get_action [label="u8 kvm_smccc_filter_get_action (struct kvm *kvm, u32 func_id)
hypercalls.c:209"]
    kvm_smccc_filter_get_action -> kvm_smccc_filter_configured
    kvm_smccc_filter_get_action -> mt_find
    kvm_smccc_filter_get_action -> xa_to_value
    kvm_smccc_filter_configured [label="bool kvm_smccc_filter_configured (struct kvm *kvm)
hypercalls.c:165"]
    kvm_smccc_filter_configured -> mtree_empty
    mtree_empty [label="mtree_empty()"]
    mt_find [label="mt_find()"]
    xa_to_value [label="xa_to_value()"]
    kvm_smccc_test_fw_bmap [label="bool kvm_smccc_test_fw_bmap (struct kvm_vcpu *vcpu, u32 func_id)
hypercalls.c:96"]
    kvm_smccc_test_fw_bmap -> test_bit
    kvm_smccc_default_allowed [label="bool kvm_smccc_default_allowed (u32 func_id)
hypercalls.c:68"]
    kvm_smccc_default_allowed -> ARM_SMCCC_OWNER_NUM
    kvm_smccc_default_allowed -> ARM_SMCCC_FUNC_NUM
    kvm_smccc_default_allowed -> KVM_PSCI_FN
    ARM_SMCCC_OWNER_NUM [label="ARM_SMCCC_OWNER_NUM()"]
    ARM_SMCCC_FUNC_NUM [label="ARM_SMCCC_FUNC_NUM()"]
    KVM_PSCI_FN [label="KVM_PSCI_FN()"]
    kvm_prepare_hypercall_exit [label="void kvm_prepare_hypercall_exit (struct kvm_vcpu *vcpu, u32 func_id)
hypercalls.c:244"]
    kvm_prepare_hypercall_exit -> ESR_ELx_EC
    kvm_prepare_hypercall_exit -> kvm_vcpu_get_esr
    kvm_prepare_hypercall_exit -> kvm_vcpu_trap_il_is32bit
    kvm_prepare_hypercall_exit -> typeof
    ESR_ELx_EC [label="ESR_ELx_EC()"]
    typeof [label="typeof()"]
    WARN_RATELIMIT [label="WARN_RATELIMIT()"]
    smccc_get_arg1 [label="smccc_get_arg1()"]
    arm64_get_spectre_v2_state [label="arm64_get_spectre_v2_state()"]
    arm64_get_spectre_v4_state [label="arm64_get_spectre_v4_state()"]
    arm64_get_spectre_bhb_state [label="arm64_get_spectre_bhb_state()"]
    kvm_hypercall_pv_features [label="long kvm_hypercall_pv_features (struct kvm_vcpu *vcpu)
pvtime.c:35"]
    kvm_hypercall_pv_features -> smccc_get_arg1
    kvm_init_stolen_time [label="gpa_t kvm_init_stolen_time (struct kvm_vcpu *vcpu)
pvtime.c:51"]
    kvm_init_stolen_time -> kvm_write_guest_lock
    kvm_write_guest_lock [label="kvm_write_guest_lock()"]
    kvm_ptp_get_time [label="void kvm_ptp_get_time (struct kvm_vcpu *vcpu, u64 *val)
hypercalls.c:19"]
    kvm_ptp_get_time -> ktime_get_snapshot
    kvm_ptp_get_time -> smccc_get_arg1
    kvm_ptp_get_time -> upper_32_bits
    kvm_ptp_get_time -> lower_32_bits
    ktime_get_snapshot [label="ktime_get_snapshot()"]
    upper_32_bits [label="upper_32_bits()"]
    kvm_trng_call [label="int kvm_trng_call (struct kvm_vcpu *vcpu)
trng.c:51"]
    kvm_trng_call -> smccc_get_function
    kvm_trng_call -> smccc_get_arg1
    kvm_trng_call -> smccc_set_retval
    kvm_trng_call -> le32_to_cpu
    kvm_trng_call -> kvm_trng_do_rnd
    smccc_set_retval [label="smccc_set_retval()"]
    le32_to_cpu [label="le32_to_cpu()"]
    kvm_trng_do_rnd [label="int kvm_trng_do_rnd (struct kvm_vcpu *vcpu, int size)
trng.c:24"]
    kvm_trng_do_rnd -> DECLARE_BITMAP
    kvm_trng_do_rnd -> smccc_get_arg1
    kvm_trng_do_rnd -> smccc_set_retval
    kvm_trng_do_rnd -> DIV_ROUND_UP
    kvm_trng_do_rnd -> get_random_long
    kvm_trng_do_rnd -> bitmap_clear
    kvm_trng_do_rnd -> lower_32_bits
    kvm_trng_do_rnd -> upper_32_bits
    kvm_trng_do_rnd -> memzero_explicit
    DECLARE_BITMAP [label="DECLARE_BITMAP()"]
    DIV_ROUND_UP [label="DIV_ROUND_UP()"]
    get_random_long [label="get_random_long()"]
    bitmap_clear [label="bitmap_clear()"]
    memzero_explicit [label="memzero_explicit()"]
    kvm_psci_call [label="int kvm_psci_call (struct kvm_vcpu *vcpu)
psci.c:439"]
    kvm_psci_call -> smccc_get_function
    kvm_psci_call -> kvm_psci_version
    kvm_psci_call -> kvm_psci_check_allowed_function
    kvm_psci_call -> smccc_set_retval
    kvm_psci_call -> kvm_psci_1_x_call
    kvm_psci_call -> kvm_psci_0_2_call
    kvm_psci_call -> kvm_psci_0_1_call
    kvm_psci_call -> WARN_ONCE
    kvm_psci_version [label="kvm_psci_version()"]
    kvm_psci_check_allowed_function [label="unsigned long kvm_psci_check_allowed_function (struct kvm_vcpu *vcpu, u32 fn)
psci.c:229"]
    kvm_psci_check_allowed_function -> vcpu_mode_is_32bit
    kvm_psci_1_x_call [label="int kvm_psci_1_x_call (struct kvm_vcpu *vcpu, u32 minor)
psci.c:315"]
    kvm_psci_1_x_call -> smccc_get_function
    kvm_psci_1_x_call -> smccc_get_arg1
    kvm_psci_1_x_call -> kvm_psci_check_allowed_function
    kvm_psci_1_x_call -> test_bit
    kvm_psci_1_x_call -> kvm_psci_narrow_to_32bit
    kvm_psci_1_x_call -> kvm_psci_system_suspend
    kvm_psci_1_x_call -> kvm_psci_system_reset2
    kvm_psci_1_x_call -> vcpu_set_reg
    kvm_psci_1_x_call -> kvm_psci_0_2_call
    kvm_psci_1_x_call -> smccc_set_retval
    kvm_psci_narrow_to_32bit [label="void kvm_psci_narrow_to_32bit (struct kvm_vcpu *vcpu)
psci.c:217"]
    kvm_psci_narrow_to_32bit -> vcpu_set_reg
    kvm_psci_narrow_to_32bit -> lower_32_bits
    kvm_psci_narrow_to_32bit -> vcpu_get_reg
    vcpu_set_reg [label="vcpu_set_reg()"]
    kvm_psci_system_suspend [label="void kvm_psci_system_suspend (struct kvm_vcpu *vcpu)
psci.c:208"]
    kvm_psci_system_suspend -> memset
    kvm_psci_system_reset2 [label="void kvm_psci_system_reset2 (struct kvm_vcpu *vcpu)
psci.c:202"]
    kvm_psci_system_reset2 -> kvm_prepare_system_event
    kvm_prepare_system_event [label="void kvm_prepare_system_event (struct kvm_vcpu *vcpu, u32 type, u64 flags)
psci.c:164"]
    kvm_prepare_system_event -> kvm_for_each_vcpu
    kvm_prepare_system_event -> spin_lock
    kvm_prepare_system_event -> WRITE_ONCE
    kvm_prepare_system_event -> spin_unlock
    kvm_prepare_system_event -> kvm_make_all_cpus_request
    kvm_prepare_system_event -> memset
    kvm_for_each_vcpu [label="kvm_for_each_vcpu()"]
    spin_lock [label="spin_lock()"]
    WRITE_ONCE [label="WRITE_ONCE()"]
    spin_unlock [label="spin_unlock()"]
    kvm_make_all_cpus_request [label="kvm_make_all_cpus_request()"]
    kvm_psci_0_2_call [label="int kvm_psci_0_2_call (struct kvm_vcpu *vcpu)
psci.c:240"]
    kvm_psci_0_2_call -> smccc_get_function
    kvm_psci_0_2_call -> kvm_psci_vcpu_suspend
    kvm_psci_0_2_call -> kvm_arm_vcpu_power_off
    kvm_psci_0_2_call -> kvm_psci_narrow_to_32bit
    kvm_psci_0_2_call -> kvm_psci_vcpu_on
    kvm_psci_0_2_call -> kvm_psci_vcpu_affinity_info
    kvm_psci_0_2_call -> kvm_psci_system_off
    kvm_psci_0_2_call -> kvm_psci_system_reset
    kvm_psci_0_2_call -> smccc_set_retval
    kvm_psci_vcpu_suspend [label="unsigned long kvm_psci_vcpu_suspend (struct kvm_vcpu *vcpu)
psci.c:34"]
    kvm_psci_vcpu_suspend -> kvm_vcpu_wfi
    kvm_vcpu_wfi [label="void kvm_vcpu_wfi (struct kvm_vcpu *vcpu)
arm.c:764"]
    kvm_vcpu_wfi -> preempt_disable
    kvm_vcpu_wfi -> kvm_vgic_vmcr_sync
    kvm_vcpu_wfi -> vcpu_set_flag
    kvm_vcpu_wfi -> vgic_v4_put
    kvm_vcpu_wfi -> preempt_enable
    kvm_vcpu_wfi -> kvm_vcpu_halt
    kvm_vcpu_wfi -> vcpu_clear_flag
    kvm_vcpu_wfi -> vgic_v4_load
    kvm_vgic_vmcr_sync [label="kvm_vgic_vmcr_sync()"]
    vgic_v4_put [label="vgic_v4_put()"]
    kvm_vcpu_halt [label="kvm_vcpu_halt()"]
    vgic_v4_load [label="vgic_v4_load()"]
    kvm_arm_vcpu_power_off [label="void kvm_arm_vcpu_power_off (struct kvm_vcpu *vcpu)
arm.c:495"]
    kvm_arm_vcpu_power_off -> spin_lock
    kvm_arm_vcpu_power_off -> spin_unlock
    kvm_psci_vcpu_on [label="unsigned long kvm_psci_vcpu_on (struct kvm_vcpu *source_vcpu)
psci.c:60"]
    kvm_psci_vcpu_on -> smccc_get_arg1
    kvm_psci_vcpu_on -> kvm_psci_valid_affinity
    kvm_psci_vcpu_on -> kvm_mpidr_to_vcpu
    kvm_psci_vcpu_on -> spin_lock
    kvm_psci_vcpu_on -> kvm_arm_vcpu_stopped
    kvm_psci_vcpu_on -> kvm_psci_version
    kvm_psci_vcpu_on -> smccc_get_arg2
    kvm_psci_vcpu_on -> kvm_vcpu_is_be
    kvm_psci_vcpu_on -> smccc_get_arg3
    kvm_psci_vcpu_on -> kvm_make_request
    kvm_psci_vcpu_on -> smp_wmb
    kvm_psci_vcpu_on -> WRITE_ONCE
    kvm_psci_vcpu_on -> kvm_vcpu_wake_up
    kvm_psci_vcpu_on -> spin_unlock
    kvm_psci_valid_affinity [label="inline bool kvm_psci_valid_affinity (struct kvm_vcpu *vcpu, unsigned long affinity)
psci.c:54"]
    kvm_mpidr_to_vcpu [label="struct kvm_vcpu *kvm_mpidr_to_vcpu (struct kvm *kvm, unsigned long mpidr)
arm.c:2450"]
    kvm_mpidr_to_vcpu -> kvm_mpidr_index
    kvm_mpidr_to_vcpu -> kvm_get_vcpu
    kvm_mpidr_to_vcpu -> kvm_vcpu_get_mpidr_aff
    kvm_mpidr_to_vcpu -> kvm_for_each_vcpu
    kvm_mpidr_index [label="kvm_mpidr_index()"]
    kvm_get_vcpu [label="kvm_get_vcpu()"]
    kvm_vcpu_get_mpidr_aff [label="kvm_vcpu_get_mpidr_aff()"]
    kvm_arm_vcpu_stopped [label="bool kvm_arm_vcpu_stopped (struct kvm_vcpu *vcpu)
arm.c:502"]
    kvm_arm_vcpu_stopped -> READ_ONCE
    READ_ONCE [label="READ_ONCE()"]
    smccc_get_arg2 [label="smccc_get_arg2()"]
    kvm_vcpu_is_be [label="kvm_vcpu_is_be()"]
    smccc_get_arg3 [label="smccc_get_arg3()"]
    smp_wmb [label="smp_wmb()"]
    kvm_vcpu_wake_up [label="kvm_vcpu_wake_up()"]
    kvm_psci_vcpu_affinity_info [label="unsigned long kvm_psci_vcpu_affinity_info (struct kvm_vcpu *vcpu)
psci.c:121"]
    kvm_psci_vcpu_affinity_info -> smccc_get_arg1
    kvm_psci_vcpu_affinity_info -> smccc_get_arg2
    kvm_psci_vcpu_affinity_info -> kvm_psci_valid_affinity
    kvm_psci_vcpu_affinity_info -> psci_affinity_mask
    kvm_psci_vcpu_affinity_info -> kvm_for_each_vcpu
    kvm_psci_vcpu_affinity_info -> kvm_vcpu_get_mpidr_aff
    kvm_psci_vcpu_affinity_info -> kvm_arm_vcpu_stopped
    psci_affinity_mask [label="unsigned long psci_affinity_mask (unsigned long affinity_level)
psci.c:26"]
    psci_affinity_mask -> AFFINITY_MASK
    AFFINITY_MASK [label="AFFINITY_MASK()"]
    kvm_psci_system_off [label="void kvm_psci_system_off (struct kvm_vcpu *vcpu)
psci.c:192"]
    kvm_psci_system_off -> kvm_prepare_system_event
    kvm_psci_system_reset [label="void kvm_psci_system_reset (struct kvm_vcpu *vcpu)
psci.c:197"]
    kvm_psci_system_reset -> kvm_prepare_system_event
    kvm_psci_0_1_call [label="int kvm_psci_0_1_call (struct kvm_vcpu *vcpu)
psci.c:403"]
    kvm_psci_0_1_call -> smccc_get_function
    kvm_psci_0_1_call -> kvm_arm_vcpu_power_off
    kvm_psci_0_1_call -> kvm_psci_vcpu_on
    kvm_psci_0_1_call -> smccc_set_retval
    handle_no_fpsimd [label="int handle_no_fpsimd (struct kvm_vcpu *vcpu)
handle_exit.c:93"]
    handle_no_fpsimd -> kvm_inject_undefined
    handle_smc [label="int handle_smc (struct kvm_vcpu *vcpu)
handle_exit.c:56"]
    handle_smc -> kvm_incr_pc
    handle_smc -> kvm_vcpu_hvc_get_imm
    handle_smc -> vcpu_set_reg
    handle_smc -> kvm_smccc_call_handler
    kvm_incr_pc [label="kvm_incr_pc()"]
    handle_svc [label="int handle_svc (struct kvm_vcpu *vcpu)
handle_exit.c:244"]
    handle_svc -> kvm_inject_nested_sync
    handle_svc -> kvm_vcpu_get_esr
    handle_sve [label="int handle_sve (struct kvm_vcpu *vcpu)
handle_exit.c:203"]
    handle_sve -> kvm_inject_undefined
    hidden_user_visibility [label="unsigned int hidden_user_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1902"]
    hyp_init_cpu_pm_notifier [label="int hyp_init_cpu_pm_notifier (struct notifier_block *self, unsigned long cmd, void *v)
arm.c:2024"]
    hyp_init_cpu_pm_notifier -> cpu_hyp_reset
    hyp_init_cpu_pm_notifier -> cpu_hyp_reinit
    cpu_hyp_reset [label="void cpu_hyp_reset (void)
arm.c:1914"]
    cpu_hyp_reset -> is_kernel_in_hyp_mode
    cpu_hyp_reinit [label="void cpu_hyp_reinit (void)
arm.c:1971"]
    cpu_hyp_reinit -> cpu_hyp_reset
    cpu_hyp_reinit -> cpu_hyp_init_context
    cpu_hyp_reinit -> cpu_hyp_init_features
    cpu_hyp_init_context [label="void cpu_hyp_init_context (void)
arm.c:1951"]
    cpu_hyp_init_context -> kvm_init_host_cpu_context
    cpu_hyp_init_context -> this_cpu_ptr_hyp_sym
    cpu_hyp_init_context -> is_kernel_in_hyp_mode
    cpu_hyp_init_context -> cpu_init_hyp_mode
    kvm_init_host_cpu_context [label="kvm_init_host_cpu_context()"]
    this_cpu_ptr_hyp_sym [label="this_cpu_ptr_hyp_sym()"]
    cpu_init_hyp_mode [label="void cpu_init_hyp_mode (void)
arm.c:1900"]
    cpu_init_hyp_mode -> hyp_install_host_vector
    cpu_init_hyp_mode -> this_cpu_has_cap
    cpu_init_hyp_mode -> arm64_get_spectre_v4_state
    cpu_init_hyp_mode -> kvm_call_hyp_nvhe
    hyp_install_host_vector [label="void hyp_install_host_vector (void)
arm.c:1880"]
    hyp_install_host_vector -> kvm_get_idmap_vector
    hyp_install_host_vector -> BUG_ON
    hyp_install_host_vector -> system_capabilities_finalized
    hyp_install_host_vector -> this_cpu_ptr_nvhe_sym
    hyp_install_host_vector -> arm_smccc_1_1_hvc
    hyp_install_host_vector -> KVM_HOST_SMCCC_FUNC
    hyp_install_host_vector -> virt_to_phys
    hyp_install_host_vector -> WARN_ON
    kvm_get_idmap_vector [label="phys_addr_t kvm_get_idmap_vector (void)
mmu.c:1827"]
    system_capabilities_finalized [label="system_capabilities_finalized()"]
    this_cpu_ptr_nvhe_sym [label="this_cpu_ptr_nvhe_sym()"]
    arm_smccc_1_1_hvc [label="arm_smccc_1_1_hvc()"]
    KVM_HOST_SMCCC_FUNC [label="KVM_HOST_SMCCC_FUNC()"]
    virt_to_phys [label="virt_to_phys()"]
    this_cpu_has_cap [label="this_cpu_has_cap()"]
    kvm_call_hyp_nvhe [label="kvm_call_hyp_nvhe()"]
    cpu_hyp_init_features [label="void cpu_hyp_init_features (void)
arm.c:1959"]
    cpu_hyp_init_features -> cpu_set_hyp_vector
    cpu_hyp_init_features -> kvm_arm_init_debug
    cpu_hyp_init_features -> is_kernel_in_hyp_mode
    cpu_hyp_init_features -> kvm_timer_init_vhe
    cpu_hyp_init_features -> kvm_vgic_init_cpu_hardware
    cpu_set_hyp_vector [label="void cpu_set_hyp_vector (void)
arm.c:1940"]
    cpu_set_hyp_vector -> this_cpu_ptr
    cpu_set_hyp_vector -> is_protected_kvm_enabled
    cpu_set_hyp_vector -> this_cpu_ptr_hyp_sym
    cpu_set_hyp_vector -> kvm_call_hyp_nvhe
    kvm_arm_init_debug [label="void kvm_arm_init_debug (void)
debug.c:78"]
    kvm_arm_init_debug -> kvm_call_hyp_ret
    kvm_call_hyp_ret [label="kvm_call_hyp_ret()"]
    kvm_timer_init_vhe [label="void kvm_timer_init_vhe (void)
arch_timer.c:1554"]
    kvm_timer_init_vhe -> cpus_have_final_cap
    kvm_timer_init_vhe -> sysreg_clear_set
    kvm_vgic_init_cpu_hardware [label="kvm_vgic_init_cpu_hardware()"]
    invalidate_icache_guest_page [label="void invalidate_icache_guest_page (void *va, size_t size)
mmu.c:278"]
    is_aa32_id_reg [label="inline bool is_aa32_id_reg (u32 id)
sys_regs.c:1456"]
    is_aa32_id_reg -> sys_reg_Op0
    is_aa32_id_reg -> sys_reg_Op1
    is_aa32_id_reg -> sys_reg_CRn
    is_aa32_id_reg -> sys_reg_CRm
    sys_reg_Op0 [label="sys_reg_Op0()"]
    sys_reg_Op1 [label="sys_reg_Op1()"]
    sys_reg_CRn [label="sys_reg_CRn()"]
    sys_reg_CRm [label="sys_reg_CRm()"]
    is_feature_id_reg [label="bool is_feature_id_reg (u32 encoding)
sys_regs.c:3742"]
    is_feature_id_reg -> sys_reg_Op0
    is_feature_id_reg -> sys_reg_Op1
    is_feature_id_reg -> sys_reg_CRn
    is_feature_id_reg -> sys_reg_CRm
    kvm_age_gfn [label="bool kvm_age_gfn (struct kvm *kvm, struct kvm_gfn_range *range)
mmu.c:1798"]
    kvm_age_gfn -> kvm_pgtable_stage2_test_clear_young
    kvm_pgtable_stage2_test_clear_young [label="kvm_pgtable_stage2_test_clear_young()"]
    kvm_apply_hyp_relocations [label="__init void kvm_apply_hyp_relocations (void)
va_layout.c:89"]
    kvm_apply_hyp_relocations -> lm_alias
    lm_alias [label="lm_alias()"]
    kvm_arch_alloc_vm [label="struct kvm *kvm_arch_alloc_vm (void)
arm.c:337"]
    kvm_arch_alloc_vm -> has_vhe
    kvm_arch_alloc_vm -> kzalloc
    kzalloc [label="kzalloc()"]
    kvm_arch_commit_memory_region [label="void kvm_arch_commit_memory_region (struct kvm *kvm, struct kvm_memory_slot *old, const struct kvm_memory_slot *new, enum kvm_mr_change change)
mmu.c:1945"]
    kvm_arch_commit_memory_region -> kvm_dirty_log_manual_protect_and_init_set
    kvm_arch_commit_memory_region -> kvm_mmu_wp_memory_region
    kvm_arch_commit_memory_region -> kvm_mmu_split_memory_region
    kvm_arch_commit_memory_region -> kvm_mmu_free_memory_cache
    kvm_dirty_log_manual_protect_and_init_set [label="kvm_dirty_log_manual_protect_and_init_set()"]
    kvm_mmu_wp_memory_region [label="void kvm_mmu_wp_memory_region (struct kvm *kvm, int slot)
mmu.c:1126"]
    kvm_mmu_wp_memory_region -> kvm_memslots
    kvm_mmu_wp_memory_region -> id_to_memslot
    kvm_mmu_wp_memory_region -> WARN_ON_ONCE
    kvm_mmu_wp_memory_region -> write_lock
    kvm_mmu_wp_memory_region -> stage2_wp_range
    kvm_mmu_wp_memory_region -> write_unlock
    kvm_mmu_wp_memory_region -> kvm_flush_remote_tlbs_memslot
    id_to_memslot [label="id_to_memslot()"]
    stage2_wp_range [label="void stage2_wp_range (struct kvm_s2_mmu *mmu, phys_addr_t addr, phys_addr_t end)
mmu.c:1108"]
    stage2_wp_range -> stage2_apply_range_resched
    kvm_flush_remote_tlbs_memslot [label="kvm_flush_remote_tlbs_memslot()"]
    kvm_mmu_split_memory_region [label="void kvm_mmu_split_memory_region (struct kvm *kvm, int slot)
mmu.c:1153"]
    kvm_mmu_split_memory_region -> lockdep_assert_held
    kvm_mmu_split_memory_region -> kvm_memslots
    kvm_mmu_split_memory_region -> id_to_memslot
    kvm_mmu_split_memory_region -> write_lock
    kvm_mmu_split_memory_region -> kvm_mmu_split_huge_pages
    kvm_mmu_split_memory_region -> write_unlock
    lockdep_assert_held [label="lockdep_assert_held()"]
    kvm_mmu_split_huge_pages [label="int kvm_mmu_split_huge_pages (struct kvm *kvm, phys_addr_t addr, phys_addr_t end)
mmu.c:114"]
    kvm_mmu_split_huge_pages -> lockdep_assert_held_write
    kvm_mmu_split_huge_pages -> kvm_mmu_split_nr_page_tables
    kvm_mmu_split_huge_pages -> need_split_memcache_topup_or_resched
    kvm_mmu_split_huge_pages -> write_unlock
    kvm_mmu_split_huge_pages -> cond_resched
    kvm_mmu_split_huge_pages -> write_lock
    kvm_mmu_split_huge_pages -> kvm_pgtable_stage2_split
    lockdep_assert_held_write [label="lockdep_assert_held_write()"]
    kvm_mmu_split_nr_page_tables [label="int kvm_mmu_split_nr_page_tables (u64 range)
mmu.c:90"]
    kvm_mmu_split_nr_page_tables -> DIV_ROUND_UP
    need_split_memcache_topup_or_resched [label="bool need_split_memcache_topup_or_resched (struct kvm *kvm)
mmu.c:100"]
    need_split_memcache_topup_or_resched -> min
    need_split_memcache_topup_or_resched -> need_resched
    need_split_memcache_topup_or_resched -> rwlock_needbreak
    need_split_memcache_topup_or_resched -> kvm_mmu_split_nr_page_tables
    need_split_memcache_topup_or_resched -> kvm_mmu_memory_cache_nr_free_objects
    need_resched [label="need_resched()"]
    rwlock_needbreak [label="rwlock_needbreak()"]
    kvm_mmu_memory_cache_nr_free_objects [label="kvm_mmu_memory_cache_nr_free_objects()"]
    cond_resched [label="cond_resched()"]
    kvm_pgtable_stage2_split [label="kvm_pgtable_stage2_split()"]
    kvm_mmu_free_memory_cache [label="kvm_mmu_free_memory_cache()"]
    kvm_arch_destroy_vm [label="void kvm_arch_destroy_vm (struct kvm *kvm)
arm.c:198"]
    kvm_arch_destroy_vm -> bitmap_free
    kvm_arch_destroy_vm -> free_cpumask_var
    kvm_arch_destroy_vm -> kvm_vgic_destroy
    kvm_arch_destroy_vm -> is_protected_kvm_enabled
    kvm_arch_destroy_vm -> pkvm_destroy_hyp_vm
    kvm_arch_destroy_vm -> kfree
    kvm_arch_destroy_vm -> kvm_destroy_vcpus
    kvm_arch_destroy_vm -> kvm_unshare_hyp
    kvm_arch_destroy_vm -> kvm_arm_teardown_hypercalls
    bitmap_free [label="bitmap_free()"]
    free_cpumask_var [label="free_cpumask_var()"]
    kvm_vgic_destroy [label="kvm_vgic_destroy()"]
    pkvm_destroy_hyp_vm [label="void pkvm_destroy_hyp_vm (struct kvm *host_kvm)
pkvm.c:216"]
    pkvm_destroy_hyp_vm -> mutex_lock
    pkvm_destroy_hyp_vm -> mutex_unlock
    kfree [label="kfree()"]
    kvm_destroy_vcpus [label="kvm_destroy_vcpus()"]
    kvm_unshare_hyp [label="void kvm_unshare_hyp (void *from, void *to)
mmu.c:548"]
    kvm_unshare_hyp -> is_kernel_in_hyp_mode
    kvm_unshare_hyp -> kvm_host_owns_hyp_mappings
    kvm_unshare_hyp -> ALIGN_DOWN
    kvm_unshare_hyp -> PAGE_ALIGN
    kvm_unshare_hyp -> WARN_ON
    kvm_unshare_hyp -> unshare_pfn_hyp
    kvm_host_owns_hyp_mappings [label="bool kvm_host_owns_hyp_mappings (void)
mmu.c:383"]
    kvm_host_owns_hyp_mappings -> is_kernel_in_hyp_mode
    kvm_host_owns_hyp_mappings -> static_branch_likely
    kvm_host_owns_hyp_mappings -> is_protected_kvm_enabled
    kvm_host_owns_hyp_mappings -> WARN_ON
    ALIGN_DOWN [label="ALIGN_DOWN()"]
    PAGE_ALIGN [label="PAGE_ALIGN()"]
    unshare_pfn_hyp [label="int unshare_pfn_hyp (u64 pfn)
mmu.c:490"]
    unshare_pfn_hyp -> mutex_lock
    unshare_pfn_hyp -> find_shared_pfn
    unshare_pfn_hyp -> WARN_ON
    unshare_pfn_hyp -> rb_erase
    unshare_pfn_hyp -> kfree
    unshare_pfn_hyp -> kvm_call_hyp_nvhe
    unshare_pfn_hyp -> mutex_unlock
    find_shared_pfn [label="struct hyp_shared_pfn *find_shared_pfn (u64 pfn, struct rb_node ***node, struct rb_node **parent)
mmu.c:439"]
    find_shared_pfn -> container_of
    rb_erase [label="rb_erase()"]
    kvm_arm_teardown_hypercalls [label="void kvm_arm_teardown_hypercalls (struct kvm *kvm)
hypercalls.c:403"]
    kvm_arm_teardown_hypercalls -> mtree_destroy
    mtree_destroy [label="mtree_destroy()"]
    kvm_arch_dev_ioctl [label="long kvm_arch_dev_ioctl (struct file *filp, unsigned int ioctl, unsigned long arg)
arm.c:331"]
    kvm_arch_flush_remote_tlbs [label="int kvm_arch_flush_remote_tlbs (struct kvm *kvm)
mmu.c:169"]
    kvm_arch_flush_remote_tlbs -> kvm_call_hyp
    kvm_arch_flush_remote_tlbs_range [label="int kvm_arch_flush_remote_tlbs_range (struct kvm *kvm, gfn_t gfn, u64 nr_pages)
mmu.c:175"]
    kvm_arch_flush_remote_tlbs_range -> kvm_tlb_flush_vmid_range
    kvm_tlb_flush_vmid_range [label="kvm_tlb_flush_vmid_range()"]
    kvm_arch_flush_shadow_all [label="void kvm_arch_flush_shadow_all (struct kvm *kvm)
mmu.c:2057"]
    kvm_arch_flush_shadow_all -> kvm_uninit_stage2_mmu
    kvm_uninit_stage2_mmu [label="void kvm_uninit_stage2_mmu (struct kvm *kvm)
mmu.c:935"]
    kvm_uninit_stage2_mmu -> kvm_free_stage2_pgd
    kvm_uninit_stage2_mmu -> kvm_mmu_free_memory_cache
    kvm_free_stage2_pgd [label="void kvm_free_stage2_pgd (struct kvm_s2_mmu *mmu)
mmu.c:1009"]
    kvm_free_stage2_pgd -> kvm_s2_mmu_to_kvm
    kvm_free_stage2_pgd -> write_lock
    kvm_free_stage2_pgd -> free_percpu
    kvm_free_stage2_pgd -> write_unlock
    kvm_free_stage2_pgd -> kvm_pgtable_stage2_destroy
    kvm_free_stage2_pgd -> kfree
    kvm_s2_mmu_to_kvm [label="kvm_s2_mmu_to_kvm()"]
    free_percpu [label="free_percpu()"]
    kvm_pgtable_stage2_destroy [label="kvm_pgtable_stage2_destroy()"]
    kvm_arch_flush_shadow_memslot [label="void kvm_arch_flush_shadow_memslot (struct kvm *kvm, struct kvm_memory_slot *slot)
mmu.c:2062"]
    kvm_arch_flush_shadow_memslot -> write_lock
    kvm_arch_flush_shadow_memslot -> unmap_stage2_range
    kvm_arch_flush_shadow_memslot -> write_unlock
    unmap_stage2_range [label="void unmap_stage2_range (struct kvm_s2_mmu *mmu, phys_addr_t start, u64 size)
mmu.c:331"]
    kvm_arch_free_memslot [label="void kvm_arch_free_memslot (struct kvm *kvm, struct kvm_memory_slot *slot)
mmu.c:2049"]
    kvm_arch_hardware_disable [label="void kvm_arch_hardware_disable (void)
arm.c:2014"]
    kvm_arch_hardware_disable -> kvm_timer_cpu_down
    kvm_arch_hardware_disable -> kvm_vgic_cpu_down
    kvm_arch_hardware_disable -> is_protected_kvm_enabled
    kvm_arch_hardware_disable -> cpu_hyp_uninit
    kvm_timer_cpu_down [label="void kvm_timer_cpu_down (void)
arch_timer.c:1042"]
    kvm_timer_cpu_down -> disable_percpu_irq
    kvm_vgic_cpu_down [label="kvm_vgic_cpu_down()"]
    cpu_hyp_uninit [label="void cpu_hyp_uninit (void *discard)
arm.c:1986"]
    cpu_hyp_uninit -> cpu_hyp_reset
    kvm_arch_hardware_enable [label="int kvm_arch_hardware_enable (void)
arm.c:1994"]
    kvm_arch_hardware_enable -> preempt_disable
    kvm_arch_hardware_enable -> cpu_hyp_init
    kvm_arch_hardware_enable -> kvm_vgic_cpu_up
    kvm_arch_hardware_enable -> kvm_timer_cpu_up
    kvm_arch_hardware_enable -> preempt_enable
    cpu_hyp_init [label="void cpu_hyp_init (void *discard)
arm.c:1978"]
    cpu_hyp_init -> cpu_hyp_reinit
    kvm_vgic_cpu_up [label="kvm_vgic_cpu_up()"]
    kvm_timer_cpu_up [label="void kvm_timer_cpu_up (void)
arch_timer.c:1035"]
    kvm_timer_cpu_up -> enable_percpu_irq
    kvm_arch_has_irq_bypass [label="bool kvm_arch_has_irq_bypass (void)
arm.c:2480"]
    kvm_arch_init_vm [label="int kvm_arch_init_vm (struct kvm *kvm, unsigned long type)
arm.c:136"]
    kvm_arch_init_vm -> mutex_init
    kvm_arch_init_vm -> mutex_lock
    kvm_arch_init_vm -> mutex_unlock
    kvm_arch_init_vm -> kvm_share_hyp
    kvm_arch_init_vm -> pkvm_init_host_vm
    kvm_arch_init_vm -> zalloc_cpumask_var
    kvm_arch_init_vm -> cpumask_copy
    kvm_arch_init_vm -> kvm_init_stage2_mmu
    kvm_arch_init_vm -> kvm_vgic_early_init
    kvm_arch_init_vm -> kvm_timer_init_vm
    kvm_arch_init_vm -> kvm_arm_default_max_vcpus
    kvm_arch_init_vm -> kvm_arm_init_hypercalls
    kvm_arch_init_vm -> bitmap_zero
    kvm_arch_init_vm -> free_cpumask_var
    kvm_arch_init_vm -> kvm_unshare_hyp
    mutex_init [label="mutex_init()"]
    kvm_share_hyp [label="int kvm_share_hyp (void *from, void *to)
mmu.c:516"]
    kvm_share_hyp -> is_kernel_in_hyp_mode
    kvm_share_hyp -> is_vmalloc_or_module_addr
    kvm_share_hyp -> kvm_host_owns_hyp_mappings
    kvm_share_hyp -> create_hyp_mappings
    kvm_share_hyp -> ALIGN_DOWN
    kvm_share_hyp -> PAGE_ALIGN
    kvm_share_hyp -> share_pfn_hyp
    is_vmalloc_or_module_addr [label="is_vmalloc_or_module_addr()"]
    create_hyp_mappings [label="int create_hyp_mappings (void *from, void *to, enum kvm_pgtable_prot prot)
mmu.c:574"]
    create_hyp_mappings -> kern_hyp_va
    create_hyp_mappings -> is_kernel_in_hyp_mode
    create_hyp_mappings -> kvm_host_owns_hyp_mappings
    create_hyp_mappings -> PAGE_ALIGN
    create_hyp_mappings -> kvm_kaddr_to_phys
    kern_hyp_va [label="kern_hyp_va()"]
    kvm_kaddr_to_phys [label="phys_addr_t kvm_kaddr_to_phys (void *kaddr)
mmu.c:419"]
    kvm_kaddr_to_phys -> is_vmalloc_addr
    kvm_kaddr_to_phys -> BUG_ON
    kvm_kaddr_to_phys -> virt_addr_valid
    kvm_kaddr_to_phys -> page_to_phys
    kvm_kaddr_to_phys -> vmalloc_to_page
    kvm_kaddr_to_phys -> offset_in_page
    is_vmalloc_addr [label="is_vmalloc_addr()"]
    virt_addr_valid [label="virt_addr_valid()"]
    page_to_phys [label="page_to_phys()"]
    vmalloc_to_page [label="vmalloc_to_page()"]
    offset_in_page [label="offset_in_page()"]
    share_pfn_hyp [label="int share_pfn_hyp (u64 pfn)
mmu.c:460"]
    share_pfn_hyp -> mutex_lock
    share_pfn_hyp -> find_shared_pfn
    share_pfn_hyp -> kzalloc
    share_pfn_hyp -> rb_link_node
    share_pfn_hyp -> rb_insert_color
    share_pfn_hyp -> kvm_call_hyp_nvhe
    share_pfn_hyp -> mutex_unlock
    rb_link_node [label="rb_link_node()"]
    rb_insert_color [label="rb_insert_color()"]
    pkvm_init_host_vm [label="int pkvm_init_host_vm (struct kvm *host_kvm)
pkvm.c:223"]
    pkvm_init_host_vm -> mutex_init
    zalloc_cpumask_var [label="zalloc_cpumask_var()"]
    cpumask_copy [label="cpumask_copy()"]
    kvm_init_stage2_mmu [label="int kvm_init_stage2_mmu (struct kvm *kvm, struct kvm_s2_mmu *mmu, unsigned long type)
mmu.c:866"]
    kvm_init_stage2_mmu -> get_kvm_ipa_limit
    kvm_init_stage2_mmu -> KVM_VM_TYPE_ARM_IPA_SIZE
    kvm_init_stage2_mmu -> is_protected_kvm_enabled
    kvm_init_stage2_mmu -> pr_warn_once
    kvm_init_stage2_mmu -> read_sanitised_ftr_reg
    kvm_init_stage2_mmu -> kvm_get_vtcr
    kvm_init_stage2_mmu -> kvm_err
    kvm_init_stage2_mmu -> kzalloc
    kvm_init_stage2_mmu -> kvm_pgtable_stage2_init
    kvm_init_stage2_mmu -> alloc_percpu
    kvm_init_stage2_mmu -> typeof
    kvm_init_stage2_mmu -> for_each_possible_cpu
    kvm_init_stage2_mmu -> per_cpu_ptr
    kvm_init_stage2_mmu -> kvm_pgtable_stage2_destroy
    kvm_init_stage2_mmu -> kfree
    get_kvm_ipa_limit [label="u32 get_kvm_ipa_limit (void)
reset.c:269"]
    KVM_VM_TYPE_ARM_IPA_SIZE [label="KVM_VM_TYPE_ARM_IPA_SIZE()"]
    kvm_get_vtcr [label="kvm_get_vtcr()"]
    kvm_pgtable_stage2_init [label="kvm_pgtable_stage2_init()"]
    alloc_percpu [label="alloc_percpu()"]
    for_each_possible_cpu [label="for_each_possible_cpu()"]
    per_cpu_ptr [label="per_cpu_ptr()"]
    kvm_vgic_early_init [label="kvm_vgic_early_init()"]
    kvm_timer_init_vm [label="void kvm_timer_init_vm (struct kvm *kvm)
arch_timer.c:1029"]
    kvm_arm_default_max_vcpus [label="int kvm_arm_default_max_vcpus (void)
arm.c:127"]
    kvm_arm_default_max_vcpus -> kvm_vgic_get_max_vcpus
    kvm_vgic_get_max_vcpus [label="kvm_vgic_get_max_vcpus()"]
    kvm_arm_init_hypercalls [label="void kvm_arm_init_hypercalls (struct kvm *kvm)
hypercalls.c:392"]
    kvm_arm_init_hypercalls -> mt_init
    mt_init [label="mt_init()"]
    bitmap_zero [label="bitmap_zero()"]
    kvm_arch_intc_initialized [label="bool kvm_arch_intc_initialized (struct kvm *kvm)
arm.c:709"]
    kvm_arch_intc_initialized -> vgic_initialized
    vgic_initialized [label="vgic_initialized()"]
    kvm_arch_irq_bypass_add_producer [label="int kvm_arch_irq_bypass_add_producer (struct irq_bypass_consumer *cons, struct irq_bypass_producer *prod)
arm.c:2485"]
    kvm_arch_irq_bypass_add_producer -> container_of
    kvm_arch_irq_bypass_add_producer -> kvm_vgic_v4_set_forwarding
    kvm_vgic_v4_set_forwarding [label="kvm_vgic_v4_set_forwarding()"]
    kvm_arch_irq_bypass_del_producer [label="void kvm_arch_irq_bypass_del_producer (struct irq_bypass_consumer *cons, struct irq_bypass_producer *prod)
arm.c:2494"]
    kvm_arch_irq_bypass_del_producer -> container_of
    kvm_arch_irq_bypass_del_producer -> kvm_vgic_v4_unset_forwarding
    kvm_vgic_v4_unset_forwarding [label="kvm_vgic_v4_unset_forwarding()"]
    kvm_arch_irq_bypass_start [label="void kvm_arch_irq_bypass_start (struct irq_bypass_consumer *cons)
arm.c:2512"]
    kvm_arch_irq_bypass_start -> container_of
    kvm_arch_irq_bypass_start -> kvm_arm_resume_guest
    kvm_arm_resume_guest [label="void kvm_arm_resume_guest (struct kvm *kvm)
arm.c:724"]
    kvm_arm_resume_guest -> kvm_for_each_vcpu
    kvm_arch_irq_bypass_stop [label="void kvm_arch_irq_bypass_stop (struct irq_bypass_consumer *cons)
arm.c:2504"]
    kvm_arch_irq_bypass_stop -> container_of
    kvm_arch_irq_bypass_stop -> kvm_arm_halt_guest
    kvm_arm_halt_guest [label="void kvm_arm_halt_guest (struct kvm *kvm)
arm.c:714"]
    kvm_arm_halt_guest -> kvm_for_each_vcpu
    kvm_arm_halt_guest -> kvm_make_all_cpus_request
    kvm_arch_irqchip_in_kernel [label="bool kvm_arch_irqchip_in_kernel (struct kvm *kvm)
arm.c:2475"]
    kvm_arch_irqchip_in_kernel -> irqchip_in_kernel
    kvm_arch_memslots_updated [label="void kvm_arch_memslots_updated (struct kvm *kvm, u64 gen)
mmu.c:2053"]
    kvm_arch_mmu_enable_log_dirty_pt_masked [label="void kvm_arch_mmu_enable_log_dirty_pt_masked (struct kvm *kvm, struct kvm_memory_slot *slot, gfn_t gfn_offset, unsigned long mask)
mmu.c:1183"]
    kvm_arch_mmu_enable_log_dirty_pt_masked -> lockdep_assert_held_write
    kvm_arch_mmu_enable_log_dirty_pt_masked -> stage2_wp_range
    kvm_arch_mmu_enable_log_dirty_pt_masked -> kvm_dirty_log_manual_protect_and_init_set
    kvm_arch_mmu_enable_log_dirty_pt_masked -> kvm_mmu_split_huge_pages
    kvm_arch_prepare_memory_region [label="int kvm_arch_prepare_memory_region (struct kvm *kvm, const struct kvm_memory_slot *old, struct kvm_memory_slot *new, enum kvm_mr_change change)
mmu.c:1989"]
    kvm_arch_prepare_memory_region -> kvm_phys_size
    kvm_arch_prepare_memory_region -> mmap_read_lock
    kvm_arch_prepare_memory_region -> find_vma_intersection
    kvm_arch_prepare_memory_region -> kvm_has_mte
    kvm_arch_prepare_memory_region -> kvm_vma_mte_allowed
    kvm_arch_prepare_memory_region -> min
    kvm_arch_prepare_memory_region -> mmap_read_unlock
    kvm_phys_size [label="kvm_phys_size()"]
    mmap_read_lock [label="mmap_read_lock()"]
    find_vma_intersection [label="find_vma_intersection()"]
    kvm_vma_mte_allowed [label="bool kvm_vma_mte_allowed (struct vm_area_struct *vma)
mmu.c:1370"]
    mmap_read_unlock [label="mmap_read_unlock()"]
    kvm_arch_sync_dirty_log [label="void kvm_arch_sync_dirty_log (struct kvm *kvm, struct kvm_memory_slot *memslot)
arm.c:1640"]
    kvm_arch_timer_get_input_level [label="bool kvm_arch_timer_get_input_level (int vintid)
arch_timer.c:1486"]
    kvm_arch_timer_get_input_level -> kvm_get_running_vcpu
    kvm_arch_timer_get_input_level -> WARN
    kvm_arch_timer_get_input_level -> WARN_RATELIMIT
    kvm_get_running_vcpu [label="kvm_get_running_vcpu()"]
    kvm_arch_vcpu_blocking [label="void kvm_arch_vcpu_blocking (struct kvm_vcpu *vcpu)
arm.c:417"]
    kvm_arch_vcpu_create [label="int kvm_arch_vcpu_create (struct kvm_vcpu *vcpu)
arm.c:358"]
    kvm_arch_vcpu_create -> spin_lock_init
    kvm_arch_vcpu_create -> mutex_lock
    kvm_arch_vcpu_create -> mutex_unlock
    kvm_arch_vcpu_create -> vcpu_clear_flag
    kvm_arch_vcpu_create -> kvm_timer_vcpu_init
    kvm_arch_vcpu_create -> kvm_pmu_vcpu_init
    kvm_arch_vcpu_create -> kvm_arm_reset_debug_ptr
    kvm_arch_vcpu_create -> kvm_arm_pvtime_vcpu_init
    kvm_arch_vcpu_create -> kvm_vgic_vcpu_init
    kvm_arch_vcpu_create -> kvm_share_hyp
    spin_lock_init [label="spin_lock_init()"]
    kvm_timer_vcpu_init [label="void kvm_timer_vcpu_init (struct kvm_vcpu *vcpu)
arch_timer.c:1012"]
    kvm_timer_vcpu_init -> vcpu_timer
    kvm_timer_vcpu_init -> timer_context_init
    kvm_timer_vcpu_init -> test_bit
    kvm_timer_vcpu_init -> timer_set_offset
    kvm_timer_vcpu_init -> vcpu_vtimer
    kvm_timer_vcpu_init -> kvm_phys_timer_read
    kvm_timer_vcpu_init -> vcpu_ptimer
    kvm_timer_vcpu_init -> hrtimer_init
    kvm_timer_vcpu_init -> kvm_bg_timer_expire
    timer_context_init [label="void timer_context_init (struct kvm_vcpu *vcpu, int timerid)
arch_timer.c:985"]
    timer_context_init -> vcpu_get_timer
    timer_context_init -> hrtimer_init
    timer_context_init -> kvm_hrtimer_expire
    hrtimer_init [label="hrtimer_init()"]
    kvm_hrtimer_expire [label="enum hrtimer_restart kvm_hrtimer_expire (struct hrtimer *hrt)
arch_timer.c:355"]
    kvm_hrtimer_expire -> container_of
    kvm_hrtimer_expire -> trace_kvm_timer_hrtimer_expire
    kvm_hrtimer_expire -> kvm_timer_compute_delta
    kvm_hrtimer_expire -> unlikely
    kvm_hrtimer_expire -> hrtimer_forward_now
    kvm_hrtimer_expire -> ns_to_ktime
    kvm_hrtimer_expire -> kvm_timer_update_irq
    trace_kvm_timer_hrtimer_expire [label="trace_kvm_timer_hrtimer_expire()"]
    hrtimer_forward_now [label="hrtimer_forward_now()"]
    ns_to_ktime [label="ns_to_ktime()"]
    timer_set_offset [label="void timer_set_offset (struct arch_timer_context *ctxt, u64 offset)
arch_timer.c:163"]
    timer_set_offset -> WARN
    timer_set_offset -> arch_timer_ctx_index
    timer_set_offset -> WRITE_ONCE
    kvm_bg_timer_expire [label="enum hrtimer_restart kvm_bg_timer_expire (struct hrtimer *hrt)
arch_timer.c:331"]
    kvm_bg_timer_expire -> container_of
    kvm_bg_timer_expire -> kvm_timer_earliest_exp
    kvm_bg_timer_expire -> unlikely
    kvm_bg_timer_expire -> hrtimer_forward_now
    kvm_bg_timer_expire -> ns_to_ktime
    kvm_bg_timer_expire -> kvm_vcpu_wake_up
    kvm_pmu_vcpu_init [label="void kvm_pmu_vcpu_init (struct kvm_vcpu *vcpu)
pmu-emul.c:231"]
    kvm_arm_reset_debug_ptr [label="void kvm_arm_reset_debug_ptr (struct kvm_vcpu *vcpu)
debug.c:148"]
    kvm_arm_pvtime_vcpu_init [label="kvm_arm_pvtime_vcpu_init()"]
    kvm_vgic_vcpu_init [label="kvm_vgic_vcpu_init()"]
    kvm_arch_vcpu_destroy [label="void kvm_arch_vcpu_destroy (struct kvm_vcpu *vcpu)
arm.c:405"]
    kvm_arch_vcpu_destroy -> vcpu_has_run_once
    kvm_arch_vcpu_destroy -> unlikely
    kvm_arch_vcpu_destroy -> irqchip_in_kernel
    kvm_arch_vcpu_destroy -> static_branch_dec
    kvm_arch_vcpu_destroy -> kvm_mmu_free_memory_cache
    kvm_arch_vcpu_destroy -> kvm_timer_vcpu_terminate
    kvm_arch_vcpu_destroy -> kvm_pmu_vcpu_destroy
    kvm_arch_vcpu_destroy -> kvm_vgic_vcpu_destroy
    kvm_arch_vcpu_destroy -> kvm_arm_vcpu_destroy
    vcpu_has_run_once [label="vcpu_has_run_once()"]
    static_branch_dec [label="static_branch_dec()"]
    kvm_timer_vcpu_terminate [label="void kvm_timer_vcpu_terminate (struct kvm_vcpu *vcpu)
arch_timer.c:1446"]
    kvm_timer_vcpu_terminate -> vcpu_timer
    kvm_timer_vcpu_terminate -> soft_timer_cancel
    kvm_pmu_vcpu_destroy [label="void kvm_pmu_vcpu_destroy (struct kvm_vcpu *vcpu)
pmu-emul.c:259"]
    kvm_pmu_vcpu_destroy -> kvm_pmu_release_perf_event
    kvm_pmu_vcpu_destroy -> kvm_vcpu_idx_to_pmc
    kvm_pmu_vcpu_destroy -> irq_work_sync
    irq_work_sync [label="irq_work_sync()"]
    kvm_vgic_vcpu_destroy [label="kvm_vgic_vcpu_destroy()"]
    kvm_arm_vcpu_destroy [label="void kvm_arm_vcpu_destroy (struct kvm_vcpu *vcpu)
reset.c:150"]
    kvm_arm_vcpu_destroy -> kvm_vcpu_unshare_task_fp
    kvm_arm_vcpu_destroy -> kvm_unshare_hyp
    kvm_arm_vcpu_destroy -> vcpu_sve_state_size
    kvm_arm_vcpu_destroy -> kfree
    kvm_vcpu_unshare_task_fp [label="void kvm_vcpu_unshare_task_fp (struct kvm_vcpu *vcpu)
fpsimd.c:17"]
    kvm_vcpu_unshare_task_fp -> is_protected_kvm_enabled
    kvm_vcpu_unshare_task_fp -> kvm_unshare_hyp
    kvm_vcpu_unshare_task_fp -> put_task_struct
    put_task_struct [label="put_task_struct()"]
    vcpu_sve_state_size [label="vcpu_sve_state_size()"]
    kvm_arch_vcpu_fault [label="vm_fault_t kvm_arch_vcpu_fault (struct kvm_vcpu *vcpu, struct vm_fault *vmf)
arm.c:188"]
    kvm_arch_vcpu_get_ip [label="unsigned long kvm_arch_vcpu_get_ip (struct kvm_vcpu *vcpu)
arm.c:573"]
    kvm_arch_vcpu_get_ip -> vcpu_pc
    kvm_arch_vcpu_in_kernel [label="bool kvm_arch_vcpu_in_kernel (struct kvm_vcpu *vcpu)
arm.c:567"]
    kvm_arch_vcpu_in_kernel -> vcpu_mode_priv
    kvm_arch_vcpu_ioctl [label="long kvm_arch_vcpu_ioctl (struct file *filp, unsigned int ioctl, unsigned long arg)
arm.c:1511"]
    kvm_arch_vcpu_ioctl -> copy_from_user
    kvm_arch_vcpu_ioctl -> kvm_arch_vcpu_ioctl_vcpu_init
    kvm_arch_vcpu_ioctl -> unlikely
    kvm_arch_vcpu_ioctl -> kvm_vcpu_initialized
    kvm_arch_vcpu_ioctl -> kvm_check_request
    kvm_arch_vcpu_ioctl -> kvm_reset_vcpu
    kvm_arch_vcpu_ioctl -> kvm_arm_set_reg
    kvm_arch_vcpu_ioctl -> kvm_arm_get_reg
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_is_finalized
    kvm_arch_vcpu_ioctl -> kvm_arm_num_regs
    kvm_arch_vcpu_ioctl -> copy_to_user
    kvm_arch_vcpu_ioctl -> kvm_arm_copy_reg_indices
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_set_attr
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_get_attr
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_has_attr
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_get_events
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_set_events
    kvm_arch_vcpu_ioctl -> get_user
    kvm_arch_vcpu_ioctl -> kvm_arm_vcpu_finalize
    copy_from_user [label="copy_from_user()"]
    kvm_arch_vcpu_ioctl_vcpu_init [label="int kvm_arch_vcpu_ioctl_vcpu_init (struct kvm_vcpu *vcpu, struct kvm_vcpu_init *init)
arm.c:1389"]
    kvm_arch_vcpu_ioctl_vcpu_init -> BIT
    kvm_arch_vcpu_ioctl_vcpu_init -> kvm_vcpu_set_target
    kvm_arch_vcpu_ioctl_vcpu_init -> vcpu_has_run_once
    kvm_arch_vcpu_ioctl_vcpu_init -> cpus_have_final_cap
    kvm_arch_vcpu_ioctl_vcpu_init -> stage2_unmap_vm
    kvm_arch_vcpu_ioctl_vcpu_init -> icache_inval_all_pou
    kvm_arch_vcpu_ioctl_vcpu_init -> vcpu_reset_hcr
    kvm_arch_vcpu_ioctl_vcpu_init -> kvm_get_reset_cptr_el2
    kvm_arch_vcpu_ioctl_vcpu_init -> spin_lock
    kvm_arch_vcpu_ioctl_vcpu_init -> WRITE_ONCE
    kvm_arch_vcpu_ioctl_vcpu_init -> spin_unlock
    kvm_vcpu_set_target [label="int kvm_vcpu_set_target (struct kvm_vcpu *vcpu, const struct kvm_vcpu_init *init)
arm.c:1366"]
    kvm_vcpu_set_target -> kvm_target_cpu
    kvm_vcpu_set_target -> kvm_vcpu_init_check_features
    kvm_vcpu_set_target -> kvm_vcpu_initialized
    kvm_vcpu_set_target -> kvm_vcpu_init_changed
    kvm_vcpu_set_target -> kvm_reset_vcpu
    kvm_target_cpu [label="u32 __attribute_const__ kvm_target_cpu (void)
guest.c:857"]
    kvm_target_cpu -> read_cpuid_implementor
    kvm_target_cpu -> read_cpuid_part_number
    read_cpuid_implementor [label="read_cpuid_implementor()"]
    read_cpuid_part_number [label="read_cpuid_part_number()"]
    kvm_vcpu_init_check_features [label="int kvm_vcpu_init_check_features (struct kvm_vcpu *vcpu, const struct kvm_vcpu_init *init)
arm.c:1268"]
    kvm_vcpu_init_check_features -> ARRAY_SIZE
    kvm_vcpu_init_check_features -> system_supported_vcpu_features
    kvm_vcpu_init_check_features -> test_bit
    kvm_vcpu_init_check_features -> kvm_has_mte
    ARRAY_SIZE [label="ARRAY_SIZE()"]
    system_supported_vcpu_features [label="unsigned long system_supported_vcpu_features (void)
arm.c:1244"]
    system_supported_vcpu_features -> cpus_have_final_cap
    system_supported_vcpu_features -> clear_bit
    system_supported_vcpu_features -> kvm_arm_support_pmu_v3
    system_supported_vcpu_features -> system_supports_sve
    system_supported_vcpu_features -> system_has_full_ptr_auth
    clear_bit [label="clear_bit()"]
    system_has_full_ptr_auth [label="system_has_full_ptr_auth()"]
    kvm_vcpu_initialized [label="int kvm_vcpu_initialized (struct kvm_vcpu *vcpu)
arm.c:579"]
    kvm_vcpu_initialized -> vcpu_get_flag
    kvm_vcpu_init_changed [label="bool kvm_vcpu_init_changed (struct kvm_vcpu *vcpu, const struct kvm_vcpu_init *init)
arm.c:1312"]
    kvm_vcpu_init_changed -> bitmap_equal
    bitmap_equal [label="bitmap_equal()"]
    kvm_reset_vcpu [label="void kvm_reset_vcpu (struct kvm_vcpu *vcpu)
reset.c:191"]
    kvm_reset_vcpu -> spin_lock
    kvm_reset_vcpu -> spin_unlock
    kvm_reset_vcpu -> kvm_pmu_vcpu_reset
    kvm_reset_vcpu -> preempt_disable
    kvm_reset_vcpu -> kvm_arch_vcpu_put
    kvm_reset_vcpu -> kvm_arm_vcpu_sve_finalized
    kvm_reset_vcpu -> vcpu_has_feature
    kvm_reset_vcpu -> kvm_vcpu_enable_sve
    kvm_reset_vcpu -> kvm_vcpu_reset_sve
    kvm_reset_vcpu -> kvm_vcpu_enable_ptrauth
    kvm_reset_vcpu -> vcpu_el1_is_32bit
    kvm_reset_vcpu -> vcpu_has_nv
    kvm_reset_vcpu -> memset
    kvm_reset_vcpu -> vcpu_gp_regs
    kvm_reset_vcpu -> kvm_reset_sys_regs
    kvm_reset_vcpu -> vcpu_mode_is_32bit
    kvm_reset_vcpu -> vcpu_set_thumb
    kvm_reset_vcpu -> kvm_vcpu_set_be
    kvm_reset_vcpu -> vcpu_pc
    kvm_reset_vcpu -> vcpu_set_reg
    kvm_reset_vcpu -> kvm_timer_vcpu_reset
    kvm_reset_vcpu -> kvm_arch_vcpu_load
    kvm_reset_vcpu -> smp_processor_id
    kvm_reset_vcpu -> preempt_enable
    kvm_pmu_vcpu_reset [label="void kvm_pmu_vcpu_reset (struct kvm_vcpu *vcpu)
pmu-emul.c:245"]
    kvm_pmu_vcpu_reset -> kvm_pmu_valid_counter_mask
    kvm_pmu_vcpu_reset -> for_each_set_bit
    kvm_pmu_vcpu_reset -> kvm_pmu_stop_counter
    kvm_pmu_vcpu_reset -> kvm_vcpu_idx_to_pmc
    kvm_arm_vcpu_sve_finalized [label="kvm_arm_vcpu_sve_finalized()"]
    vcpu_has_feature [label="vcpu_has_feature()"]
    kvm_vcpu_enable_sve [label="void kvm_vcpu_enable_sve (struct kvm_vcpu *vcpu)
reset.c:76"]
    kvm_vcpu_enable_sve -> vcpu_set_flag
    kvm_vcpu_reset_sve [label="void kvm_vcpu_reset_sve (struct kvm_vcpu *vcpu)
reset.c:162"]
    kvm_vcpu_reset_sve -> vcpu_has_sve
    kvm_vcpu_reset_sve -> memset
    kvm_vcpu_reset_sve -> vcpu_sve_state_size
    kvm_vcpu_enable_ptrauth [label="void kvm_vcpu_enable_ptrauth (struct kvm_vcpu *vcpu)
reset.c:168"]
    kvm_vcpu_enable_ptrauth -> vcpu_set_flag
    vcpu_gp_regs [label="vcpu_gp_regs()"]
    kvm_reset_sys_regs [label="void kvm_reset_sys_regs (struct kvm_vcpu *vcpu)
sys_regs.c:3313"]
    kvm_reset_sys_regs -> kvm_reset_id_regs
    kvm_reset_sys_regs -> ARRAY_SIZE
    kvm_reset_sys_regs -> is_id_reg
    kvm_reset_sys_regs -> reg_to_encoding
    kvm_reset_id_regs [label="void kvm_reset_id_regs (struct kvm_vcpu *vcpu)
sys_regs.c:3284"]
    kvm_reset_id_regs -> reg_to_encoding
    kvm_reset_id_regs -> test_bit
    kvm_reset_id_regs -> lockdep_assert_held
    kvm_reset_id_regs -> is_id_reg
    kvm_reset_id_regs -> IDREG
    kvm_reset_id_regs -> set_bit
    is_id_reg [label="inline bool is_id_reg (u32 id)
sys_regs.c:1449"]
    is_id_reg -> sys_reg_Op0
    is_id_reg -> sys_reg_Op1
    is_id_reg -> sys_reg_CRn
    is_id_reg -> sys_reg_CRm
    set_bit [label="set_bit()"]
    vcpu_set_thumb [label="vcpu_set_thumb()"]
    kvm_vcpu_set_be [label="kvm_vcpu_set_be()"]
    kvm_timer_vcpu_reset [label="void kvm_timer_vcpu_reset (struct kvm_vcpu *vcpu)
arch_timer.c:939"]
    kvm_timer_vcpu_reset -> vcpu_timer
    kvm_timer_vcpu_reset -> get_timer_map
    kvm_timer_vcpu_reset -> timer_set_ctl
    kvm_timer_vcpu_reset -> vcpu_get_timer
    kvm_timer_vcpu_reset -> vcpu_has_nv
    kvm_timer_vcpu_reset -> vcpu_vtimer
    kvm_timer_vcpu_reset -> kvm_timer_update_irq
    kvm_timer_vcpu_reset -> irqchip_in_kernel
    kvm_timer_vcpu_reset -> kvm_vgic_reset_mapped_irq
    kvm_timer_vcpu_reset -> timer_irq
    kvm_timer_vcpu_reset -> soft_timer_cancel
    kvm_vgic_reset_mapped_irq [label="kvm_vgic_reset_mapped_irq()"]
    stage2_unmap_vm [label="void stage2_unmap_vm (struct kvm *kvm)
mmu.c:990"]
    stage2_unmap_vm -> srcu_read_lock
    stage2_unmap_vm -> mmap_read_lock
    stage2_unmap_vm -> write_lock
    stage2_unmap_vm -> kvm_memslots
    stage2_unmap_vm -> kvm_for_each_memslot
    stage2_unmap_vm -> stage2_unmap_memslot
    stage2_unmap_vm -> write_unlock
    stage2_unmap_vm -> mmap_read_unlock
    stage2_unmap_vm -> srcu_read_unlock
    stage2_unmap_memslot [label="void stage2_unmap_memslot (struct kvm *kvm, struct kvm_memory_slot *memslot)
mmu.c:941"]
    stage2_unmap_memslot -> find_vma_intersection
    stage2_unmap_memslot -> max
    stage2_unmap_memslot -> min
    stage2_unmap_memslot -> unmap_stage2_range
    max [label="max()"]
    icache_inval_all_pou [label="icache_inval_all_pou()"]
    vcpu_reset_hcr [label="vcpu_reset_hcr()"]
    kvm_get_reset_cptr_el2 [label="kvm_get_reset_cptr_el2()"]
    kvm_check_request [label="kvm_check_request()"]
    kvm_arm_set_reg [label="int kvm_arm_set_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:782"]
    kvm_arm_set_reg -> set_core_reg
    kvm_arm_set_reg -> kvm_arm_set_fw_reg
    kvm_arm_set_reg -> set_sve_reg
    kvm_arm_set_reg -> is_timer_reg
    kvm_arm_set_reg -> set_timer_reg
    kvm_arm_set_reg -> kvm_arm_sys_reg_set_reg
    set_core_reg [label="int set_core_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:215"]
    set_core_reg -> core_reg_offset_from_id
    set_core_reg -> KVM_REG_SIZE
    set_core_reg -> core_reg_addr
    set_core_reg -> copy_from_user
    set_core_reg -> KVM_REG_ARM_CORE_REG
    set_core_reg -> kvm_supports_32bit_el0
    set_core_reg -> vcpu_el1_is_32bit
    set_core_reg -> vcpu_has_nv
    set_core_reg -> memcpy
    set_core_reg -> vcpu_cpsr
    set_core_reg -> vcpu_set_reg
    set_core_reg -> vcpu_get_reg
    set_core_reg -> vcpu_pc
    core_reg_offset_from_id [label="u64 core_reg_offset_from_id (u64 id)
guest.c:71"]
    KVM_REG_SIZE [label="KVM_REG_SIZE()"]
    core_reg_addr [label="void *core_reg_addr (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:121"]
    core_reg_addr -> core_reg_offset_from_id
    core_reg_addr -> core_reg_size_from_offset
    core_reg_addr -> KVM_REG_SIZE
    core_reg_addr -> KVM_REG_ARM_CORE_REG
    core_reg_size_from_offset [label="int core_reg_size_from_offset (const struct kvm_vcpu *vcpu, u64 off)
guest.c:76"]
    core_reg_size_from_offset -> KVM_REG_ARM_CORE_REG
    core_reg_size_from_offset -> IS_ALIGNED
    core_reg_size_from_offset -> vcpu_has_sve
    core_reg_size_from_offset -> core_reg_offset_is_vreg
    KVM_REG_ARM_CORE_REG [label="KVM_REG_ARM_CORE_REG()"]
    IS_ALIGNED [label="IS_ALIGNED()"]
    core_reg_offset_is_vreg [label="bool core_reg_offset_is_vreg (u64 off)
guest.c:65"]
    core_reg_offset_is_vreg -> KVM_REG_ARM_CORE_REG
    memcpy [label="memcpy()"]
    kvm_arm_set_fw_reg [label="int kvm_arm_set_fw_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
hypercalls.c:551"]
    kvm_arm_set_fw_reg -> KVM_REG_SIZE
    kvm_arm_set_fw_reg -> copy_from_user
    kvm_arm_set_fw_reg -> vcpu_has_feature
    kvm_arm_set_fw_reg -> get_kernel_wa_level
    kvm_arm_set_fw_reg -> kvm_arm_set_fw_reg_bmap
    get_kernel_wa_level [label="int get_kernel_wa_level (u64 regid)
hypercalls.c:431"]
    get_kernel_wa_level -> arm64_get_spectre_v2_state
    get_kernel_wa_level -> arm64_get_spectre_v4_state
    get_kernel_wa_level -> cpus_have_final_cap
    get_kernel_wa_level -> arm64_get_spectre_bhb_state
    kvm_arm_set_fw_reg_bmap [label="int kvm_arm_set_fw_reg_bmap (struct kvm_vcpu *vcpu, u64 reg_id, u64 val)
hypercalls.c:510"]
    kvm_arm_set_fw_reg_bmap -> mutex_lock
    kvm_arm_set_fw_reg_bmap -> kvm_vm_has_ran_once
    kvm_arm_set_fw_reg_bmap -> WRITE_ONCE
    kvm_arm_set_fw_reg_bmap -> mutex_unlock
    set_sve_reg [label="int set_sve_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:510"]
    set_sve_reg -> set_sve_vls
    set_sve_reg -> sve_reg_to_region
    set_sve_reg -> kvm_arm_vcpu_sve_finalized
    set_sve_reg -> copy_from_user
    set_sve_vls [label="int set_sve_vls (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:336"]
    set_sve_vls -> vcpu_has_sve
    set_sve_vls -> kvm_arm_vcpu_sve_finalized
    set_sve_vls -> WARN_ON
    set_sve_vls -> copy_from_user
    set_sve_vls -> vq_present
    set_sve_vls -> sve_vq_from_vl
    set_sve_vls -> sve_vq_available
    set_sve_vls -> sve_vl_from_vq
    vq_present [label="vq_present()"]
    sve_vq_from_vl [label="sve_vq_from_vl()"]
    sve_vq_available [label="sve_vq_available()"]
    sve_vl_from_vq [label="sve_vl_from_vq()"]
    sve_reg_to_region [label="int sve_reg_to_region (struct sve_state_reg_region *region, struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:417"]
    sve_reg_to_region -> KVM_REG_ARM64_SVE_ZREG
    sve_reg_to_region -> KVM_REG_ARM64_SVE_PREG
    sve_reg_to_region -> KVM_REG_ARM64_SVE_FFR
    sve_reg_to_region -> BUILD_BUG_ON
    sve_reg_to_region -> vcpu_has_sve
    sve_reg_to_region -> vcpu_sve_max_vq
    sve_reg_to_region -> SVE_SIG_ZREG_OFFSET
    sve_reg_to_region -> SVE_SIG_ZREG_SIZE
    sve_reg_to_region -> SVE_SIG_PREG_OFFSET
    sve_reg_to_region -> SVE_SIG_PREG_SIZE
    sve_reg_to_region -> vcpu_sve_state_size
    sve_reg_to_region -> WARN_ON
    sve_reg_to_region -> array_index_nospec
    sve_reg_to_region -> min
    KVM_REG_ARM64_SVE_ZREG [label="KVM_REG_ARM64_SVE_ZREG()"]
    KVM_REG_ARM64_SVE_PREG [label="KVM_REG_ARM64_SVE_PREG()"]
    KVM_REG_ARM64_SVE_FFR [label="KVM_REG_ARM64_SVE_FFR()"]
    BUILD_BUG_ON [label="BUILD_BUG_ON()"]
    SVE_SIG_ZREG_OFFSET [label="SVE_SIG_ZREG_OFFSET()"]
    SVE_SIG_ZREG_SIZE [label="SVE_SIG_ZREG_SIZE()"]
    SVE_SIG_PREG_OFFSET [label="SVE_SIG_PREG_OFFSET()"]
    SVE_SIG_PREG_SIZE [label="SVE_SIG_PREG_SIZE()"]
    array_index_nospec [label="array_index_nospec()"]
    is_timer_reg [label="bool is_timer_reg (u64 index)
guest.c:604"]
    set_timer_reg [label="int set_timer_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:629"]
    set_timer_reg -> copy_from_user
    set_timer_reg -> KVM_REG_SIZE
    set_timer_reg -> kvm_arm_timer_set_reg
    kvm_arm_timer_set_reg [label="int kvm_arm_timer_set_reg (struct kvm_vcpu *vcpu, u64 regid, u64 value)
arch_timer.c:1049"]
    kvm_arm_timer_set_reg -> vcpu_vtimer
    kvm_arm_timer_set_reg -> kvm_arm_timer_write
    kvm_arm_timer_set_reg -> test_bit
    kvm_arm_timer_set_reg -> timer_set_offset
    kvm_arm_timer_set_reg -> kvm_phys_timer_read
    kvm_arm_timer_set_reg -> vcpu_ptimer
    kvm_arm_sys_reg_set_reg [label="int kvm_arm_sys_reg_set_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
sys_regs.c:3610"]
    kvm_arm_sys_reg_set_reg -> demux_c15_set
    kvm_arm_sys_reg_set_reg -> set_invariant_sys_reg
    kvm_arm_sys_reg_set_reg -> kvm_sys_reg_set_user
    kvm_arm_sys_reg_set_reg -> ARRAY_SIZE
    demux_c15_set [label="int demux_c15_set (struct kvm_vcpu *vcpu, u64 id, void __user *uaddr)
sys_regs.c:3513"]
    demux_c15_set -> KVM_REG_SIZE
    demux_c15_set -> get_user
    demux_c15_set -> set_ccsidr
    get_user [label="get_user()"]
    set_ccsidr [label="int set_ccsidr (struct kvm_vcpu *vcpu, u32 csselr, u32 val)
sys_regs.c:152"]
    set_ccsidr -> FIELD_GET
    set_ccsidr -> get_min_cache_line_size
    set_ccsidr -> get_ccsidr
    set_ccsidr -> kmalloc_array
    kmalloc_array [label="kmalloc_array()"]
    set_invariant_sys_reg [label="int set_invariant_sys_reg (u64 id, u64 __user *uaddr)
sys_regs.c:3468"]
    set_invariant_sys_reg -> get_reg_by_id
    set_invariant_sys_reg -> ARRAY_SIZE
    set_invariant_sys_reg -> get_user
    get_reg_by_id [label="const struct sys_reg_desc *get_reg_by_id (u64 id, const struct sys_reg_desc table[], unsigned int num)
sys_regs.c:3389"]
    get_reg_by_id -> index_to_params
    get_reg_by_id -> find_reg
    index_to_params [label="bool index_to_params (u64 id, struct sys_reg_params *params)
sys_regs.c:3360"]
    find_reg [label="find_reg()"]
    kvm_sys_reg_set_user [label="int kvm_sys_reg_set_user (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg, const struct sys_reg_desc table[], unsigned int num)
sys_regs.c:3582"]
    kvm_sys_reg_set_user -> get_user
    kvm_sys_reg_set_user -> id_to_sys_reg_desc
    kvm_sys_reg_set_user -> sysreg_hidden_user
    kvm_sys_reg_set_user -> sysreg_user_write_ignore
    id_to_sys_reg_desc [label="const struct sys_reg_desc *id_to_sys_reg_desc (struct kvm_vcpu *vcpu, u64 id, const struct sys_reg_desc table[], unsigned int num)
sys_regs.c:3403"]
    id_to_sys_reg_desc -> get_reg_by_id
    id_to_sys_reg_desc -> sysreg_hidden
    sysreg_hidden [label="sysreg_hidden()"]
    sysreg_hidden_user [label="sysreg_hidden_user()"]
    sysreg_user_write_ignore [label="sysreg_user_write_ignore()"]
    kvm_arm_get_reg [label="int kvm_arm_get_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:762"]
    kvm_arm_get_reg -> get_core_reg
    kvm_arm_get_reg -> kvm_arm_get_fw_reg
    kvm_arm_get_reg -> get_sve_reg
    kvm_arm_get_reg -> is_timer_reg
    kvm_arm_get_reg -> get_timer_reg
    kvm_arm_get_reg -> kvm_arm_sys_reg_get_reg
    get_core_reg [label="int get_core_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:186"]
    get_core_reg -> core_reg_offset_from_id
    get_core_reg -> KVM_REG_SIZE
    get_core_reg -> core_reg_addr
    get_core_reg -> copy_to_user
    copy_to_user [label="copy_to_user()"]
    kvm_arm_get_fw_reg [label="int kvm_arm_get_fw_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
hypercalls.c:476"]
    kvm_arm_get_fw_reg -> kvm_psci_version
    kvm_arm_get_fw_reg -> get_kernel_wa_level
    kvm_arm_get_fw_reg -> READ_ONCE
    kvm_arm_get_fw_reg -> copy_to_user
    kvm_arm_get_fw_reg -> KVM_REG_SIZE
    get_sve_reg [label="int get_sve_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:484"]
    get_sve_reg -> get_sve_vls
    get_sve_reg -> sve_reg_to_region
    get_sve_reg -> kvm_arm_vcpu_sve_finalized
    get_sve_reg -> copy_to_user
    get_sve_reg -> clear_user
    get_sve_vls [label="int get_sve_vls (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:312"]
    get_sve_vls -> vcpu_has_sve
    get_sve_vls -> WARN_ON
    get_sve_vls -> sve_vl_valid
    get_sve_vls -> memset
    get_sve_vls -> vcpu_sve_max_vq
    get_sve_vls -> sve_vq_available
    get_sve_vls -> vq_word
    get_sve_vls -> vq_mask
    get_sve_vls -> copy_to_user
    sve_vl_valid [label="sve_vl_valid()"]
    vq_word [label="vq_word()"]
    vq_mask [label="vq_mask()"]
    clear_user [label="clear_user()"]
    get_timer_reg [label="int get_timer_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
guest.c:642"]
    get_timer_reg -> kvm_arm_timer_get_reg
    get_timer_reg -> copy_to_user
    get_timer_reg -> KVM_REG_SIZE
    kvm_arm_timer_get_reg [label="u64 kvm_arm_timer_get_reg (struct kvm_vcpu *vcpu, u64 regid)
arch_timer.c:1108"]
    kvm_arm_timer_get_reg -> kvm_arm_timer_read
    kvm_arm_timer_get_reg -> vcpu_vtimer
    kvm_arm_timer_get_reg -> vcpu_ptimer
    kvm_arm_sys_reg_get_reg [label="int kvm_arm_sys_reg_get_reg (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg)
sys_regs.c:3566"]
    kvm_arm_sys_reg_get_reg -> demux_c15_get
    kvm_arm_sys_reg_get_reg -> get_invariant_sys_reg
    kvm_arm_sys_reg_get_reg -> kvm_sys_reg_get_user
    kvm_arm_sys_reg_get_reg -> ARRAY_SIZE
    demux_c15_get [label="int demux_c15_get (struct kvm_vcpu *vcpu, u64 id, void __user *uaddr)
sys_regs.c:3488"]
    demux_c15_get -> KVM_REG_SIZE
    demux_c15_get -> put_user
    demux_c15_get -> get_ccsidr
    put_user [label="put_user()"]
    get_invariant_sys_reg [label="int get_invariant_sys_reg (u64 id, u64 __user *uaddr)
sys_regs.c:3456"]
    get_invariant_sys_reg -> get_reg_by_id
    get_invariant_sys_reg -> ARRAY_SIZE
    get_invariant_sys_reg -> put_user
    kvm_sys_reg_get_user [label="int kvm_sys_reg_get_user (struct kvm_vcpu *vcpu, const struct kvm_one_reg *reg, const struct sys_reg_desc table[], unsigned int num)
sys_regs.c:3541"]
    kvm_sys_reg_get_user -> id_to_sys_reg_desc
    kvm_sys_reg_get_user -> sysreg_hidden_user
    kvm_sys_reg_get_user -> put_user
    kvm_arm_vcpu_is_finalized [label="bool kvm_arm_vcpu_is_finalized (struct kvm_vcpu *vcpu)
reset.c:142"]
    kvm_arm_vcpu_is_finalized -> vcpu_has_sve
    kvm_arm_vcpu_is_finalized -> kvm_arm_vcpu_sve_finalized
    kvm_arm_num_regs [label="unsigned long kvm_arm_num_regs (struct kvm_vcpu *vcpu)
guest.c:717"]
    kvm_arm_num_regs -> num_core_regs
    kvm_arm_num_regs -> num_sve_regs
    kvm_arm_num_regs -> kvm_arm_num_sys_reg_descs
    kvm_arm_num_regs -> kvm_arm_get_fw_num_regs
    num_core_regs [label="unsigned long num_core_regs (const struct kvm_vcpu *vcpu)
guest.c:588"]
    num_core_regs -> copy_core_reg_indices
    copy_core_reg_indices [label="int copy_core_reg_indices (const struct kvm_vcpu *vcpu, u64 __user *uindices)
guest.c:545"]
    copy_core_reg_indices -> core_reg_size_from_offset
    copy_core_reg_indices -> WARN_ON
    copy_core_reg_indices -> put_user
    num_sve_regs [label="unsigned long num_sve_regs (const struct kvm_vcpu *vcpu)
guest.c:651"]
    num_sve_regs -> vcpu_sve_slices
    num_sve_regs -> vcpu_has_sve
    num_sve_regs -> WARN_ON
    num_sve_regs -> kvm_arm_vcpu_sve_finalized
    vcpu_sve_slices [label="vcpu_sve_slices()"]
    kvm_arm_num_sys_reg_descs [label="unsigned long kvm_arm_num_sys_reg_descs (struct kvm_vcpu *vcpu)
sys_regs.c:3708"]
    kvm_arm_num_sys_reg_descs -> ARRAY_SIZE
    kvm_arm_num_sys_reg_descs -> num_demux_regs
    kvm_arm_num_sys_reg_descs -> walk_sys_regs
    num_demux_regs [label="unsigned int num_demux_regs (void)
sys_regs.c:3626"]
    walk_sys_regs [label="int walk_sys_regs (struct kvm_vcpu *vcpu, u64 __user *uind)
sys_regs.c:3691"]
    walk_sys_regs -> ARRAY_SIZE
    walk_sys_regs -> walk_one_sys_reg
    walk_one_sys_reg [label="int walk_one_sys_reg (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 __user **uind, unsigned int *total)
sys_regs.c:3668"]
    walk_one_sys_reg -> sysreg_hidden_user
    walk_one_sys_reg -> copy_reg_to_user
    copy_reg_to_user [label="bool copy_reg_to_user (const struct sys_reg_desc *reg, u64 __user **uind)
sys_regs.c:3656"]
    copy_reg_to_user -> put_user
    copy_reg_to_user -> sys_reg_to_index
    sys_reg_to_index [label="u64 sys_reg_to_index (const struct sys_reg_desc *reg)
sys_regs.c:3645"]
    kvm_arm_get_fw_num_regs [label="int kvm_arm_get_fw_num_regs (struct kvm_vcpu *vcpu)
hypercalls.c:408"]
    kvm_arm_get_fw_num_regs -> ARRAY_SIZE
    kvm_arm_copy_reg_indices [label="int kvm_arm_copy_reg_indices (struct kvm_vcpu *vcpu, u64 __user *uindices)
guest.c:735"]
    kvm_arm_copy_reg_indices -> copy_core_reg_indices
    kvm_arm_copy_reg_indices -> copy_sve_reg_indices
    kvm_arm_copy_reg_indices -> kvm_arm_copy_fw_reg_indices
    kvm_arm_copy_reg_indices -> kvm_arm_get_fw_num_regs
    kvm_arm_copy_reg_indices -> copy_timer_indices
    kvm_arm_copy_reg_indices -> kvm_arm_copy_sys_reg_indices
    copy_sve_reg_indices [label="int copy_sve_reg_indices (const struct kvm_vcpu *vcpu, u64 __user *uindices)
guest.c:665"]
    copy_sve_reg_indices -> vcpu_sve_slices
    copy_sve_reg_indices -> vcpu_has_sve
    copy_sve_reg_indices -> WARN_ON
    copy_sve_reg_indices -> kvm_arm_vcpu_sve_finalized
    copy_sve_reg_indices -> put_user
    copy_sve_reg_indices -> KVM_REG_ARM64_SVE_ZREG
    copy_sve_reg_indices -> KVM_REG_ARM64_SVE_PREG
    copy_sve_reg_indices -> KVM_REG_ARM64_SVE_FFR
    kvm_arm_copy_fw_reg_indices [label="int kvm_arm_copy_fw_reg_indices (struct kvm_vcpu *vcpu, u64 __user *uindices)
hypercalls.c:413"]
    kvm_arm_copy_fw_reg_indices -> ARRAY_SIZE
    kvm_arm_copy_fw_reg_indices -> put_user
    copy_timer_indices [label="int copy_timer_indices (struct kvm_vcpu *vcpu, u64 __user *uindices)
guest.c:618"]
    kvm_arm_copy_sys_reg_indices [label="int kvm_arm_copy_sys_reg_indices (struct kvm_vcpu *vcpu, u64 __user *uindices)
sys_regs.c:3715"]
    kvm_arm_copy_sys_reg_indices -> ARRAY_SIZE
    kvm_arm_copy_sys_reg_indices -> put_user
    kvm_arm_copy_sys_reg_indices -> sys_reg_to_index
    kvm_arm_copy_sys_reg_indices -> walk_sys_regs
    kvm_arm_copy_sys_reg_indices -> write_demux_regids
    write_demux_regids [label="int write_demux_regids (u64 __user *uindices)
sys_regs.c:3631"]
    write_demux_regids -> put_user
    kvm_arm_vcpu_set_attr [label="int kvm_arm_vcpu_set_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
arm.c:1443"]
    kvm_arm_vcpu_set_attr -> kvm_arm_vcpu_arch_set_attr
    kvm_arm_vcpu_arch_set_attr [label="int kvm_arm_vcpu_arch_set_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
guest.c:943"]
    kvm_arm_vcpu_arch_set_attr -> mutex_lock
    kvm_arm_vcpu_arch_set_attr -> kvm_arm_pmu_v3_set_attr
    kvm_arm_vcpu_arch_set_attr -> mutex_unlock
    kvm_arm_vcpu_arch_set_attr -> kvm_arm_timer_set_attr
    kvm_arm_vcpu_arch_set_attr -> kvm_arm_pvtime_set_attr
    kvm_arm_pmu_v3_set_attr [label="int kvm_arm_pmu_v3_set_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
pmu-emul.c:981"]
    kvm_arm_pmu_v3_set_attr -> lockdep_assert_held
    kvm_arm_pmu_v3_set_attr -> kvm_vcpu_has_pmu
    kvm_arm_pmu_v3_set_attr -> irqchip_in_kernel
    kvm_arm_pmu_v3_set_attr -> get_user
    kvm_arm_pmu_v3_set_attr -> irq_is_ppi
    kvm_arm_pmu_v3_set_attr -> irq_is_spi
    kvm_arm_pmu_v3_set_attr -> pmu_irq_is_valid
    kvm_arm_pmu_v3_set_attr -> kvm_arm_pmu_irq_initialized
    kvm_arm_pmu_v3_set_attr -> kvm_debug
    kvm_arm_pmu_v3_set_attr -> kvm_arm_pmu_get_pmuver_limit
    kvm_arm_pmu_v3_set_attr -> copy_from_user
    kvm_arm_pmu_v3_set_attr -> kvm_vm_has_ran_once
    kvm_arm_pmu_v3_set_attr -> bitmap_alloc
    kvm_arm_pmu_v3_set_attr -> bitmap_zero
    kvm_arm_pmu_v3_set_attr -> bitmap_fill
    kvm_arm_pmu_v3_set_attr -> bitmap_set
    kvm_arm_pmu_v3_set_attr -> bitmap_clear
    kvm_arm_pmu_v3_set_attr -> kvm_arm_pmu_v3_set_pmu
    kvm_arm_pmu_v3_set_attr -> kvm_arm_pmu_v3_init
    irq_is_ppi [label="irq_is_ppi()"]
    irq_is_spi [label="irq_is_spi()"]
    pmu_irq_is_valid [label="bool pmu_irq_is_valid (struct kvm *kvm, int irq)
pmu-emul.c:884"]
    pmu_irq_is_valid -> kvm_for_each_vcpu
    pmu_irq_is_valid -> kvm_arm_pmu_irq_initialized
    pmu_irq_is_valid -> irq_is_ppi
    kvm_arm_pmu_irq_initialized [label="kvm_arm_pmu_irq_initialized()"]
    kvm_arm_pmu_get_pmuver_limit [label="u8 kvm_arm_pmu_get_pmuver_limit (void)
pmu-emul.c:1122"]
    kvm_arm_pmu_get_pmuver_limit -> read_sanitised_ftr_reg
    kvm_arm_pmu_get_pmuver_limit -> cpuid_feature_cap_perfmon_field
    kvm_arm_pmu_get_pmuver_limit -> FIELD_GET
    kvm_arm_pmu_get_pmuver_limit -> ARM64_FEATURE_MASK
    cpuid_feature_cap_perfmon_field [label="cpuid_feature_cap_perfmon_field()"]
    ARM64_FEATURE_MASK [label="ARM64_FEATURE_MASK()"]
    bitmap_alloc [label="bitmap_alloc()"]
    bitmap_fill [label="bitmap_fill()"]
    bitmap_set [label="bitmap_set()"]
    kvm_arm_pmu_v3_set_pmu [label="int kvm_arm_pmu_v3_set_pmu (struct kvm_vcpu *vcpu, int pmu_id)
pmu-emul.c:951"]
    kvm_arm_pmu_v3_set_pmu -> lockdep_assert_held
    kvm_arm_pmu_v3_set_pmu -> mutex_lock
    kvm_arm_pmu_v3_set_pmu -> list_for_each_entry
    kvm_arm_pmu_v3_set_pmu -> kvm_vm_has_ran_once
    kvm_arm_pmu_v3_set_pmu -> kvm_arm_set_pmu
    kvm_arm_pmu_v3_set_pmu -> cpumask_copy
    kvm_arm_pmu_v3_set_pmu -> mutex_unlock
    list_for_each_entry [label="list_for_each_entry()"]
    kvm_arm_set_pmu [label="void kvm_arm_set_pmu (struct kvm *kvm, struct arm_pmu *arm_pmu)
pmu-emul.c:920"]
    kvm_arm_set_pmu -> lockdep_assert_held
    kvm_arm_set_pmu -> kvm_arm_pmu_get_max_counters
    kvm_arm_pmu_get_max_counters [label="u8 kvm_arm_pmu_get_max_counters (struct kvm *kvm)
pmu-emul.c:909"]
    kvm_arm_pmu_v3_init [label="int kvm_arm_pmu_v3_init (struct kvm_vcpu *vcpu)
pmu-emul.c:850"]
    kvm_arm_pmu_v3_init -> irqchip_in_kernel
    kvm_arm_pmu_v3_init -> vgic_initialized
    kvm_arm_pmu_v3_init -> kvm_arm_pmu_irq_initialized
    kvm_arm_pmu_v3_init -> kvm_vgic_set_owner
    kvm_arm_pmu_v3_init -> init_irq_work
    kvm_arm_pmu_v3_init -> kvm_pmu_perf_overflow_notify_vcpu
    kvm_vgic_set_owner [label="kvm_vgic_set_owner()"]
    init_irq_work [label="init_irq_work()"]
    kvm_pmu_perf_overflow_notify_vcpu [label="void kvm_pmu_perf_overflow_notify_vcpu (struct irq_work *work)
pmu-emul.c:428"]
    kvm_pmu_perf_overflow_notify_vcpu -> container_of
    kvm_pmu_perf_overflow_notify_vcpu -> kvm_vcpu_kick
    kvm_arm_timer_set_attr [label="int kvm_arm_timer_set_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
arch_timer.c:1560"]
    kvm_arm_timer_set_attr -> irqchip_in_kernel
    kvm_arm_timer_set_attr -> get_user
    kvm_arm_timer_set_attr -> irq_is_ppi
    kvm_arm_timer_set_attr -> mutex_lock
    kvm_arm_timer_set_attr -> test_bit
    kvm_arm_timer_set_attr -> mutex_unlock
    kvm_arm_pvtime_set_attr [label="int kvm_arm_pvtime_set_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
pvtime.c:75"]
    kvm_arm_pvtime_set_attr -> kvm_arm_pvtime_supported
    kvm_arm_pvtime_set_attr -> get_user
    kvm_arm_pvtime_set_attr -> IS_ALIGNED
    kvm_arm_pvtime_set_attr -> srcu_read_lock
    kvm_arm_pvtime_set_attr -> kvm_is_error_hva
    kvm_arm_pvtime_set_attr -> gfn_to_hva
    kvm_arm_pvtime_set_attr -> srcu_read_unlock
    kvm_arm_pvtime_supported [label="bool kvm_arm_pvtime_supported (void)
pvtime.c:70"]
    kvm_arm_pvtime_supported -> sched_info_on
    sched_info_on [label="sched_info_on()"]
    kvm_is_error_hva [label="kvm_is_error_hva()"]
    gfn_to_hva [label="gfn_to_hva()"]
    kvm_arm_vcpu_get_attr [label="int kvm_arm_vcpu_get_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
arm.c:1457"]
    kvm_arm_vcpu_get_attr -> kvm_arm_vcpu_arch_get_attr
    kvm_arm_vcpu_arch_get_attr [label="int kvm_arm_vcpu_arch_get_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
guest.c:968"]
    kvm_arm_vcpu_arch_get_attr -> kvm_arm_pmu_v3_get_attr
    kvm_arm_vcpu_arch_get_attr -> kvm_arm_timer_get_attr
    kvm_arm_vcpu_arch_get_attr -> kvm_arm_pvtime_get_attr
    kvm_arm_pmu_v3_get_attr [label="int kvm_arm_pmu_v3_get_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
pmu-emul.c:1084"]
    kvm_arm_pmu_v3_get_attr -> irqchip_in_kernel
    kvm_arm_pmu_v3_get_attr -> kvm_vcpu_has_pmu
    kvm_arm_pmu_v3_get_attr -> kvm_arm_pmu_irq_initialized
    kvm_arm_pmu_v3_get_attr -> put_user
    kvm_arm_timer_get_attr [label="int kvm_arm_timer_get_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
arch_timer.c:1612"]
    kvm_arm_timer_get_attr -> vcpu_vtimer
    kvm_arm_timer_get_attr -> vcpu_ptimer
    kvm_arm_timer_get_attr -> vcpu_hvtimer
    kvm_arm_timer_get_attr -> vcpu_hptimer
    kvm_arm_timer_get_attr -> timer_irq
    kvm_arm_timer_get_attr -> put_user
    kvm_arm_pvtime_get_attr [label="int kvm_arm_pvtime_get_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
pvtime.c:107"]
    kvm_arm_pvtime_get_attr -> kvm_arm_pvtime_supported
    kvm_arm_pvtime_get_attr -> put_user
    kvm_arm_vcpu_has_attr [label="int kvm_arm_vcpu_has_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
arm.c:1471"]
    kvm_arm_vcpu_has_attr -> kvm_arm_vcpu_arch_has_attr
    kvm_arm_vcpu_arch_has_attr [label="int kvm_arm_vcpu_arch_has_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
guest.c:991"]
    kvm_arm_vcpu_arch_has_attr -> kvm_arm_pmu_v3_has_attr
    kvm_arm_vcpu_arch_has_attr -> kvm_arm_timer_has_attr
    kvm_arm_vcpu_arch_has_attr -> kvm_arm_pvtime_has_attr
    kvm_arm_pmu_v3_has_attr [label="int kvm_arm_pmu_v3_has_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
pmu-emul.c:1108"]
    kvm_arm_pmu_v3_has_attr -> kvm_vcpu_has_pmu
    kvm_arm_timer_has_attr [label="int kvm_arm_timer_has_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
arch_timer.c:1639"]
    kvm_arm_pvtime_has_attr [label="int kvm_arm_pvtime_has_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
pvtime.c:124"]
    kvm_arm_pvtime_has_attr -> kvm_arm_pvtime_supported
    kvm_arm_vcpu_get_events [label="int kvm_arm_vcpu_get_events (struct kvm_vcpu *vcpu, struct kvm_vcpu_events *events)
arm.c:1485"]
    kvm_arm_vcpu_get_events -> memset
    kvm_arm_vcpu_set_events [label="int kvm_arm_vcpu_set_events (struct kvm_vcpu *vcpu, struct kvm_vcpu_events *events)
arm.c:1493"]
    kvm_arm_vcpu_set_events -> ARRAY_SIZE
    kvm_arm_vcpu_finalize [label="int kvm_arm_vcpu_finalize (struct kvm_vcpu *vcpu, int feature)
reset.c:126"]
    kvm_arm_vcpu_finalize -> vcpu_has_sve
    kvm_arm_vcpu_finalize -> kvm_arm_vcpu_sve_finalized
    kvm_arm_vcpu_finalize -> kvm_vcpu_finalize_sve
    kvm_vcpu_finalize_sve [label="int kvm_vcpu_finalize_sve (struct kvm_vcpu *vcpu)
reset.c:92"]
    kvm_vcpu_finalize_sve -> WARN_ON
    kvm_vcpu_finalize_sve -> sve_vl_valid
    kvm_vcpu_finalize_sve -> sve_max_virtualisable_vl
    kvm_vcpu_finalize_sve -> vcpu_sve_state_size
    kvm_vcpu_finalize_sve -> kzalloc
    kvm_vcpu_finalize_sve -> kvm_share_hyp
    kvm_vcpu_finalize_sve -> kfree
    kvm_vcpu_finalize_sve -> vcpu_set_flag
    sve_max_virtualisable_vl [label="sve_max_virtualisable_vl()"]
    kvm_arch_vcpu_ioctl_get_fpu [label="int kvm_arch_vcpu_ioctl_get_fpu (struct kvm_vcpu *vcpu, struct kvm_fpu *fpu)
guest.c:887"]
    kvm_arch_vcpu_ioctl_get_mpstate [label="int kvm_arch_vcpu_ioctl_get_mpstate (struct kvm_vcpu *vcpu, struct kvm_mp_state *mp_state)
arm.c:519"]
    kvm_arch_vcpu_ioctl_get_mpstate -> READ_ONCE
    kvm_arch_vcpu_ioctl_get_regs [label="int kvm_arch_vcpu_ioctl_get_regs (struct kvm_vcpu *vcpu, struct kvm_regs *regs)
guest.c:535"]
    kvm_arch_vcpu_ioctl_get_sregs [label="int kvm_arch_vcpu_ioctl_get_sregs (struct kvm_vcpu *vcpu, struct kvm_sregs *sregs)
guest.c:802"]
    kvm_arch_vcpu_ioctl_run [label="int kvm_arch_vcpu_ioctl_run (struct kvm_vcpu *vcpu)
arm.c:960"]
    kvm_arch_vcpu_ioctl_run -> kvm_handle_mmio_return
    kvm_arch_vcpu_ioctl_run -> vcpu_load
    kvm_arch_vcpu_ioctl_run -> kvm_sigset_activate
    kvm_arch_vcpu_ioctl_run -> xfer_to_guest_mode_handle_work
    kvm_arch_vcpu_ioctl_run -> check_vcpu_requests
    kvm_arch_vcpu_ioctl_run -> preempt_disable
    kvm_arch_vcpu_ioctl_run -> kvm_arm_vmid_update
    kvm_arch_vcpu_ioctl_run -> has_vhe
    kvm_arch_vcpu_ioctl_run -> kvm_pmu_flush_hwstate
    kvm_arch_vcpu_ioctl_run -> local_irq_disable
    kvm_arch_vcpu_ioctl_run -> kvm_vgic_flush_hwstate
    kvm_arch_vcpu_ioctl_run -> kvm_pmu_update_vcpu_events
    kvm_arch_vcpu_ioctl_run -> smp_store_mb
    kvm_arch_vcpu_ioctl_run -> kvm_vcpu_exit_request
    kvm_arch_vcpu_ioctl_run -> isb
    kvm_arch_vcpu_ioctl_run -> kvm_pmu_sync_hwstate
    kvm_arch_vcpu_ioctl_run -> static_branch_unlikely
    kvm_arch_vcpu_ioctl_run -> kvm_timer_sync_user
    kvm_arch_vcpu_ioctl_run -> kvm_vgic_sync_hwstate
    kvm_arch_vcpu_ioctl_run -> local_irq_enable
    kvm_arch_vcpu_ioctl_run -> preempt_enable
    kvm_arch_vcpu_ioctl_run -> kvm_arm_setup_debug
    kvm_arch_vcpu_ioctl_run -> kvm_arch_vcpu_ctxflush_fp
    kvm_arch_vcpu_ioctl_run -> trace_kvm_entry
    kvm_arch_vcpu_ioctl_run -> vcpu_pc
    kvm_arch_vcpu_ioctl_run -> guest_timing_enter_irqoff
    kvm_arch_vcpu_ioctl_run -> kvm_arm_vcpu_enter_exit
    kvm_arch_vcpu_ioctl_run -> kvm_arm_clear_debug
    kvm_arch_vcpu_ioctl_run -> kvm_arch_vcpu_ctxsync_fp
    kvm_arch_vcpu_ioctl_run -> ARM_EXCEPTION_CODE
    kvm_arch_vcpu_ioctl_run -> guest_timing_exit_irqoff
    kvm_arch_vcpu_ioctl_run -> trace_kvm_exit
    kvm_arch_vcpu_ioctl_run -> kvm_vcpu_trap_get_class
    kvm_arch_vcpu_ioctl_run -> handle_exit_early
    kvm_arch_vcpu_ioctl_run -> vcpu_mode_is_bad_32bit
    kvm_arch_vcpu_ioctl_run -> vcpu_clear_flag
    kvm_arch_vcpu_ioctl_run -> handle_exit
    kvm_arch_vcpu_ioctl_run -> unlikely
    kvm_arch_vcpu_ioctl_run -> irqchip_in_kernel
    kvm_arch_vcpu_ioctl_run -> kvm_timer_update_run
    kvm_arch_vcpu_ioctl_run -> kvm_pmu_update_run
    kvm_arch_vcpu_ioctl_run -> kvm_sigset_deactivate
    kvm_arch_vcpu_ioctl_run -> vcpu_get_flag
    kvm_arch_vcpu_ioctl_run -> kvm_call_hyp
    kvm_arch_vcpu_ioctl_run -> vcpu_put
    kvm_handle_mmio_return [label="int kvm_handle_mmio_return (struct kvm_vcpu *vcpu)
mmio.c:81"]
    kvm_handle_mmio_return -> unlikely
    kvm_handle_mmio_return -> kvm_vcpu_dabt_iswrite
    kvm_handle_mmio_return -> kvm_vcpu_dabt_get_as
    kvm_handle_mmio_return -> kvm_mmio_read_buf
    kvm_handle_mmio_return -> kvm_vcpu_dabt_issext
    kvm_handle_mmio_return -> kvm_vcpu_dabt_issf
    kvm_handle_mmio_return -> trace_kvm_mmio
    kvm_handle_mmio_return -> vcpu_data_host_to_guest
    kvm_handle_mmio_return -> vcpu_set_reg
    kvm_handle_mmio_return -> kvm_vcpu_dabt_get_rd
    kvm_handle_mmio_return -> kvm_incr_pc
    kvm_vcpu_dabt_iswrite [label="kvm_vcpu_dabt_iswrite()"]
    kvm_vcpu_dabt_get_as [label="kvm_vcpu_dabt_get_as()"]
    kvm_mmio_read_buf [label="unsigned long kvm_mmio_read_buf (const void *buf, unsigned int len)
mmio.c:45"]
    kvm_mmio_read_buf -> memcpy
    kvm_vcpu_dabt_issext [label="kvm_vcpu_dabt_issext()"]
    kvm_vcpu_dabt_issf [label="kvm_vcpu_dabt_issf()"]
    trace_kvm_mmio [label="trace_kvm_mmio()"]
    vcpu_data_host_to_guest [label="vcpu_data_host_to_guest()"]
    kvm_vcpu_dabt_get_rd [label="kvm_vcpu_dabt_get_rd()"]
    vcpu_load [label="vcpu_load()"]
    kvm_sigset_activate [label="kvm_sigset_activate()"]
    xfer_to_guest_mode_handle_work [label="xfer_to_guest_mode_handle_work()"]
    check_vcpu_requests [label="int check_vcpu_requests (struct kvm_vcpu *vcpu)
arm.c:833"]
    check_vcpu_requests -> kvm_request_pending
    check_vcpu_requests -> kvm_check_request
    check_vcpu_requests -> kvm_vcpu_sleep
    check_vcpu_requests -> kvm_reset_vcpu
    check_vcpu_requests -> kvm_update_stolen_time
    check_vcpu_requests -> preempt_disable
    check_vcpu_requests -> vgic_v4_put
    check_vcpu_requests -> vgic_v4_load
    check_vcpu_requests -> preempt_enable
    check_vcpu_requests -> kvm_vcpu_reload_pmu
    check_vcpu_requests -> kvm_vcpu_pmu_restore_guest
    check_vcpu_requests -> kvm_vcpu_suspend
    check_vcpu_requests -> kvm_dirty_ring_check_request
    kvm_request_pending [label="kvm_request_pending()"]
    kvm_vcpu_sleep [label="void kvm_vcpu_sleep (struct kvm_vcpu *vcpu)
arm.c:735"]
    kvm_vcpu_sleep -> kvm_arch_vcpu_get_wait
    kvm_vcpu_sleep -> rcuwait_wait_event
    kvm_vcpu_sleep -> kvm_arm_vcpu_stopped
    kvm_vcpu_sleep -> kvm_make_request
    kvm_vcpu_sleep -> smp_rmb
    kvm_arch_vcpu_get_wait [label="kvm_arch_vcpu_get_wait()"]
    rcuwait_wait_event [label="rcuwait_wait_event()"]
    smp_rmb [label="smp_rmb()"]
    kvm_update_stolen_time [label="void kvm_update_stolen_time (struct kvm_vcpu *vcpu)
pvtime.c:13"]
    kvm_update_stolen_time -> offsetof
    kvm_update_stolen_time -> srcu_read_lock
    kvm_update_stolen_time -> kvm_get_guest
    kvm_update_stolen_time -> le64_to_cpu
    kvm_update_stolen_time -> READ_ONCE
    kvm_update_stolen_time -> kvm_put_guest
    kvm_update_stolen_time -> cpu_to_le64
    kvm_update_stolen_time -> srcu_read_unlock
    offsetof [label="offsetof()"]
    kvm_get_guest [label="kvm_get_guest()"]
    le64_to_cpu [label="le64_to_cpu()"]
    kvm_put_guest [label="kvm_put_guest()"]
    cpu_to_le64 [label="cpu_to_le64()"]
    kvm_vcpu_reload_pmu [label="void kvm_vcpu_reload_pmu (struct kvm_vcpu *vcpu)
pmu-emul.c:806"]
    kvm_vcpu_reload_pmu -> kvm_pmu_valid_counter_mask
    kvm_vcpu_reload_pmu -> kvm_pmu_handle_pmcr
    kvm_vcpu_reload_pmu -> kvm_vcpu_read_pmcr
    kvm_vcpu_suspend [label="int kvm_vcpu_suspend (struct kvm_vcpu *vcpu)
arm.c:791"]
    kvm_vcpu_suspend -> kvm_arm_vcpu_suspended
    kvm_vcpu_suspend -> kvm_vcpu_wfi
    kvm_vcpu_suspend -> kvm_make_request
    kvm_vcpu_suspend -> kvm_arch_vcpu_runnable
    kvm_vcpu_suspend -> memset
    kvm_arm_vcpu_suspended [label="bool kvm_arm_vcpu_suspended (struct kvm_vcpu *vcpu)
arm.c:514"]
    kvm_arm_vcpu_suspended -> READ_ONCE
    kvm_arch_vcpu_runnable [label="int kvm_arch_vcpu_runnable (struct kvm_vcpu *v)
arm.c:560"]
    kvm_arch_vcpu_runnable -> vcpu_hcr
    kvm_arch_vcpu_runnable -> kvm_vgic_vcpu_pending_irq
    kvm_arch_vcpu_runnable -> kvm_arm_vcpu_stopped
    kvm_vgic_vcpu_pending_irq [label="kvm_vgic_vcpu_pending_irq()"]
    kvm_dirty_ring_check_request [label="kvm_dirty_ring_check_request()"]
    kvm_arm_vmid_update [label="bool kvm_arm_vmid_update (struct kvm_vmid *kvm_vmid)
vmid.c:138"]
    kvm_arm_vmid_update -> atomic64_read
    kvm_arm_vmid_update -> this_cpu_ptr
    kvm_arm_vmid_update -> vmid_gen_match
    kvm_arm_vmid_update -> atomic64_cmpxchg_relaxed
    kvm_arm_vmid_update -> raw_spin_lock_irqsave
    kvm_arm_vmid_update -> new_vmid
    kvm_arm_vmid_update -> atomic64_set
    kvm_arm_vmid_update -> raw_spin_unlock_irqrestore
    atomic64_read [label="atomic64_read()"]
    vmid_gen_match [label="vmid_gen_match()"]
    atomic64_cmpxchg_relaxed [label="atomic64_cmpxchg_relaxed()"]
    raw_spin_lock_irqsave [label="raw_spin_lock_irqsave()"]
    new_vmid [label="u64 new_vmid (struct kvm_vmid *kvm_vmid)
vmid.c:92"]
    new_vmid -> atomic64_read
    new_vmid -> check_update_reserved_vmid
    new_vmid -> atomic64_set
    new_vmid -> vmid2idx
    new_vmid -> find_next_zero_bit
    new_vmid -> atomic64_add_return_relaxed
    new_vmid -> flush_context
    new_vmid -> idx2vmid
    check_update_reserved_vmid [label="bool check_update_reserved_vmid (u64 vmid, u64 newvmid)
vmid.c:72"]
    check_update_reserved_vmid -> for_each_possible_cpu
    check_update_reserved_vmid -> per_cpu
    per_cpu [label="per_cpu()"]
    vmid2idx [label="vmid2idx()"]
    find_next_zero_bit [label="find_next_zero_bit()"]
    atomic64_add_return_relaxed [label="atomic64_add_return_relaxed()"]
    flush_context [label="void flush_context (void)
vmid.c:45"]
    flush_context -> bitmap_zero
    flush_context -> for_each_possible_cpu
    flush_context -> atomic64_xchg_relaxed
    flush_context -> per_cpu
    flush_context -> vmid2idx
    flush_context -> kvm_call_hyp
    atomic64_xchg_relaxed [label="atomic64_xchg_relaxed()"]
    idx2vmid [label="idx2vmid()"]
    raw_spin_unlock_irqrestore [label="raw_spin_unlock_irqrestore()"]
    kvm_pmu_flush_hwstate [label="void kvm_pmu_flush_hwstate (struct kvm_vcpu *vcpu)
pmu-emul.c:406"]
    kvm_pmu_flush_hwstate -> kvm_pmu_update_state
    kvm_pmu_update_state [label="void kvm_pmu_update_state (struct kvm_vcpu *vcpu)
pmu-emul.c:353"]
    kvm_pmu_update_state -> kvm_vcpu_has_pmu
    kvm_pmu_update_state -> kvm_pmu_overflow_status
    kvm_pmu_update_state -> likely
    kvm_pmu_update_state -> irqchip_in_kernel
    kvm_pmu_update_state -> kvm_vgic_inject_irq
    kvm_pmu_update_state -> WARN_ON
    local_irq_disable [label="local_irq_disable()"]
    kvm_vgic_flush_hwstate [label="kvm_vgic_flush_hwstate()"]
    kvm_pmu_update_vcpu_events [label="kvm_pmu_update_vcpu_events()"]
    smp_store_mb [label="smp_store_mb()"]
    kvm_vcpu_exit_request [label="bool kvm_vcpu_exit_request (struct kvm_vcpu *vcpu, int *ret)
arm.c:900"]
    kvm_vcpu_exit_request -> static_branch_unlikely
    kvm_vcpu_exit_request -> kvm_timer_should_notify_user
    kvm_vcpu_exit_request -> kvm_pmu_should_notify_user
    kvm_vcpu_exit_request -> unlikely
    kvm_vcpu_exit_request -> vcpu_on_unsupported_cpu
    kvm_vcpu_exit_request -> smp_processor_id
    kvm_vcpu_exit_request -> kvm_request_pending
    kvm_vcpu_exit_request -> xfer_to_guest_mode_work_pending
    kvm_timer_should_notify_user [label="bool kvm_timer_should_notify_user (struct kvm_vcpu *vcpu)
arch_timer.c:861"]
    kvm_timer_should_notify_user -> vcpu_vtimer
    kvm_timer_should_notify_user -> vcpu_ptimer
    kvm_timer_should_notify_user -> likely
    kvm_timer_should_notify_user -> irqchip_in_kernel
    kvm_timer_should_notify_user -> kvm_timer_should_fire
    kvm_pmu_should_notify_user [label="bool kvm_pmu_should_notify_user (struct kvm_vcpu *vcpu)
pmu-emul.c:374"]
    kvm_pmu_should_notify_user -> likely
    kvm_pmu_should_notify_user -> irqchip_in_kernel
    vcpu_on_unsupported_cpu [label="vcpu_on_unsupported_cpu()"]
    xfer_to_guest_mode_work_pending [label="xfer_to_guest_mode_work_pending()"]
    kvm_pmu_sync_hwstate [label="void kvm_pmu_sync_hwstate (struct kvm_vcpu *vcpu)
pmu-emul.c:418"]
    kvm_pmu_sync_hwstate -> kvm_pmu_update_state
    kvm_timer_sync_user [label="void kvm_timer_sync_user (struct kvm_vcpu *vcpu)
arch_timer.c:928"]
    kvm_timer_sync_user -> vcpu_timer
    kvm_timer_sync_user -> unlikely
    kvm_timer_sync_user -> irqchip_in_kernel
    kvm_timer_sync_user -> unmask_vtimer_irq_user
    unmask_vtimer_irq_user [label="void unmask_vtimer_irq_user (struct kvm_vcpu *vcpu)
arch_timer.c:915"]
    unmask_vtimer_irq_user -> vcpu_vtimer
    unmask_vtimer_irq_user -> kvm_timer_should_fire
    unmask_vtimer_irq_user -> kvm_timer_update_irq
    unmask_vtimer_irq_user -> static_branch_likely
    unmask_vtimer_irq_user -> set_timer_irq_phys_active
    unmask_vtimer_irq_user -> enable_percpu_irq
    kvm_vgic_sync_hwstate [label="kvm_vgic_sync_hwstate()"]
    local_irq_enable [label="local_irq_enable()"]
    kvm_arm_setup_debug [label="void kvm_arm_setup_debug (struct kvm_vcpu *vcpu)
debug.c:169"]
    kvm_arm_setup_debug -> trace_kvm_arm_setup_debug
    kvm_arm_setup_debug -> kvm_arm_setup_mdcr_el2
    kvm_arm_setup_debug -> kvm_vcpu_os_lock_enabled
    kvm_arm_setup_debug -> save_guest_debug_regs
    kvm_arm_setup_debug -> vcpu_get_flag
    kvm_arm_setup_debug -> vcpu_cpsr
    kvm_arm_setup_debug -> vcpu_read_sys_reg
    kvm_arm_setup_debug -> vcpu_write_sys_reg
    kvm_arm_setup_debug -> trace_kvm_arm_set_dreg32
    kvm_arm_setup_debug -> vcpu_set_flag
    kvm_arm_setup_debug -> trace_kvm_arm_set_regset
    kvm_arm_setup_debug -> get_num_brps
    kvm_arm_setup_debug -> get_num_wrps
    kvm_arm_setup_debug -> BUG_ON
    kvm_arm_setup_debug -> has_vhe
    kvm_arm_setup_debug -> write_sysreg
    trace_kvm_arm_setup_debug [label="trace_kvm_arm_setup_debug()"]
    kvm_arm_setup_mdcr_el2 [label="void kvm_arm_setup_mdcr_el2 (struct kvm_vcpu *vcpu)
debug.c:96"]
    kvm_arm_setup_mdcr_el2 -> vcpu_get_flag
    kvm_arm_setup_mdcr_el2 -> kvm_vcpu_os_lock_enabled
    kvm_arm_setup_mdcr_el2 -> trace_kvm_arm_set_dreg32
    kvm_vcpu_os_lock_enabled [label="kvm_vcpu_os_lock_enabled()"]
    trace_kvm_arm_set_dreg32 [label="trace_kvm_arm_set_dreg32()"]
    save_guest_debug_regs [label="void save_guest_debug_regs (struct kvm_vcpu *vcpu)
debug.c:40"]
    save_guest_debug_regs -> vcpu_read_sys_reg
    save_guest_debug_regs -> trace_kvm_arm_set_dreg32
    save_guest_debug_regs -> vcpu_cpsr
    trace_kvm_arm_set_regset [label="trace_kvm_arm_set_regset()"]
    get_num_brps [label="get_num_brps()"]
    get_num_wrps [label="get_num_wrps()"]
    kvm_arch_vcpu_ctxflush_fp [label="void kvm_arch_vcpu_ctxflush_fp (struct kvm_vcpu *vcpu)
fpsimd.c:126"]
    kvm_arch_vcpu_ctxflush_fp -> test_thread_flag
    test_thread_flag [label="test_thread_flag()"]
    trace_kvm_entry [label="trace_kvm_entry()"]
    guest_timing_enter_irqoff [label="guest_timing_enter_irqoff()"]
    kvm_arm_vcpu_enter_exit [label="int noinstr kvm_arm_vcpu_enter_exit (struct kvm_vcpu *vcpu)
arm.c:939"]
    kvm_arm_vcpu_enter_exit -> guest_state_enter_irqoff
    kvm_arm_vcpu_enter_exit -> kvm_call_hyp_ret
    kvm_arm_vcpu_enter_exit -> guest_state_exit_irqoff
    guest_state_enter_irqoff [label="guest_state_enter_irqoff()"]
    guest_state_exit_irqoff [label="guest_state_exit_irqoff()"]
    kvm_arm_clear_debug [label="void kvm_arm_clear_debug (struct kvm_vcpu *vcpu)
debug.c:280"]
    kvm_arm_clear_debug -> trace_kvm_arm_clear_debug
    kvm_arm_clear_debug -> kvm_vcpu_os_lock_enabled
    kvm_arm_clear_debug -> vcpu_cpsr
    kvm_arm_clear_debug -> vcpu_set_flag
    kvm_arm_clear_debug -> restore_guest_debug_regs
    kvm_arm_clear_debug -> kvm_arm_reset_debug_ptr
    kvm_arm_clear_debug -> trace_kvm_arm_set_regset
    kvm_arm_clear_debug -> get_num_brps
    kvm_arm_clear_debug -> get_num_wrps
    trace_kvm_arm_clear_debug [label="trace_kvm_arm_clear_debug()"]
    restore_guest_debug_regs [label="void restore_guest_debug_regs (struct kvm_vcpu *vcpu)
debug.c:53"]
    restore_guest_debug_regs -> vcpu_write_sys_reg
    restore_guest_debug_regs -> trace_kvm_arm_set_dreg32
    restore_guest_debug_regs -> vcpu_read_sys_reg
    restore_guest_debug_regs -> vcpu_cpsr
    kvm_arch_vcpu_ctxsync_fp [label="void kvm_arch_vcpu_ctxsync_fp (struct kvm_vcpu *vcpu)
fpsimd.c:139"]
    kvm_arch_vcpu_ctxsync_fp -> WARN_ON_ONCE
    kvm_arch_vcpu_ctxsync_fp -> irqs_disabled
    kvm_arch_vcpu_ctxsync_fp -> vcpu_has_sve
    kvm_arch_vcpu_ctxsync_fp -> fpsimd_bind_state_to_cpu
    kvm_arch_vcpu_ctxsync_fp -> clear_thread_flag
    irqs_disabled [label="irqs_disabled()"]
    fpsimd_bind_state_to_cpu [label="fpsimd_bind_state_to_cpu()"]
    clear_thread_flag [label="clear_thread_flag()"]
    ARM_EXCEPTION_CODE [label="ARM_EXCEPTION_CODE()"]
    guest_timing_exit_irqoff [label="guest_timing_exit_irqoff()"]
    trace_kvm_exit [label="trace_kvm_exit()"]
    kvm_vcpu_trap_get_class [label="kvm_vcpu_trap_get_class()"]
    handle_exit_early [label="void handle_exit_early (struct kvm_vcpu *vcpu, int exception_index)
handle_exit.c:366"]
    handle_exit_early -> ARM_SERROR_PENDING
    handle_exit_early -> this_cpu_has_cap
    handle_exit_early -> kvm_vcpu_get_disr
    handle_exit_early -> kvm_handle_guest_serror
    handle_exit_early -> disr_to_esr
    handle_exit_early -> kvm_inject_vabt
    handle_exit_early -> ARM_EXCEPTION_CODE
    handle_exit_early -> kvm_vcpu_get_esr
    ARM_SERROR_PENDING [label="ARM_SERROR_PENDING()"]
    kvm_vcpu_get_disr [label="kvm_vcpu_get_disr()"]
    kvm_handle_guest_serror [label="void kvm_handle_guest_serror (struct kvm_vcpu *vcpu, u64 esr)
handle_exit.c:31"]
    kvm_handle_guest_serror -> arm64_is_ras_serror
    kvm_handle_guest_serror -> arm64_is_fatal_ras_serror
    kvm_handle_guest_serror -> kvm_inject_vabt
    arm64_is_ras_serror [label="arm64_is_ras_serror()"]
    arm64_is_fatal_ras_serror [label="arm64_is_fatal_ras_serror()"]
    kvm_inject_vabt [label="void kvm_inject_vabt (struct kvm_vcpu *vcpu)
inject_fault.c:251"]
    kvm_inject_vabt -> kvm_set_sei_esr
    kvm_set_sei_esr [label="void kvm_set_sei_esr (struct kvm_vcpu *vcpu, u64 esr)
inject_fault.c:233"]
    kvm_set_sei_esr -> vcpu_set_vsesr
    kvm_set_sei_esr -> vcpu_hcr
    vcpu_set_vsesr [label="vcpu_set_vsesr()"]
    disr_to_esr [label="disr_to_esr()"]
    vcpu_mode_is_bad_32bit [label="bool vcpu_mode_is_bad_32bit (struct kvm_vcpu *vcpu)
arm.c:875"]
    vcpu_mode_is_bad_32bit -> likely
    vcpu_mode_is_bad_32bit -> vcpu_mode_is_32bit
    vcpu_mode_is_bad_32bit -> vcpu_has_nv
    vcpu_mode_is_bad_32bit -> kvm_supports_32bit_el0
    handle_exit [label="int handle_exit (struct kvm_vcpu *vcpu, int exception_index)
handle_exit.c:322"]
    handle_exit -> ARM_SERROR_PENDING
    handle_exit -> ARM_EXCEPTION_CODE
    handle_exit -> handle_trap_exceptions
    handle_exit -> kvm_pr_unimpl
    handle_trap_exceptions [label="int handle_trap_exceptions (struct kvm_vcpu *vcpu)
handle_exit.c:297"]
    handle_trap_exceptions -> kvm_condition_valid
    handle_trap_exceptions -> kvm_incr_pc
    handle_trap_exceptions -> kvm_get_exit_handler
    kvm_condition_valid [label="kvm_condition_valid()"]
    kvm_get_exit_handler [label="exit_handle_fn kvm_get_exit_handler (struct kvm_vcpu *vcpu)
handle_exit.c:283"]
    kvm_get_exit_handler -> kvm_vcpu_get_esr
    kvm_get_exit_handler -> ESR_ELx_EC
    kvm_pr_unimpl [label="kvm_pr_unimpl()"]
    kvm_timer_update_run [label="void kvm_timer_update_run (struct kvm_vcpu *vcpu)
arch_timer.c:431"]
    kvm_timer_update_run -> vcpu_vtimer
    kvm_timer_update_run -> vcpu_ptimer
    kvm_timer_update_run -> kvm_timer_should_fire
    kvm_pmu_update_run [label="void kvm_pmu_update_run (struct kvm_vcpu *vcpu)
pmu-emul.c:389"]
    kvm_sigset_deactivate [label="kvm_sigset_deactivate()"]
    vcpu_put [label="vcpu_put()"]
    kvm_arch_vcpu_ioctl_set_fpu [label="int kvm_arch_vcpu_ioctl_set_fpu (struct kvm_vcpu *vcpu, struct kvm_fpu *fpu)
guest.c:892"]
    kvm_arch_vcpu_ioctl_set_guest_debug [label="int kvm_arch_vcpu_ioctl_set_guest_debug (struct kvm_vcpu *vcpu, struct kvm_guest_debug *dbg)
guest.c:913"]
    kvm_arch_vcpu_ioctl_set_guest_debug -> trace_kvm_set_guest_debug
    kvm_arch_vcpu_ioctl_set_guest_debug -> vcpu_clear_flag
    trace_kvm_set_guest_debug [label="trace_kvm_set_guest_debug()"]
    kvm_arch_vcpu_ioctl_set_mpstate [label="int kvm_arch_vcpu_ioctl_set_mpstate (struct kvm_vcpu *vcpu, struct kvm_mp_state *mp_state)
arm.c:527"]
    kvm_arch_vcpu_ioctl_set_mpstate -> spin_lock
    kvm_arch_vcpu_ioctl_set_mpstate -> WRITE_ONCE
    kvm_arch_vcpu_ioctl_set_mpstate -> kvm_arm_vcpu_suspend
    kvm_arch_vcpu_ioctl_set_mpstate -> spin_unlock
    kvm_arm_vcpu_suspend [label="void kvm_arm_vcpu_suspend (struct kvm_vcpu *vcpu)
arm.c:507"]
    kvm_arm_vcpu_suspend -> WRITE_ONCE
    kvm_arm_vcpu_suspend -> kvm_make_request
    kvm_arm_vcpu_suspend -> kvm_vcpu_kick
    kvm_arch_vcpu_ioctl_set_regs [label="int kvm_arch_vcpu_ioctl_set_regs (struct kvm_vcpu *vcpu, struct kvm_regs *regs)
guest.c:540"]
    kvm_arch_vcpu_ioctl_set_sregs [label="int kvm_arch_vcpu_ioctl_set_sregs (struct kvm_vcpu *vcpu, struct kvm_sregs *sregs)
guest.c:808"]
    kvm_arch_vcpu_ioctl_translate [label="int kvm_arch_vcpu_ioctl_translate (struct kvm_vcpu *vcpu, struct kvm_translation *tr)
guest.c:897"]
    kvm_arch_vcpu_postcreate [label="void kvm_arch_vcpu_postcreate (struct kvm_vcpu *vcpu)
arm.c:401"]
    kvm_arch_vcpu_precreate [label="int kvm_arch_vcpu_precreate (struct kvm *kvm, unsigned int id)
arm.c:347"]
    kvm_arch_vcpu_precreate -> irqchip_in_kernel
    kvm_arch_vcpu_precreate -> vgic_initialized
    kvm_arch_vcpu_run_pid_change [label="int kvm_arch_vcpu_run_pid_change (struct kvm_vcpu *vcpu)
arm.c:640"]
    kvm_arch_vcpu_run_pid_change -> kvm_vcpu_initialized
    kvm_arch_vcpu_run_pid_change -> kvm_arm_vcpu_is_finalized
    kvm_arch_vcpu_run_pid_change -> kvm_arch_vcpu_run_map_fp
    kvm_arch_vcpu_run_pid_change -> likely
    kvm_arch_vcpu_run_pid_change -> vcpu_has_run_once
    kvm_arch_vcpu_run_pid_change -> kvm_init_mpidr_data
    kvm_arch_vcpu_run_pid_change -> kvm_arm_vcpu_init_debug
    kvm_arch_vcpu_run_pid_change -> irqchip_in_kernel
    kvm_arch_vcpu_run_pid_change -> kvm_vgic_map_resources
    kvm_arch_vcpu_run_pid_change -> kvm_timer_enable
    kvm_arch_vcpu_run_pid_change -> kvm_arm_pmu_v3_enable
    kvm_arch_vcpu_run_pid_change -> is_protected_kvm_enabled
    kvm_arch_vcpu_run_pid_change -> pkvm_create_hyp_vm
    kvm_arch_vcpu_run_pid_change -> static_branch_inc
    kvm_arch_vcpu_run_pid_change -> kvm_vm_is_protected
    kvm_arch_vcpu_run_pid_change -> kvm_call_hyp_nvhe
    kvm_arch_vcpu_run_pid_change -> mutex_lock
    kvm_arch_vcpu_run_pid_change -> set_bit
    kvm_arch_vcpu_run_pid_change -> mutex_unlock
    kvm_arch_vcpu_run_map_fp [label="int kvm_arch_vcpu_run_map_fp (struct kvm_vcpu *vcpu)
fpsimd.c:39"]
    kvm_arch_vcpu_run_map_fp -> kvm_vcpu_unshare_task_fp
    kvm_arch_vcpu_run_map_fp -> kvm_share_hyp
    kvm_arch_vcpu_run_map_fp -> kern_hyp_va
    kvm_arch_vcpu_run_map_fp -> is_protected_kvm_enabled
    kvm_arch_vcpu_run_map_fp -> get_task_struct
    get_task_struct [label="get_task_struct()"]
    kvm_init_mpidr_data [label="void kvm_init_mpidr_data (struct kvm *kvm)
arm.c:584"]
    kvm_init_mpidr_data -> mutex_lock
    kvm_init_mpidr_data -> atomic_read
    kvm_init_mpidr_data -> kvm_for_each_vcpu
    kvm_init_mpidr_data -> kvm_vcpu_get_mpidr_aff
    kvm_init_mpidr_data -> BIT_ULL
    kvm_init_mpidr_data -> hweight_long
    kvm_init_mpidr_data -> struct_size
    kvm_init_mpidr_data -> kzalloc
    kvm_init_mpidr_data -> kvm_mpidr_index
    kvm_init_mpidr_data -> mutex_unlock
    atomic_read [label="atomic_read()"]
    hweight_long [label="hweight_long()"]
    struct_size [label="struct_size()"]
    kvm_arm_vcpu_init_debug [label="void kvm_arm_vcpu_init_debug (struct kvm_vcpu *vcpu)
debug.c:137"]
    kvm_arm_vcpu_init_debug -> preempt_disable
    kvm_arm_vcpu_init_debug -> kvm_arm_setup_mdcr_el2
    kvm_arm_vcpu_init_debug -> preempt_enable
    kvm_vgic_map_resources [label="kvm_vgic_map_resources()"]
    kvm_timer_enable [label="int kvm_timer_enable (struct kvm_vcpu *vcpu)
arch_timer.c:1507"]
    kvm_timer_enable -> vcpu_timer
    kvm_timer_enable -> irqchip_in_kernel
    kvm_timer_enable -> timer_irqs_are_valid
    kvm_timer_enable -> kvm_debug
    kvm_timer_enable -> get_timer_map
    kvm_timer_enable -> kvm_vgic_map_phys_irq
    kvm_timer_enable -> timer_irq
    timer_irqs_are_valid [label="bool timer_irqs_are_valid (struct kvm_vcpu *vcpu)
arch_timer.c:1453"]
    timer_irqs_are_valid -> mutex_lock
    timer_irqs_are_valid -> hweight32
    timer_irqs_are_valid -> nr_timers
    timer_irqs_are_valid -> set_bit
    timer_irqs_are_valid -> mutex_unlock
    hweight32 [label="hweight32()"]
    kvm_arm_pmu_v3_enable [label="int kvm_arm_pmu_v3_enable (struct kvm_vcpu *vcpu)
pmu-emul.c:817"]
    kvm_arm_pmu_v3_enable -> kvm_vcpu_has_pmu
    kvm_arm_pmu_v3_enable -> irqchip_in_kernel
    kvm_arm_pmu_v3_enable -> irq_is_ppi
    kvm_arm_pmu_v3_enable -> vgic_valid_spi
    kvm_arm_pmu_v3_enable -> kvm_arm_pmu_irq_initialized
    kvm_arm_pmu_v3_enable -> kvm_make_request
    vgic_valid_spi [label="vgic_valid_spi()"]
    pkvm_create_hyp_vm [label="int pkvm_create_hyp_vm (struct kvm *host_kvm)
pkvm.c:204"]
    pkvm_create_hyp_vm -> mutex_lock
    pkvm_create_hyp_vm -> mutex_unlock
    static_branch_inc [label="static_branch_inc()"]
    kvm_vm_is_protected [label="kvm_vm_is_protected()"]
    kvm_arch_vcpu_should_kick [label="int kvm_arch_vcpu_should_kick (struct kvm_vcpu *vcpu)
arm.c:67"]
    kvm_arch_vcpu_should_kick -> kvm_vcpu_exiting_guest_mode
    kvm_vcpu_exiting_guest_mode [label="kvm_vcpu_exiting_guest_mode()"]
    kvm_arch_vcpu_unblocking [label="void kvm_arch_vcpu_unblocking (struct kvm_vcpu *vcpu)
arm.c:422"]
    kvm_arch_vm_ioctl [label="int kvm_arch_vm_ioctl (struct file *filp, unsigned int ioctl, unsigned long arg)
arm.c:1678"]
    kvm_arch_vm_ioctl -> mutex_lock
    kvm_arch_vm_ioctl -> kvm_vgic_create
    kvm_arch_vm_ioctl -> mutex_unlock
    kvm_arch_vm_ioctl -> copy_from_user
    kvm_arch_vm_ioctl -> kvm_vm_ioctl_set_device_addr
    kvm_arch_vm_ioctl -> copy_to_user
    kvm_arch_vm_ioctl -> kvm_vm_ioctl_mte_copy_tags
    kvm_arch_vm_ioctl -> kvm_vm_ioctl_set_counter_offset
    kvm_arch_vm_ioctl -> kvm_vm_has_attr
    kvm_arch_vm_ioctl -> kvm_vm_set_attr
    kvm_arch_vm_ioctl -> kvm_vm_ioctl_get_reg_writable_masks
    kvm_vgic_create [label="kvm_vgic_create()"]
    kvm_vm_ioctl_set_device_addr [label="int kvm_vm_ioctl_set_device_addr (struct kvm *kvm, struct kvm_arm_device_addr *dev_addr)
arm.c:1645"]
    kvm_vm_ioctl_set_device_addr -> FIELD_GET
    kvm_vm_ioctl_set_device_addr -> kvm_set_legacy_vgic_v2_addr
    kvm_set_legacy_vgic_v2_addr [label="kvm_set_legacy_vgic_v2_addr()"]
    kvm_vm_ioctl_mte_copy_tags [label="int kvm_vm_ioctl_mte_copy_tags (struct kvm *kvm, struct kvm_arm_copy_mte_tags *copy_tags)
guest.c:1014"]
    kvm_vm_ioctl_mte_copy_tags -> kvm_has_mte
    kvm_vm_ioctl_mte_copy_tags -> gpa_to_gfn
    kvm_vm_ioctl_mte_copy_tags -> mutex_lock
    kvm_vm_ioctl_mte_copy_tags -> gfn_to_pfn_prot
    kvm_vm_ioctl_mte_copy_tags -> is_error_noslot_pfn
    kvm_vm_ioctl_mte_copy_tags -> pfn_to_online_page
    kvm_vm_ioctl_mte_copy_tags -> page_address
    kvm_vm_ioctl_mte_copy_tags -> page_mte_tagged
    kvm_vm_ioctl_mte_copy_tags -> mte_copy_tags_to_user
    kvm_vm_ioctl_mte_copy_tags -> clear_user
    kvm_vm_ioctl_mte_copy_tags -> kvm_release_pfn_clean
    kvm_vm_ioctl_mte_copy_tags -> try_page_mte_tagging
    kvm_vm_ioctl_mte_copy_tags -> mte_copy_tags_from_user
    kvm_vm_ioctl_mte_copy_tags -> mte_clear_page_tags
    kvm_vm_ioctl_mte_copy_tags -> set_page_mte_tagged
    kvm_vm_ioctl_mte_copy_tags -> kvm_release_pfn_dirty
    kvm_vm_ioctl_mte_copy_tags -> mutex_unlock
    gpa_to_gfn [label="gpa_to_gfn()"]
    gfn_to_pfn_prot [label="gfn_to_pfn_prot()"]
    is_error_noslot_pfn [label="is_error_noslot_pfn()"]
    pfn_to_online_page [label="pfn_to_online_page()"]
    page_address [label="page_address()"]
    page_mte_tagged [label="page_mte_tagged()"]
    mte_copy_tags_to_user [label="mte_copy_tags_to_user()"]
    kvm_release_pfn_clean [label="kvm_release_pfn_clean()"]
    try_page_mte_tagging [label="try_page_mte_tagging()"]
    mte_copy_tags_from_user [label="mte_copy_tags_from_user()"]
    mte_clear_page_tags [label="mte_clear_page_tags()"]
    set_page_mte_tagged [label="set_page_mte_tagged()"]
    kvm_release_pfn_dirty [label="kvm_release_pfn_dirty()"]
    kvm_vm_ioctl_set_counter_offset [label="int kvm_vm_ioctl_set_counter_offset (struct kvm *kvm, struct kvm_arm_counter_offset *offset)
arch_timer.c:1652"]
    kvm_vm_ioctl_set_counter_offset -> mutex_lock
    kvm_vm_ioctl_set_counter_offset -> lock_all_vcpus
    kvm_vm_ioctl_set_counter_offset -> set_bit
    kvm_vm_ioctl_set_counter_offset -> unlock_all_vcpus
    kvm_vm_ioctl_set_counter_offset -> mutex_unlock
    lock_all_vcpus [label="bool lock_all_vcpus (struct kvm *kvm)
arm.c:1768"]
    lock_all_vcpus -> lockdep_assert_held
    lock_all_vcpus -> kvm_for_each_vcpu
    lock_all_vcpus -> mutex_trylock
    lock_all_vcpus -> unlock_vcpus
    mutex_trylock [label="mutex_trylock()"]
    unlock_vcpus [label="void unlock_vcpus (struct kvm *kvm, int vcpu_lock_idx)
arm.c:1750"]
    unlock_vcpus -> kvm_get_vcpu
    unlock_vcpus -> mutex_unlock
    unlock_all_vcpus [label="void unlock_all_vcpus (struct kvm *kvm)
arm.c:1760"]
    unlock_all_vcpus -> lockdep_assert_held
    unlock_all_vcpus -> unlock_vcpus
    unlock_all_vcpus -> atomic_read
    kvm_vm_has_attr [label="int kvm_vm_has_attr (struct kvm *kvm, struct kvm_device_attr *attr)
arm.c:1658"]
    kvm_vm_has_attr -> kvm_vm_smccc_has_attr
    kvm_vm_smccc_has_attr [label="int kvm_vm_smccc_has_attr (struct kvm *kvm, struct kvm_device_attr *attr)
hypercalls.c:642"]
    kvm_vm_set_attr [label="int kvm_vm_set_attr (struct kvm *kvm, struct kvm_device_attr *attr)
arm.c:1668"]
    kvm_vm_set_attr -> kvm_vm_smccc_set_attr
    kvm_vm_smccc_set_attr [label="int kvm_vm_smccc_set_attr (struct kvm *kvm, struct kvm_device_attr *attr)
hypercalls.c:652"]
    kvm_vm_smccc_set_attr -> kvm_smccc_set_filter
    kvm_smccc_set_filter [label="int kvm_smccc_set_filter (struct kvm *kvm, struct kvm_smccc_filter __user *uaddr)
hypercalls.c:170"]
    kvm_smccc_set_filter -> page_to_virt
    kvm_smccc_set_filter -> ZERO_PAGE
    kvm_smccc_set_filter -> copy_from_user
    kvm_smccc_set_filter -> memcmp
    kvm_smccc_set_filter -> mutex_lock
    kvm_smccc_set_filter -> kvm_vm_has_ran_once
    kvm_smccc_set_filter -> kvm_smccc_filter_configured
    kvm_smccc_set_filter -> kvm_smccc_filter_insert_reserved
    kvm_smccc_set_filter -> WARN_ON_ONCE
    kvm_smccc_set_filter -> mtree_insert_range
    kvm_smccc_set_filter -> xa_mk_value
    kvm_smccc_set_filter -> mutex_unlock
    page_to_virt [label="page_to_virt()"]
    ZERO_PAGE [label="ZERO_PAGE()"]
    memcmp [label="memcmp()"]
    kvm_smccc_filter_insert_reserved [label="int kvm_smccc_filter_insert_reserved (struct kvm *kvm)
hypercalls.c:136"]
    kvm_smccc_filter_insert_reserved -> mtree_insert_range
    kvm_smccc_filter_insert_reserved -> xa_mk_value
    kvm_smccc_filter_insert_reserved -> mtree_destroy
    mtree_insert_range [label="mtree_insert_range()"]
    xa_mk_value [label="xa_mk_value()"]
    kvm_vm_ioctl_get_reg_writable_masks [label="int kvm_vm_ioctl_get_reg_writable_masks (struct kvm *kvm, struct reg_mask_range *range)
sys_regs.c:3750"]
    kvm_vm_ioctl_get_reg_writable_masks -> page_to_virt
    kvm_vm_ioctl_get_reg_writable_masks -> ZERO_PAGE
    kvm_vm_ioctl_get_reg_writable_masks -> memcmp
    kvm_vm_ioctl_get_reg_writable_masks -> clear_user
    kvm_arm_init [label="__init int kvm_arm_init (void)
arm.c:2521"]
    kvm_arm_init -> is_hyp_mode_available
    kvm_arm_init -> kvm_info
    kvm_arm_init -> kvm_get_mode
    kvm_arm_init -> kvm_sys_reg_table_init
    kvm_arm_init -> is_kernel_in_hyp_mode
    kvm_arm_init -> cpus_have_final_cap
    kvm_arm_init -> kvm_set_ipa_limit
    kvm_arm_init -> kvm_arm_init_sve
    kvm_arm_init -> kvm_arm_vmid_alloc_init
    kvm_arm_init -> kvm_err
    kvm_arm_init -> init_hyp_mode
    kvm_arm_init -> kvm_init_vector_slots
    kvm_arm_init -> init_subsystems
    kvm_arm_init -> is_protected_kvm_enabled
    kvm_arm_init -> kvm_init
    kvm_arm_init -> teardown_subsystems
    kvm_arm_init -> teardown_hyp_mode
    kvm_arm_init -> kvm_arm_vmid_alloc_free
    kvm_info [label="kvm_info()"]
    kvm_get_mode [label="enum kvm_mode kvm_get_mode (void)
arm.c:2647"]
    kvm_sys_reg_table_init [label="int __init kvm_sys_reg_table_init (void)
sys_regs.c:3794"]
    kvm_sys_reg_table_init -> check_sysreg_table
    kvm_sys_reg_table_init -> ARRAY_SIZE
    kvm_sys_reg_table_init -> encoding_to_params
    kvm_sys_reg_table_init -> find_reg
    kvm_sys_reg_table_init -> kvm_get_mode
    kvm_sys_reg_table_init -> populate_nv_trap_config
    check_sysreg_table [label="bool check_sysreg_table (const struct sys_reg_desc *table, unsigned int n, bool is_32)
sys_regs.c:2914"]
    check_sysreg_table -> kvm_err
    check_sysreg_table -> cmp_sys_reg
    cmp_sys_reg [label="cmp_sys_reg()"]
    encoding_to_params [label="encoding_to_params()"]
    populate_nv_trap_config [label="int __init populate_nv_trap_config (void)
emulate-nested.c:1701"]
    populate_nv_trap_config -> BUILD_BUG_ON
    populate_nv_trap_config -> BIT
    populate_nv_trap_config -> kvm_info
    populate_nv_trap_config -> ARRAY_SIZE
    populate_nv_trap_config -> cpus_have_final_cap
    populate_nv_trap_config -> xa_destroy
    xa_destroy [label="xa_destroy()"]
    kvm_set_ipa_limit [label="int __init kvm_set_ipa_limit (void)
reset.c:274"]
    kvm_set_ipa_limit -> read_sanitised_ftr_reg
    kvm_set_ipa_limit -> cpuid_feature_extract_unsigned_field
    kvm_set_ipa_limit -> min
    kvm_set_ipa_limit -> kvm_err
    kvm_set_ipa_limit -> kvm_debug
    kvm_set_ipa_limit -> id_aa64mmfr0_parange_to_phys_shift
    kvm_set_ipa_limit -> kvm_info
    id_aa64mmfr0_parange_to_phys_shift [label="id_aa64mmfr0_parange_to_phys_shift()"]
    kvm_arm_init_sve [label="int __init kvm_arm_init_sve (void)
reset.c:50"]
    kvm_arm_init_sve -> system_supports_sve
    kvm_arm_init_sve -> sve_max_virtualisable_vl
    kvm_arm_init_sve -> WARN_ON
    kvm_arm_init_sve -> sve_max_vl
    kvm_arm_init_sve -> pr_warn
    sve_max_vl [label="sve_max_vl()"]
    pr_warn [label="pr_warn()"]
    kvm_arm_vmid_alloc_init [label="int __init kvm_arm_vmid_alloc_init (void)
vmid.c:180"]
    kvm_arm_vmid_alloc_init -> kvm_get_vmid_bits
    kvm_arm_vmid_alloc_init -> WARN_ON
    kvm_arm_vmid_alloc_init -> num_possible_cpus
    kvm_arm_vmid_alloc_init -> atomic64_set
    kvm_arm_vmid_alloc_init -> bitmap_zalloc
    kvm_get_vmid_bits [label="kvm_get_vmid_bits()"]
    num_possible_cpus [label="num_possible_cpus()"]
    bitmap_zalloc [label="bitmap_zalloc()"]
    init_hyp_mode [label="int __init init_hyp_mode (void)
arm.c:2288"]
    init_hyp_mode -> is_protected_kvm_enabled
    init_hyp_mode -> kvm_mmu_init
    init_hyp_mode -> for_each_possible_cpu
    init_hyp_mode -> per_cpu
    init_hyp_mode -> alloc_pages
    init_hyp_mode -> nvhe_percpu_order
    init_hyp_mode -> page_address
    init_hyp_mode -> memcpy
    init_hyp_mode -> CHOOSE_NVHE_SYM
    init_hyp_mode -> nvhe_percpu_size
    init_hyp_mode -> kvm_nvhe_sym
    init_hyp_mode -> create_hyp_mappings
    init_hyp_mode -> kvm_ksym_ref
    init_hyp_mode -> kvm_err
    init_hyp_mode -> per_cpu_ptr_nvhe_sym
    init_hyp_mode -> create_hyp_stack
    init_hyp_mode -> cpu_prepare_hyp_mode
    init_hyp_mode -> kvm_hyp_init_symbols
    init_hyp_mode -> IS_ENABLED
    init_hyp_mode -> cpus_have_final_cap
    init_hyp_mode -> pkvm_hyp_init_ptrauth
    init_hyp_mode -> init_cpu_logical_map
    init_hyp_mode -> init_psci_relay
    init_hyp_mode -> kvm_hyp_init_protection
    init_hyp_mode -> teardown_hyp_mode
    kvm_mmu_init [label="int __init kvm_mmu_init (u32 *hyp_va_bits)
mmu.c:1857"]
    kvm_mmu_init -> ALIGN_DOWN
    kvm_mmu_init -> ALIGN
    kvm_mmu_init -> BUG_ON
    kvm_mmu_init -> max
    kvm_mmu_init -> kvm_debug
    kvm_mmu_init -> kern_hyp_va
    kvm_mmu_init -> kvm_err
    kvm_mmu_init -> kzalloc
    kvm_mmu_init -> kvm_pgtable_hyp_init
    kvm_mmu_init -> kvm_map_idmap_text
    kvm_mmu_init -> kvm_pgtable_hyp_destroy
    kvm_mmu_init -> kfree
    ALIGN [label="ALIGN()"]
    kvm_pgtable_hyp_init [label="kvm_pgtable_hyp_init()"]
    kvm_map_idmap_text [label="int kvm_map_idmap_text (void)
mmu.c:1832"]
    kvm_map_idmap_text -> kvm_err
    kvm_pgtable_hyp_destroy [label="kvm_pgtable_hyp_destroy()"]
    alloc_pages [label="alloc_pages()"]
    nvhe_percpu_order [label="unsigned long nvhe_percpu_order (void)
arm.c:1798"]
    nvhe_percpu_order -> nvhe_percpu_size
    nvhe_percpu_order -> get_order
    nvhe_percpu_size [label="unsigned long nvhe_percpu_size (void)
arm.c:1792"]
    nvhe_percpu_size -> CHOOSE_NVHE_SYM
    CHOOSE_NVHE_SYM [label="CHOOSE_NVHE_SYM()"]
    get_order [label="get_order()"]
    kvm_nvhe_sym [label="kvm_nvhe_sym()"]
    kvm_ksym_ref [label="kvm_ksym_ref()"]
    per_cpu_ptr_nvhe_sym [label="per_cpu_ptr_nvhe_sym()"]
    create_hyp_stack [label="int create_hyp_stack (phys_addr_t phys_addr, unsigned long *haddr)
mmu.c:691"]
    create_hyp_stack -> mutex_lock
    create_hyp_stack -> ALIGN_DOWN
    create_hyp_stack -> mutex_unlock
    create_hyp_stack -> kvm_err
    cpu_prepare_hyp_mode [label="void __init cpu_prepare_hyp_mode (int cpu, u32 hyp_va_bits)
arm.c:1837"]
    cpu_prepare_hyp_mode -> per_cpu_ptr_nvhe_sym
    cpu_prepare_hyp_mode -> kasan_reset_tag
    cpu_prepare_hyp_mode -> kvm_ksym_ref
    cpu_prepare_hyp_mode -> CHOOSE_NVHE_SYM
    cpu_prepare_hyp_mode -> read_sysreg
    cpu_prepare_hyp_mode -> cpus_have_final_cap
    cpu_prepare_hyp_mode -> TCR_T0SZ
    cpu_prepare_hyp_mode -> kvm_mmu_get_httbr
    cpu_prepare_hyp_mode -> is_protected_kvm_enabled
    cpu_prepare_hyp_mode -> kvm_flush_dcache_to_poc
    kasan_reset_tag [label="kasan_reset_tag()"]
    TCR_T0SZ [label="TCR_T0SZ()"]
    kvm_mmu_get_httbr [label="phys_addr_t kvm_mmu_get_httbr (void)
mmu.c:1822"]
    kvm_flush_dcache_to_poc [label="kvm_flush_dcache_to_poc()"]
    kvm_hyp_init_symbols [label="void kvm_hyp_init_symbols (void)
arm.c:2234"]
    kvm_hyp_init_symbols -> kvm_nvhe_sym
    kvm_hyp_init_symbols -> get_hyp_id_aa64pfr0_el1
    kvm_hyp_init_symbols -> read_sanitised_ftr_reg
    get_hyp_id_aa64pfr0_el1 [label="u64 get_hyp_id_aa64pfr0_el1 (void)
arm.c:2210"]
    get_hyp_id_aa64pfr0_el1 -> read_sanitised_ftr_reg
    get_hyp_id_aa64pfr0_el1 -> ARM64_FEATURE_MASK
    get_hyp_id_aa64pfr0_el1 -> FIELD_PREP
    get_hyp_id_aa64pfr0_el1 -> arm64_get_spectre_v2_state
    get_hyp_id_aa64pfr0_el1 -> arm64_get_meltdown_state
    arm64_get_meltdown_state [label="arm64_get_meltdown_state()"]
    IS_ENABLED [label="IS_ENABLED()"]
    pkvm_hyp_init_ptrauth [label="void pkvm_hyp_init_ptrauth (void)
arm.c:2267"]
    pkvm_hyp_init_ptrauth -> for_each_possible_cpu
    pkvm_hyp_init_ptrauth -> per_cpu_ptr_nvhe_sym
    pkvm_hyp_init_ptrauth -> get_random_long
    init_cpu_logical_map [label="void __init init_cpu_logical_map (void)
arm.c:2080"]
    init_cpu_logical_map -> for_each_online_cpu
    init_cpu_logical_map -> cpu_logical_map
    for_each_online_cpu [label="for_each_online_cpu()"]
    cpu_logical_map [label="cpu_logical_map()"]
    init_psci_relay [label="bool __init init_psci_relay (void)
arm.c:2097"]
    init_psci_relay -> kvm_err
    init_psci_relay -> arm_smccc_get_version
    init_psci_relay -> PSCI_VERSION
    init_psci_relay -> get_psci_0_1_function_ids
    init_psci_relay -> init_psci_0_1_impl_state
    arm_smccc_get_version [label="arm_smccc_get_version()"]
    PSCI_VERSION [label="PSCI_VERSION()"]
    get_psci_0_1_function_ids [label="get_psci_0_1_function_ids()"]
    init_psci_0_1_impl_state [label="init_psci_0_1_impl_state()"]
    kvm_hyp_init_protection [label="int __init kvm_hyp_init_protection (u32 hyp_va_bits)
arm.c:2249"]
    kvm_hyp_init_protection -> phys_to_virt
    kvm_hyp_init_protection -> create_hyp_mappings
    kvm_hyp_init_protection -> do_pkvm_init
    kvm_hyp_init_protection -> free_hyp_pgds
    phys_to_virt [label="phys_to_virt()"]
    do_pkvm_init [label="int __init do_pkvm_init (u32 hyp_va_bits)
arm.c:2188"]
    do_pkvm_init -> kvm_ksym_ref
    do_pkvm_init -> kvm_nvhe_sym
    do_pkvm_init -> preempt_disable
    do_pkvm_init -> cpu_hyp_init_context
    do_pkvm_init -> kvm_call_hyp_nvhe
    do_pkvm_init -> num_possible_cpus
    do_pkvm_init -> kern_hyp_va
    do_pkvm_init -> cpu_hyp_init_features
    do_pkvm_init -> preempt_enable
    free_hyp_pgds [label="void __init free_hyp_pgds (void)
mmu.c:372"]
    free_hyp_pgds -> mutex_lock
    free_hyp_pgds -> kvm_pgtable_hyp_destroy
    free_hyp_pgds -> kfree
    free_hyp_pgds -> mutex_unlock
    teardown_hyp_mode [label="void __init teardown_hyp_mode (void)
arm.c:2177"]
    teardown_hyp_mode -> free_hyp_pgds
    teardown_hyp_mode -> for_each_possible_cpu
    teardown_hyp_mode -> free_page
    teardown_hyp_mode -> per_cpu
    teardown_hyp_mode -> free_pages
    teardown_hyp_mode -> kvm_nvhe_sym
    teardown_hyp_mode -> nvhe_percpu_order
    free_page [label="free_page()"]
    free_pages [label="free_pages()"]
    kvm_init_vector_slots [label="int kvm_init_vector_slots (void)
arm.c:1813"]
    kvm_init_vector_slots -> kern_hyp_va
    kvm_init_vector_slots -> kvm_ksym_ref
    kvm_init_vector_slots -> kvm_init_vector_slot
    kvm_init_vector_slots -> kvm_system_needs_idmapped_vectors
    kvm_init_vector_slots -> is_protected_kvm_enabled
    kvm_init_vector_slots -> create_hyp_exec_mappings
    kvm_init_vector_slot [label="void kvm_init_vector_slot (void *base, enum arm64_hyp_spectre_vector slot)
arm.c:1808"]
    kvm_system_needs_idmapped_vectors [label="kvm_system_needs_idmapped_vectors()"]
    create_hyp_exec_mappings [label="int create_hyp_exec_mappings (phys_addr_t phys_addr, size_t size, void **haddr)
mmu.c:778"]
    create_hyp_exec_mappings -> BUG_ON
    create_hyp_exec_mappings -> is_kernel_in_hyp_mode
    init_subsystems [label="int __init init_subsystems (void)
arm.c:2121"]
    init_subsystems -> on_each_cpu
    init_subsystems -> cpu_hyp_init
    init_subsystems -> hyp_cpu_pm_init
    init_subsystems -> kvm_vgic_hyp_init
    init_subsystems -> kvm_timer_hyp_init
    init_subsystems -> kvm_register_perf_callbacks
    init_subsystems -> hyp_cpu_pm_exit
    init_subsystems -> is_protected_kvm_enabled
    init_subsystems -> cpu_hyp_uninit
    hyp_cpu_pm_init [label="inline void __init hyp_cpu_pm_init (void)
arm.c:2072"]
    hyp_cpu_pm_init -> is_protected_kvm_enabled
    hyp_cpu_pm_init -> cpu_pm_register_notifier
    cpu_pm_register_notifier [label="cpu_pm_register_notifier()"]
    kvm_vgic_hyp_init [label="kvm_vgic_hyp_init()"]
    kvm_timer_hyp_init [label="int __init kvm_timer_hyp_init (bool has_gic)
arch_timer.c:1368"]
    kvm_timer_hyp_init -> arch_timer_get_kvm_info
    kvm_timer_hyp_init -> kvm_err
    kvm_timer_hyp_init -> kvm_irq_init
    kvm_timer_hyp_init -> request_percpu_irq
    kvm_timer_hyp_init -> kvm_arch_timer_handler
    kvm_timer_hyp_init -> kvm_get_running_vcpus
    kvm_timer_hyp_init -> irq_set_vcpu_affinity
    kvm_timer_hyp_init -> static_branch_enable
    kvm_timer_hyp_init -> kvm_debug
    kvm_timer_hyp_init -> has_vhe
    kvm_timer_hyp_init -> free_percpu_irq
    arch_timer_get_kvm_info [label="arch_timer_get_kvm_info()"]
    kvm_irq_init [label="int kvm_irq_init (struct arch_timer_kvm_info *info)
arch_timer.c:1320"]
    kvm_irq_init -> kvm_err
    kvm_irq_init -> kvm_irq_fixup_flags
    kvm_irq_init -> irq_domain_alloc_named_fwnode
    kvm_irq_init -> irq_get_irq_data
    kvm_irq_init -> irq_domain_create_hierarchy
    kvm_irq_init -> irq_domain_free_fwnode
    kvm_irq_init -> WARN_ON
    kvm_irq_init -> irq_domain_push_irq
    kvm_irq_fixup_flags [label="void kvm_irq_fixup_flags (unsigned int virq, u32 *flags)
arch_timer.c:1310"]
    kvm_irq_fixup_flags -> irq_get_trigger_type
    kvm_irq_fixup_flags -> kvm_err
    irq_get_trigger_type [label="irq_get_trigger_type()"]
    irq_domain_alloc_named_fwnode [label="irq_domain_alloc_named_fwnode()"]
    irq_get_irq_data [label="irq_get_irq_data()"]
    irq_domain_create_hierarchy [label="irq_domain_create_hierarchy()"]
    irq_domain_free_fwnode [label="irq_domain_free_fwnode()"]
    irq_domain_push_irq [label="irq_domain_push_irq()"]
    request_percpu_irq [label="request_percpu_irq()"]
    kvm_arch_timer_handler [label="irqreturn_t kvm_arch_timer_handler (int irq, void *dev_id)
arch_timer.c:224"]
    kvm_arch_timer_handler -> get_timer_map
    kvm_arch_timer_handler -> kvm_timer_should_fire
    kvm_arch_timer_handler -> kvm_timer_update_irq
    kvm_arch_timer_handler -> userspace_irqchip
    kvm_arch_timer_handler -> static_branch_unlikely
    kvm_arch_timer_handler -> disable_percpu_irq
    kvm_get_running_vcpus [label="kvm_get_running_vcpus()"]
    irq_set_vcpu_affinity [label="irq_set_vcpu_affinity()"]
    free_percpu_irq [label="free_percpu_irq()"]
    kvm_register_perf_callbacks [label="kvm_register_perf_callbacks()"]
    hyp_cpu_pm_exit [label="inline void __init hyp_cpu_pm_exit (void)
arm.c:2075"]
    hyp_cpu_pm_exit -> is_protected_kvm_enabled
    hyp_cpu_pm_exit -> cpu_pm_unregister_notifier
    cpu_pm_unregister_notifier [label="cpu_pm_unregister_notifier()"]
    kvm_init [label="kvm_init()"]
    teardown_subsystems [label="void __init teardown_subsystems (void)
arm.c:2171"]
    teardown_subsystems -> kvm_unregister_perf_callbacks
    teardown_subsystems -> hyp_cpu_pm_exit
    kvm_unregister_perf_callbacks [label="kvm_unregister_perf_callbacks()"]
    kvm_arm_vmid_alloc_free [label="void __init kvm_arm_vmid_alloc_free (void)
vmid.c:197"]
    kvm_arm_vmid_alloc_free -> bitmap_free
    kvm_clr_pmu_events [label="void kvm_clr_pmu_events (u32 clr)
pmu.c:54"]
    kvm_clr_pmu_events -> kvm_get_pmu_events
    kvm_clr_pmu_events -> kvm_arm_support_pmu_v3
    kvm_compute_final_ctr_el0 [label="void kvm_compute_final_ctr_el0 (struct alt_instr *alt, __le32 *origptr, __le32 *updptr, int nr_inst)
va_layout.c:293"]
    kvm_compute_final_ctr_el0 -> generate_mov_q
    kvm_compute_final_ctr_el0 -> read_sanitised_ftr_reg
    generate_mov_q [label="void generate_mov_q (u64 val, __le32 *origptr, __le32 *updptr, int nr_inst)
va_layout.c:244"]
    generate_mov_q -> BUG_ON
    generate_mov_q -> le32_to_cpu
    generate_mov_q -> aarch64_insn_decode_register
    generate_mov_q -> aarch64_insn_gen_movewide
    generate_mov_q -> cpu_to_le32
    aarch64_insn_decode_register [label="aarch64_insn_decode_register()"]
    aarch64_insn_gen_movewide [label="aarch64_insn_gen_movewide()"]
    cpu_to_le32 [label="cpu_to_le32()"]
    kvm_compute_layout [label="__init void kvm_compute_layout (void)
va_layout.c:60"]
    kvm_compute_layout -> BIT
    kvm_compute_layout -> fls64
    kvm_compute_layout -> phys_to_virt
    kvm_compute_layout -> memblock_start_of_DRAM
    kvm_compute_layout -> GENMASK_ULL
    kvm_compute_layout -> IS_ENABLED
    kvm_compute_layout -> get_random_long
    kvm_compute_layout -> init_hyp_physvirt_offset
    fls64 [label="fls64()"]
    memblock_start_of_DRAM [label="memblock_start_of_DRAM()"]
    init_hyp_physvirt_offset [label="void init_hyp_physvirt_offset (void)
va_layout.c:39"]
    init_hyp_physvirt_offset -> lm_alias
    kvm_cpu_has_pending_timer [label="int kvm_cpu_has_pending_timer (struct kvm_vcpu *vcpu)
arch_timer.c:423"]
    kvm_cpu_has_pending_timer -> vcpu_has_wfit_active
    kvm_cpu_has_pending_timer -> wfit_delay_ns
    kvm_get_kimage_voffset [label="void kvm_get_kimage_voffset (struct alt_instr *alt, __le32 *origptr, __le32 *updptr, int nr_inst)
va_layout.c:287"]
    kvm_get_kimage_voffset -> generate_mov_q
    kvm_handle_cp10_id [label="int kvm_handle_cp10_id (struct kvm_vcpu *vcpu)
sys_regs.c:3125"]
    kvm_handle_cp10_id -> kvm_vcpu_sys_get_rt
    kvm_handle_cp10_id -> kvm_vcpu_get_esr
    kvm_handle_cp10_id -> kvm_esr_cp10_id_to_sys64
    kvm_handle_cp10_id -> kvm_inject_undefined
    kvm_handle_cp10_id -> emulate_sys_reg
    kvm_handle_cp10_id -> vcpu_set_reg
    kvm_esr_cp10_id_to_sys64 [label="bool kvm_esr_cp10_id_to_sys64 (u64 esr, struct sys_reg_params *params)
sys_regs.c:3077"]
    kvm_esr_cp10_id_to_sys64 -> kvm_pr_unimpl
    emulate_sys_reg [label="bool emulate_sys_reg (struct kvm_vcpu *vcpu, struct sys_reg_params *params)
sys_regs.c:3261"]
    emulate_sys_reg -> find_reg
    emulate_sys_reg -> ARRAY_SIZE
    emulate_sys_reg -> likely
    emulate_sys_reg -> perform_access
    emulate_sys_reg -> is_imp_def_sys_reg
    emulate_sys_reg -> kvm_inject_undefined
    emulate_sys_reg -> print_sys_reg_msg
    emulate_sys_reg -> vcpu_pc
    emulate_sys_reg -> vcpu_cpsr
    perform_access [label="void perform_access (struct kvm_vcpu *vcpu, struct sys_reg_params *params, const struct sys_reg_desc *r)
sys_regs.c:2940"]
    perform_access -> trace_kvm_sys_access
    perform_access -> vcpu_pc
    perform_access -> sysreg_hidden
    perform_access -> kvm_inject_undefined
    perform_access -> BUG_ON
    perform_access -> likely
    perform_access -> kvm_incr_pc
    trace_kvm_sys_access [label="trace_kvm_sys_access()"]
    is_imp_def_sys_reg [label="bool is_imp_def_sys_reg (struct sys_reg_params *params)
sys_regs.c:3248"]
    kvm_handle_cp14_32 [label="int kvm_handle_cp14_32 (struct kvm_vcpu *vcpu)
sys_regs.c:3239"]
    kvm_handle_cp14_32 -> esr_cp1x_32_to_params
    kvm_handle_cp14_32 -> kvm_vcpu_get_esr
    kvm_handle_cp14_32 -> kvm_handle_cp_32
    kvm_handle_cp14_32 -> ARRAY_SIZE
    esr_cp1x_32_to_params [label="esr_cp1x_32_to_params()"]
    kvm_handle_cp_32 [label="int kvm_handle_cp_32 (struct kvm_vcpu *vcpu, struct sys_reg_params *params, const struct sys_reg_desc *global, size_t nr_global)
sys_regs.c:3192"]
    kvm_handle_cp_32 -> kvm_vcpu_sys_get_rt
    kvm_handle_cp_32 -> vcpu_get_reg
    kvm_handle_cp_32 -> emulate_cp
    kvm_handle_cp_32 -> vcpu_set_reg
    kvm_handle_cp_32 -> unhandled_cp_access
    emulate_cp [label="bool emulate_cp (struct kvm_vcpu *vcpu, struct sys_reg_params *params, const struct sys_reg_desc *table, size_t num)
sys_regs.c:2974"]
    emulate_cp -> find_reg
    emulate_cp -> perform_access
    unhandled_cp_access [label="void unhandled_cp_access (struct kvm_vcpu *vcpu, struct sys_reg_params *params)
sys_regs.c:2995"]
    unhandled_cp_access -> kvm_vcpu_trap_get_class
    unhandled_cp_access -> WARN_ON
    unhandled_cp_access -> print_sys_reg_msg
    unhandled_cp_access -> vcpu_pc
    unhandled_cp_access -> vcpu_cpsr
    unhandled_cp_access -> kvm_inject_undefined
    kvm_handle_cp14_64 [label="int kvm_handle_cp14_64 (struct kvm_vcpu *vcpu)
sys_regs.c:3234"]
    kvm_handle_cp14_64 -> kvm_handle_cp_64
    kvm_handle_cp14_64 -> ARRAY_SIZE
    kvm_handle_cp_64 [label="int kvm_handle_cp_64 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *global, size_t nr_global)
sys_regs.c:3025"]
    kvm_handle_cp_64 -> kvm_vcpu_get_esr
    kvm_handle_cp_64 -> kvm_vcpu_sys_get_rt
    kvm_handle_cp_64 -> vcpu_get_reg
    kvm_handle_cp_64 -> emulate_cp
    kvm_handle_cp_64 -> vcpu_set_reg
    kvm_handle_cp_64 -> lower_32_bits
    kvm_handle_cp_64 -> upper_32_bits
    kvm_handle_cp_64 -> unhandled_cp_access
    kvm_handle_cp14_load_store [label="int kvm_handle_cp14_load_store (struct kvm_vcpu *vcpu)
sys_regs.c:2934"]
    kvm_handle_cp14_load_store -> kvm_inject_undefined
    kvm_handle_cp15_32 [label="int kvm_handle_cp15_32 (struct kvm_vcpu *vcpu)
sys_regs.c:3216"]
    kvm_handle_cp15_32 -> esr_cp1x_32_to_params
    kvm_handle_cp15_32 -> kvm_vcpu_get_esr
    kvm_handle_cp15_32 -> kvm_emulate_cp15_id_reg
    kvm_handle_cp15_32 -> kvm_handle_cp_32
    kvm_handle_cp15_32 -> ARRAY_SIZE
    kvm_emulate_cp15_id_reg [label="int kvm_emulate_cp15_id_reg (struct kvm_vcpu *vcpu, struct sys_reg_params *params)
sys_regs.c:3160"]
    kvm_emulate_cp15_id_reg -> kvm_vcpu_sys_get_rt
    kvm_emulate_cp15_id_reg -> unhandled_cp_access
    kvm_emulate_cp15_id_reg -> emulate_sys_reg
    kvm_emulate_cp15_id_reg -> vcpu_set_reg
    kvm_handle_cp15_64 [label="int kvm_handle_cp15_64 (struct kvm_vcpu *vcpu)
sys_regs.c:3211"]
    kvm_handle_cp15_64 -> kvm_handle_cp_64
    kvm_handle_cp15_64 -> ARRAY_SIZE
    kvm_handle_eret [label="int kvm_handle_eret (struct kvm_vcpu *vcpu)
handle_exit.c:220"]
    kvm_handle_eret -> kvm_vcpu_get_esr
    kvm_handle_eret -> kvm_handle_ptrauth
    kvm_handle_eret -> is_hyp_ctxt
    kvm_handle_eret -> kvm_emulate_nested_eret
    kvm_handle_eret -> kvm_inject_nested_sync
    kvm_handle_ptrauth [label="int kvm_handle_ptrauth (struct kvm_vcpu *vcpu)
handle_exit.c:214"]
    kvm_handle_ptrauth -> kvm_inject_undefined
    kvm_emulate_nested_eret [label="void kvm_emulate_nested_eret (struct kvm_vcpu *vcpu)
emulate-nested.c:1969"]
    kvm_emulate_nested_eret -> vcpu_read_sys_reg
    kvm_emulate_nested_eret -> kvm_check_illegal_exception_return
    kvm_emulate_nested_eret -> vcpu_el2_e2h_is_set
    kvm_emulate_nested_eret -> vcpu_el2_tge_is_set
    kvm_emulate_nested_eret -> vcpu_pc
    kvm_emulate_nested_eret -> vcpu_cpsr
    kvm_emulate_nested_eret -> trace_kvm_nested_eret
    kvm_emulate_nested_eret -> preempt_disable
    kvm_emulate_nested_eret -> kvm_arch_vcpu_put
    kvm_emulate_nested_eret -> kvm_arch_vcpu_load
    kvm_emulate_nested_eret -> smp_processor_id
    kvm_emulate_nested_eret -> preempt_enable
    kvm_check_illegal_exception_return [label="u64 kvm_check_illegal_exception_return (struct kvm_vcpu *vcpu, u64 spsr)
emulate-nested.c:1936"]
    kvm_check_illegal_exception_return -> BIT
    kvm_check_illegal_exception_return -> vcpu_el2_tge_is_set
    kvm_check_illegal_exception_return -> vcpu_cpsr
    trace_kvm_nested_eret [label="trace_kvm_nested_eret()"]
    kvm_handle_guest_abort [label="int kvm_handle_guest_abort (struct kvm_vcpu *vcpu)
mmu.c:1619"]
    kvm_handle_guest_abort -> kvm_vcpu_trap_get_fault_type
    kvm_handle_guest_abort -> kvm_vcpu_get_fault_ipa
    kvm_handle_guest_abort -> kvm_vcpu_trap_is_iabt
    kvm_handle_guest_abort -> BIT_ULL
    kvm_handle_guest_abort -> get_kvm_ipa_limit
    kvm_handle_guest_abort -> kvm_inject_size_fault
    kvm_handle_guest_abort -> kvm_vcpu_get_hfar
    kvm_handle_guest_abort -> GENMASK
    kvm_handle_guest_abort -> kvm_inject_pabt
    kvm_handle_guest_abort -> kvm_inject_dabt
    kvm_handle_guest_abort -> kvm_vcpu_abt_issea
    kvm_handle_guest_abort -> kvm_handle_guest_sea
    kvm_handle_guest_abort -> kvm_vcpu_get_esr
    kvm_handle_guest_abort -> kvm_inject_vabt
    kvm_handle_guest_abort -> trace_kvm_guest_fault
    kvm_handle_guest_abort -> vcpu_pc
    kvm_handle_guest_abort -> kvm_err
    kvm_handle_guest_abort -> kvm_vcpu_trap_get_class
    kvm_handle_guest_abort -> kvm_vcpu_trap_get_fault
    kvm_handle_guest_abort -> srcu_read_lock
    kvm_handle_guest_abort -> gfn_to_memslot
    kvm_handle_guest_abort -> gfn_to_hva_memslot_prot
    kvm_handle_guest_abort -> kvm_is_write_fault
    kvm_handle_guest_abort -> kvm_is_error_hva
    kvm_handle_guest_abort -> kvm_vcpu_abt_iss1tw
    kvm_handle_guest_abort -> kvm_vcpu_dabt_is_cm
    kvm_handle_guest_abort -> kvm_incr_pc
    kvm_handle_guest_abort -> io_mem_abort
    kvm_handle_guest_abort -> VM_BUG_ON
    kvm_handle_guest_abort -> kvm_phys_size
    kvm_handle_guest_abort -> handle_access_fault
    kvm_handle_guest_abort -> user_mem_abort
    kvm_handle_guest_abort -> srcu_read_unlock
    kvm_vcpu_trap_get_fault_type [label="kvm_vcpu_trap_get_fault_type()"]
    kvm_vcpu_get_fault_ipa [label="kvm_vcpu_get_fault_ipa()"]
    kvm_vcpu_trap_is_iabt [label="kvm_vcpu_trap_is_iabt()"]
    kvm_inject_size_fault [label="void kvm_inject_size_fault (struct kvm_vcpu *vcpu)
inject_fault.c:190"]
    kvm_inject_size_fault -> kvm_vcpu_get_fault_ipa
    kvm_inject_size_fault -> kvm_vcpu_get_hfar
    kvm_inject_size_fault -> GENMASK
    kvm_inject_size_fault -> kvm_vcpu_trap_is_iabt
    kvm_inject_size_fault -> kvm_inject_pabt
    kvm_inject_size_fault -> kvm_inject_dabt
    kvm_inject_size_fault -> vcpu_el1_is_32bit
    kvm_inject_size_fault -> vcpu_read_sys_reg
    kvm_inject_size_fault -> GENMASK_ULL
    kvm_inject_size_fault -> vcpu_write_sys_reg
    kvm_vcpu_get_hfar [label="kvm_vcpu_get_hfar()"]
    kvm_inject_pabt [label="void kvm_inject_pabt (struct kvm_vcpu *vcpu, unsigned long addr)
inject_fault.c:182"]
    kvm_inject_pabt -> vcpu_el1_is_32bit
    kvm_inject_pabt -> inject_abt32
    kvm_inject_pabt -> inject_abt64
    inject_abt32 [label="void inject_abt32 (struct kvm_vcpu *vcpu, bool is_pabt, u32 addr)
inject_fault.c:128"]
    inject_abt32 -> vcpu_read_sys_reg
    inject_abt32 -> kvm_pend_exception
    inject_abt32 -> GENMASK
    inject_abt32 -> vcpu_write_sys_reg
    inject_abt64 [label="void inject_abt64 (struct kvm_vcpu *vcpu, bool is_iabt, unsigned long addr)
inject_fault.c:57"]
    inject_abt64 -> vcpu_cpsr
    inject_abt64 -> vcpu_mode_is_32bit
    inject_abt64 -> pend_sync_exception
    inject_abt64 -> kvm_vcpu_trap_il_is32bit
    inject_abt64 -> match_target_el
    inject_abt64 -> unpack_vcpu_flag
    inject_abt64 -> vcpu_write_sys_reg
    kvm_inject_dabt [label="void kvm_inject_dabt (struct kvm_vcpu *vcpu, unsigned long addr)
inject_fault.c:166"]
    kvm_inject_dabt -> vcpu_el1_is_32bit
    kvm_inject_dabt -> inject_abt32
    kvm_inject_dabt -> inject_abt64
    kvm_vcpu_abt_issea [label="kvm_vcpu_abt_issea()"]
    kvm_handle_guest_sea [label="kvm_handle_guest_sea()"]
    trace_kvm_guest_fault [label="trace_kvm_guest_fault()"]
    kvm_vcpu_trap_get_fault [label="kvm_vcpu_trap_get_fault()"]
    gfn_to_memslot [label="gfn_to_memslot()"]
    gfn_to_hva_memslot_prot [label="gfn_to_hva_memslot_prot()"]
    kvm_is_write_fault [label="kvm_is_write_fault()"]
    kvm_vcpu_abt_iss1tw [label="kvm_vcpu_abt_iss1tw()"]
    kvm_vcpu_dabt_is_cm [label="kvm_vcpu_dabt_is_cm()"]
    io_mem_abort [label="int io_mem_abort (struct kvm_vcpu *vcpu, phys_addr_t fault_ipa)
mmio.c:123"]
    io_mem_abort -> kvm_vcpu_dabt_isvalid
    io_mem_abort -> trace_kvm_mmio_nisv
    io_mem_abort -> vcpu_pc
    io_mem_abort -> kvm_vcpu_get_esr
    io_mem_abort -> kvm_vcpu_get_hfar
    io_mem_abort -> test_bit
    io_mem_abort -> kvm_vcpu_dabt_iss_nisv_sanitized
    io_mem_abort -> kvm_vcpu_dabt_iswrite
    io_mem_abort -> kvm_vcpu_dabt_get_as
    io_mem_abort -> kvm_vcpu_dabt_get_rd
    io_mem_abort -> vcpu_data_guest_to_host
    io_mem_abort -> vcpu_get_reg
    io_mem_abort -> trace_kvm_mmio
    io_mem_abort -> kvm_mmio_write_buf
    io_mem_abort -> kvm_io_bus_write
    io_mem_abort -> kvm_io_bus_read
    io_mem_abort -> memcpy
    io_mem_abort -> kvm_handle_mmio_return
    kvm_vcpu_dabt_isvalid [label="kvm_vcpu_dabt_isvalid()"]
    trace_kvm_mmio_nisv [label="trace_kvm_mmio_nisv()"]
    kvm_vcpu_dabt_iss_nisv_sanitized [label="kvm_vcpu_dabt_iss_nisv_sanitized()"]
    vcpu_data_guest_to_host [label="vcpu_data_guest_to_host()"]
    kvm_mmio_write_buf [label="void kvm_mmio_write_buf (void *buf, unsigned int len, unsigned long data)
mmio.c:13"]
    kvm_mmio_write_buf -> memcpy
    kvm_io_bus_write [label="kvm_io_bus_write()"]
    kvm_io_bus_read [label="kvm_io_bus_read()"]
    VM_BUG_ON [label="VM_BUG_ON()"]
    handle_access_fault [label="void handle_access_fault (struct kvm_vcpu *vcpu, phys_addr_t fault_ipa)
mmu.c:1592"]
    handle_access_fault -> trace_kvm_access_fault
    handle_access_fault -> read_lock
    handle_access_fault -> kvm_pgtable_stage2_mkyoung
    handle_access_fault -> read_unlock
    handle_access_fault -> kvm_pte_valid
    handle_access_fault -> kvm_set_pfn_accessed
    handle_access_fault -> kvm_pte_to_pfn
    trace_kvm_access_fault [label="trace_kvm_access_fault()"]
    read_lock [label="read_lock()"]
    kvm_pgtable_stage2_mkyoung [label="kvm_pgtable_stage2_mkyoung()"]
    read_unlock [label="read_unlock()"]
    kvm_pte_valid [label="kvm_pte_valid()"]
    kvm_set_pfn_accessed [label="kvm_set_pfn_accessed()"]
    kvm_pte_to_pfn [label="kvm_pte_to_pfn()"]
    user_mem_abort [label="int user_mem_abort (struct kvm_vcpu *vcpu, phys_addr_t fault_ipa, struct kvm_memory_slot *memslot, unsigned long hva, unsigned long fault_status)
mmu.c:1375"]
    user_mem_abort -> memslot_is_logging
    user_mem_abort -> kvm_vcpu_trap_get_fault_level
    user_mem_abort -> ARM64_HW_PGTABLE_LEVEL_SHIFT
    user_mem_abort -> kvm_is_write_fault
    user_mem_abort -> kvm_vcpu_trap_is_exec_fault
    user_mem_abort -> VM_BUG_ON
    user_mem_abort -> kvm_err
    user_mem_abort -> kvm_mmu_topup_memory_cache
    user_mem_abort -> kvm_mmu_cache_min_pages
    user_mem_abort -> mmap_read_lock
    user_mem_abort -> vma_lookup
    user_mem_abort -> unlikely
    user_mem_abort -> mmap_read_unlock
    user_mem_abort -> get_vma_page_shift
    user_mem_abort -> fault_supports_stage2_huge_mapping
    user_mem_abort -> WARN_ONCE
    user_mem_abort -> kvm_vma_mte_allowed
    user_mem_abort -> kvm_send_hwpoison_signal
    user_mem_abort -> is_error_noslot_pfn
    user_mem_abort -> kvm_is_device_pfn
    user_mem_abort -> read_lock
    user_mem_abort -> mmu_invalidate_retry
    user_mem_abort -> transparent_hugepage_adjust
    user_mem_abort -> kvm_has_mte
    user_mem_abort -> sanitise_mte_tags
    user_mem_abort -> cpus_have_final_cap
    user_mem_abort -> kvm_pgtable_stage2_relax_perms
    user_mem_abort -> kvm_pgtable_stage2_map
    user_mem_abort -> kvm_set_pfn_dirty
    user_mem_abort -> mark_page_dirty_in_slot
    user_mem_abort -> read_unlock
    user_mem_abort -> kvm_release_pfn_clean
    memslot_is_logging [label="bool memslot_is_logging (struct kvm_memory_slot *memslot)
mmu.c:158"]
    kvm_vcpu_trap_get_fault_level [label="kvm_vcpu_trap_get_fault_level()"]
    ARM64_HW_PGTABLE_LEVEL_SHIFT [label="ARM64_HW_PGTABLE_LEVEL_SHIFT()"]
    kvm_vcpu_trap_is_exec_fault [label="kvm_vcpu_trap_is_exec_fault()"]
    kvm_mmu_topup_memory_cache [label="kvm_mmu_topup_memory_cache()"]
    kvm_mmu_cache_min_pages [label="kvm_mmu_cache_min_pages()"]
    vma_lookup [label="vma_lookup()"]
    get_vma_page_shift [label="int get_vma_page_shift (struct vm_area_struct *vma, unsigned long hva)
mmu.c:1313"]
    get_vma_page_shift -> is_vm_hugetlb_page
    get_vma_page_shift -> huge_page_shift
    get_vma_page_shift -> hstate_vma
    get_vma_page_shift -> VM_BUG_ON
    get_vma_page_shift -> ALIGN_DOWN
    get_vma_page_shift -> ALIGN
    is_vm_hugetlb_page [label="is_vm_hugetlb_page()"]
    huge_page_shift [label="huge_page_shift()"]
    hstate_vma [label="hstate_vma()"]
    fault_supports_stage2_huge_mapping [label="bool fault_supports_stage2_huge_mapping (struct kvm_memory_slot *memslot, unsigned long hva, unsigned long map_size)
mmu.c:1212"]
    kvm_send_hwpoison_signal [label="void kvm_send_hwpoison_signal (unsigned long address, short lsb)
mmu.c:1207"]
    kvm_send_hwpoison_signal -> send_sig_mceerr
    send_sig_mceerr [label="send_sig_mceerr()"]
    kvm_is_device_pfn [label="bool kvm_is_device_pfn (unsigned long pfn)
mmu.c:183"]
    kvm_is_device_pfn -> pfn_is_map_memory
    pfn_is_map_memory [label="pfn_is_map_memory()"]
    mmu_invalidate_retry [label="mmu_invalidate_retry()"]
    transparent_hugepage_adjust [label="long transparent_hugepage_adjust (struct kvm *kvm, struct kvm_memory_slot *memslot, unsigned long hva, kvm_pfn_t *pfnp, phys_addr_t *ipap)
mmu.c:1282"]
    transparent_hugepage_adjust -> fault_supports_stage2_huge_mapping
    transparent_hugepage_adjust -> get_user_mapping_size
    get_user_mapping_size [label="int get_user_mapping_size (struct kvm *kvm, u64 addr)
mmu.c:802"]
    get_user_mapping_size -> local_irq_save
    get_user_mapping_size -> kvm_pgtable_get_leaf
    get_user_mapping_size -> local_irq_restore
    get_user_mapping_size -> WARN_ON
    get_user_mapping_size -> kvm_pte_valid
    get_user_mapping_size -> BIT
    get_user_mapping_size -> ARM64_HW_PGTABLE_LEVEL_SHIFT
    kvm_pgtable_get_leaf [label="kvm_pgtable_get_leaf()"]
    sanitise_mte_tags [label="void sanitise_mte_tags (struct kvm *kvm, kvm_pfn_t pfn, unsigned long size)
mmu.c:1353"]
    sanitise_mte_tags -> pfn_to_page
    sanitise_mte_tags -> kvm_has_mte
    sanitise_mte_tags -> try_page_mte_tagging
    sanitise_mte_tags -> mte_clear_page_tags
    sanitise_mte_tags -> page_address
    sanitise_mte_tags -> set_page_mte_tagged
    pfn_to_page [label="pfn_to_page()"]
    kvm_pgtable_stage2_relax_perms [label="kvm_pgtable_stage2_relax_perms()"]
    kvm_pgtable_stage2_map [label="kvm_pgtable_stage2_map()"]
    kvm_set_pfn_dirty [label="kvm_set_pfn_dirty()"]
    mark_page_dirty_in_slot [label="mark_page_dirty_in_slot()"]
    kvm_handle_guest_debug [label="int kvm_handle_guest_debug (struct kvm_vcpu *vcpu)
handle_exit.c:166"]
    kvm_handle_guest_debug -> kvm_vcpu_get_esr
    kvm_handle_guest_debug -> lower_32_bits
    kvm_handle_guest_debug -> upper_32_bits
    kvm_handle_guest_debug -> ESR_ELx_EC
    kvm_handle_guest_debug -> vcpu_clear_flag
    kvm_handle_sys_reg [label="int kvm_handle_sys_reg (struct kvm_vcpu *vcpu)
sys_regs.c:3334"]
    kvm_handle_sys_reg -> kvm_vcpu_get_esr
    kvm_handle_sys_reg -> kvm_vcpu_sys_get_rt
    kvm_handle_sys_reg -> trace_kvm_handle_sys_reg
    kvm_handle_sys_reg -> esr_sys64_to_params
    kvm_handle_sys_reg -> vcpu_get_reg
    kvm_handle_sys_reg -> emulate_sys_reg
    kvm_handle_sys_reg -> vcpu_set_reg
    trace_kvm_handle_sys_reg [label="trace_kvm_handle_sys_reg()"]
    esr_sys64_to_params [label="esr_sys64_to_params()"]
    kvm_handle_unknown_ec [label="int kvm_handle_unknown_ec (struct kvm_vcpu *vcpu)
handle_exit.c:188"]
    kvm_handle_unknown_ec -> kvm_vcpu_get_esr
    kvm_handle_unknown_ec -> kvm_pr_unimpl
    kvm_handle_unknown_ec -> esr_get_class_string
    kvm_handle_unknown_ec -> kvm_inject_undefined
    esr_get_class_string [label="esr_get_class_string()"]
    kvm_handle_wfx [label="int kvm_handle_wfx (struct kvm_vcpu *vcpu)
handle_exit.c:114"]
    kvm_handle_wfx -> kvm_vcpu_get_esr
    kvm_handle_wfx -> trace_kvm_wfx_arm64
    kvm_handle_wfx -> vcpu_pc
    kvm_handle_wfx -> kvm_arm_timer_get_reg
    kvm_handle_wfx -> vcpu_get_reg
    kvm_handle_wfx -> kvm_vcpu_sys_get_rt
    kvm_handle_wfx -> kvm_vcpu_on_spin
    kvm_handle_wfx -> vcpu_mode_priv
    kvm_handle_wfx -> vcpu_set_flag
    kvm_handle_wfx -> kvm_vcpu_wfi
    kvm_handle_wfx -> kvm_incr_pc
    trace_kvm_wfx_arm64 [label="trace_kvm_wfx_arm64()"]
    kvm_vcpu_on_spin [label="kvm_vcpu_on_spin()"]
    kvm_host_get_page [label="void kvm_host_get_page (void *addr)
mmu.c:239"]
    kvm_host_get_page -> get_page
    kvm_host_get_page -> virt_to_page
    get_page [label="get_page()"]
    virt_to_page [label="virt_to_page()"]
    kvm_host_page_count [label="int kvm_host_page_count (void *addr)
mmu.c:258"]
    kvm_host_page_count -> page_count
    kvm_host_page_count -> virt_to_page
    page_count [label="page_count()"]
    kvm_host_pmu_init [label="void kvm_host_pmu_init (struct arm_pmu *pmu)
pmu-emul.c:694"]
    kvm_host_pmu_init -> pmuv3_implemented
    kvm_host_pmu_init -> kvm_arm_pmu_get_pmuver_limit
    kvm_host_pmu_init -> mutex_lock
    kvm_host_pmu_init -> kmalloc
    kvm_host_pmu_init -> list_add_tail
    kvm_host_pmu_init -> list_is_singular
    kvm_host_pmu_init -> static_branch_enable
    kvm_host_pmu_init -> mutex_unlock
    pmuv3_implemented [label="pmuv3_implemented()"]
    kmalloc [label="kmalloc()"]
    list_add_tail [label="list_add_tail()"]
    list_is_singular [label="list_is_singular()"]
    kvm_host_put_page [label="void kvm_host_put_page (void *addr)
mmu.c:244"]
    kvm_host_put_page -> put_page
    kvm_host_put_page -> virt_to_page
    put_page [label="put_page()"]
    kvm_hyp_reserve [label="void __init kvm_hyp_reserve (void)
pkvm.c:59"]
    kvm_hyp_reserve -> is_hyp_mode_available
    kvm_hyp_reserve -> is_kernel_in_hyp_mode
    kvm_hyp_reserve -> kvm_get_mode
    kvm_hyp_reserve -> register_memblock_regions
    kvm_hyp_reserve -> kvm_err
    kvm_hyp_reserve -> hyp_s1_pgtable_pages
    kvm_hyp_reserve -> host_s2_pgtable_pages
    kvm_hyp_reserve -> hyp_vm_table_pages
    kvm_hyp_reserve -> hyp_vmemmap_pages
    kvm_hyp_reserve -> hyp_ffa_proxy_pages
    kvm_hyp_reserve -> memblock_phys_alloc
    kvm_hyp_reserve -> ALIGN
    kvm_hyp_reserve -> kvm_info
    register_memblock_regions [label="int __init register_memblock_regions (void)
pkvm.c:43"]
    register_memblock_regions -> for_each_mem_region
    register_memblock_regions -> sort_memblock_regions
    for_each_mem_region [label="for_each_mem_region()"]
    sort_memblock_regions [label="void __init sort_memblock_regions (void)
pkvm.c:34"]
    sort_memblock_regions -> sort
    sort_memblock_regions -> cmp_hyp_memblock
    sort [label="sort()"]
    cmp_hyp_memblock [label="int cmp_hyp_memblock (const void *p1, const void *p2)
pkvm.c:26"]
    hyp_s1_pgtable_pages [label="hyp_s1_pgtable_pages()"]
    host_s2_pgtable_pages [label="host_s2_pgtable_pages()"]
    hyp_vm_table_pages [label="hyp_vm_table_pages()"]
    hyp_vmemmap_pages [label="hyp_vmemmap_pages()"]
    hyp_ffa_proxy_pages [label="hyp_ffa_proxy_pages()"]
    memblock_phys_alloc [label="memblock_phys_alloc()"]
    kvm_hyp_zalloc_page [label="void *kvm_hyp_zalloc_page (void *arg)
mmu.c:1844"]
    kvm_hyp_zalloc_page -> get_zeroed_page
    get_zeroed_page [label="get_zeroed_page()"]
    kvm_inject_nested_irq [label="int kvm_inject_nested_irq (struct kvm_vcpu *vcpu)
emulate-nested.c:2104"]
    kvm_inject_nested_irq -> vcpu_is_el2
    kvm_inject_nested_irq -> vcpu_el2_tge_is_set
    kvm_inject_nested_irq -> kvm_inject_nested
    vcpu_is_el2 [label="vcpu_is_el2()"]
    kvm_patch_vector_branch [label="void kvm_patch_vector_branch (struct alt_instr *alt, __le32 *origptr, __le32 *updptr, int nr_inst)
va_layout.c:188"]
    kvm_patch_vector_branch -> BUG_ON
    kvm_patch_vector_branch -> cpus_have_cap
    kvm_patch_vector_branch -> WARN_ON_ONCE
    kvm_patch_vector_branch -> kvm_ksym_ref
    kvm_patch_vector_branch -> GENMASK_ULL
    kvm_patch_vector_branch -> aarch64_insn_gen_movewide
    kvm_patch_vector_branch -> cpu_to_le32
    kvm_patch_vector_branch -> aarch64_insn_gen_branch_reg
    cpus_have_cap [label="cpus_have_cap()"]
    aarch64_insn_gen_branch_reg [label="aarch64_insn_gen_branch_reg()"]
    kvm_phys_addr_ioremap [label="int kvm_phys_addr_ioremap (struct kvm *kvm, phys_addr_t guest_ipa, phys_addr_t pa, unsigned long size, bool writable)
mmu.c:1064"]
    kvm_phys_addr_ioremap -> is_protected_kvm_enabled
    kvm_phys_addr_ioremap -> offset_in_page
    kvm_phys_addr_ioremap -> kvm_mmu_topup_memory_cache
    kvm_phys_addr_ioremap -> kvm_mmu_cache_min_pages
    kvm_phys_addr_ioremap -> write_lock
    kvm_phys_addr_ioremap -> kvm_pgtable_stage2_map
    kvm_phys_addr_ioremap -> write_unlock
    kvm_phys_addr_ioremap -> kvm_mmu_free_memory_cache
    kvm_read_sanitised_id_reg [label="u64 kvm_read_sanitised_id_reg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:1434"]
    kvm_s2_free_pages_exact [label="void kvm_s2_free_pages_exact (void *virt, size_t size)
mmu.c:214"]
    kvm_s2_free_pages_exact -> kvm_account_pgtable_pages
    kvm_s2_free_pages_exact -> free_pages_exact
    kvm_account_pgtable_pages [label="kvm_account_pgtable_pages()"]
    free_pages_exact [label="free_pages_exact()"]
    kvm_s2_put_page [label="void kvm_s2_put_page (void *addr)
mmu.c:249"]
    kvm_s2_put_page -> virt_to_page
    kvm_s2_put_page -> page_count
    kvm_s2_put_page -> kvm_account_pgtable_pages
    kvm_s2_put_page -> put_page
    kvm_s2_zalloc_pages_exact [label="void *kvm_s2_zalloc_pages_exact (size_t size)
mmu.c:205"]
    kvm_s2_zalloc_pages_exact -> kvm_host_zalloc_pages_exact
    kvm_s2_zalloc_pages_exact -> kvm_account_pgtable_pages
    kvm_host_zalloc_pages_exact [label="void *kvm_host_zalloc_pages_exact (size_t size)
mmu.c:200"]
    kvm_host_zalloc_pages_exact -> alloc_pages_exact
    alloc_pages_exact [label="alloc_pages_exact()"]
    kvm_set_pmu_events [label="void kvm_set_pmu_events (u32 set, struct perf_event_attr *attr)
pmu.c:38"]
    kvm_set_pmu_events -> kvm_get_pmu_events
    kvm_set_pmu_events -> kvm_arm_support_pmu_v3
    kvm_set_pmu_events -> kvm_pmu_switch_needed
    kvm_pmu_switch_needed [label="bool kvm_pmu_switch_needed (struct perf_event_attr *attr)
pmu.c:15"]
    kvm_pmu_switch_needed -> has_vhe
    kvm_set_pmuserenr [label="bool kvm_set_pmuserenr (u64 val)
pmu.c:223"]
    kvm_set_pmuserenr -> kvm_arm_support_pmu_v3
    kvm_set_pmuserenr -> has_vhe
    kvm_set_pmuserenr -> kvm_get_running_vcpu
    kvm_set_pmuserenr -> vcpu_get_flag
    kvm_set_pmuserenr -> this_cpu_ptr
    kvm_set_pmuserenr -> ctxt_sys_reg
    ctxt_sys_reg [label="ctxt_sys_reg()"]
    kvm_set_spte_gfn [label="bool kvm_set_spte_gfn (struct kvm *kvm, struct kvm_gfn_range *range)
mmu.c:1764"]
    kvm_set_spte_gfn -> pte_pfn
    kvm_set_spte_gfn -> WARN_ON
    kvm_set_spte_gfn -> kvm_has_mte
    kvm_set_spte_gfn -> page_mte_tagged
    kvm_set_spte_gfn -> pfn_to_page
    kvm_set_spte_gfn -> kvm_pgtable_stage2_map
    pte_pfn [label="pte_pfn()"]
    kvm_test_age_gfn [label="bool kvm_test_age_gfn (struct kvm *kvm, struct kvm_gfn_range *range)
mmu.c:1810"]
    kvm_test_age_gfn -> kvm_pgtable_stage2_test_clear_young
    kvm_unmap_gfn_range [label="bool kvm_unmap_gfn_range (struct kvm *kvm, struct kvm_gfn_range *range)
mmu.c:1752"]
    kvm_update_va_mask [label="void __init kvm_update_va_mask (struct alt_instr *alt, __le32 *origptr, __le32 *updptr, int nr_inst)
va_layout.c:154"]
    kvm_update_va_mask -> BUG_ON
    kvm_update_va_mask -> cpus_have_cap
    kvm_update_va_mask -> cpu_to_le32
    kvm_update_va_mask -> aarch64_insn_gen_nop
    kvm_update_va_mask -> le32_to_cpu
    kvm_update_va_mask -> aarch64_insn_decode_register
    kvm_update_va_mask -> compute_instruction
    aarch64_insn_gen_nop [label="aarch64_insn_gen_nop()"]
    compute_instruction [label="u32 compute_instruction (int n, u32 rd, u32 rn)
va_layout.c:112"]
    compute_instruction -> aarch64_insn_gen_logical_immediate
    compute_instruction -> aarch64_insn_gen_extr
    compute_instruction -> aarch64_insn_gen_add_sub_imm
    compute_instruction -> GENMASK
    aarch64_insn_gen_logical_immediate [label="aarch64_insn_gen_logical_immediate()"]
    aarch64_insn_gen_extr [label="aarch64_insn_gen_extr()"]
    aarch64_insn_gen_add_sub_imm [label="aarch64_insn_gen_add_sub_imm()"]
    kvm_vcpu_pmu_resync_el0 [label="void kvm_vcpu_pmu_resync_el0 (void)
pmu.c:244"]
    kvm_vcpu_pmu_resync_el0 -> has_vhe
    kvm_vcpu_pmu_resync_el0 -> in_interrupt
    kvm_vcpu_pmu_resync_el0 -> kvm_get_running_vcpu
    kvm_vcpu_pmu_resync_el0 -> kvm_make_request
    in_interrupt [label="in_interrupt()"]
    kvm_vm_ioctl_check_extension [label="int kvm_vm_ioctl_check_extension (struct kvm *kvm, long ext)
arm.c:216"]
    kvm_vm_ioctl_check_extension -> min_t
    kvm_vm_ioctl_check_extension -> num_online_cpus
    kvm_vm_ioctl_check_extension -> kvm_arm_default_max_vcpus
    kvm_vm_ioctl_check_extension -> system_supports_mte
    kvm_vm_ioctl_check_extension -> kvm_arm_pvtime_supported
    kvm_vm_ioctl_check_extension -> cpus_have_final_cap
    kvm_vm_ioctl_check_extension -> get_num_brps
    kvm_vm_ioctl_check_extension -> get_num_wrps
    kvm_vm_ioctl_check_extension -> kvm_arm_support_pmu_v3
    kvm_vm_ioctl_check_extension -> get_kvm_ipa_limit
    kvm_vm_ioctl_check_extension -> system_supports_sve
    kvm_vm_ioctl_check_extension -> system_has_full_ptr_auth
    kvm_vm_ioctl_check_extension -> kvm_supported_block_sizes
    kvm_vm_ioctl_check_extension -> BIT
    min_t [label="min_t()"]
    num_online_cpus [label="num_online_cpus()"]
    system_supports_mte [label="system_supports_mte()"]
    kvm_supported_block_sizes [label="kvm_supported_block_sizes()"]
    kvm_vm_ioctl_enable_cap [label="int kvm_vm_ioctl_enable_cap (struct kvm *kvm, struct kvm_enable_cap *cap)
arm.c:72"]
    kvm_vm_ioctl_enable_cap -> set_bit
    kvm_vm_ioctl_enable_cap -> mutex_lock
    kvm_vm_ioctl_enable_cap -> system_supports_mte
    kvm_vm_ioctl_enable_cap -> mutex_unlock
    kvm_vm_ioctl_enable_cap -> kvm_are_all_memslots_empty
    kvm_vm_ioctl_enable_cap -> kvm_is_block_size_supported
    kvm_are_all_memslots_empty [label="kvm_are_all_memslots_empty()"]
    kvm_is_block_size_supported [label="kvm_is_block_size_supported()"]
    kvm_vm_ioctl_irq_line [label="int kvm_vm_ioctl_irq_line (struct kvm *kvm, struct kvm_irq_level *irq_level, bool line_status)
arm.c:1191"]
    kvm_vm_ioctl_irq_line -> trace_kvm_irq_line
    kvm_vm_ioctl_irq_line -> irqchip_in_kernel
    kvm_vm_ioctl_irq_line -> kvm_get_vcpu_by_id
    kvm_vm_ioctl_irq_line -> vcpu_interrupt_line
    kvm_vm_ioctl_irq_line -> kvm_vgic_inject_irq
    trace_kvm_irq_line [label="trace_kvm_irq_line()"]
    kvm_get_vcpu_by_id [label="kvm_get_vcpu_by_id()"]
    vcpu_interrupt_line [label="int vcpu_interrupt_line (struct kvm_vcpu *vcpu, int number, bool level)
arm.c:1157"]
    vcpu_interrupt_line -> vcpu_hcr
    vcpu_interrupt_line -> test_and_set_bit
    vcpu_interrupt_line -> test_and_clear_bit
    vcpu_interrupt_line -> kvm_make_request
    vcpu_interrupt_line -> kvm_vcpu_kick
    test_and_set_bit [label="test_and_set_bit()"]
    test_and_clear_bit [label="test_and_clear_bit()"]
    mte_visibility [label="unsigned int mte_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1862"]
    mte_visibility -> kvm_has_mte
    nvhe_hyp_panic_handler [label="void __noreturn __cold nvhe_hyp_panic_handler (u64 esr, u64 spsr, u64 elr_virt, u64 elr_phys, u64 par, uintptr_t vcpu, u64 far, u64 hpfar)
handle_exit.c:386"]
    nvhe_hyp_panic_handler -> kaslr_offset
    nvhe_hyp_panic_handler -> kvm_err
    nvhe_hyp_panic_handler -> ESR_ELx_EC
    nvhe_hyp_panic_handler -> is_protected_kvm_enabled
    nvhe_hyp_panic_handler -> IS_ENABLED
    nvhe_hyp_panic_handler -> find_bug
    nvhe_hyp_panic_handler -> bug_get_file_line
    nvhe_hyp_panic_handler -> kvm_nvhe_dump_backtrace
    nvhe_hyp_panic_handler -> panic
    kaslr_offset [label="kaslr_offset()"]
    find_bug [label="find_bug()"]
    bug_get_file_line [label="bug_get_file_line()"]
    kvm_nvhe_dump_backtrace [label="void kvm_nvhe_dump_backtrace (unsigned long hyp_offset)
stacktrace.c:239"]
    kvm_nvhe_dump_backtrace -> is_protected_kvm_enabled
    kvm_nvhe_dump_backtrace -> pkvm_dump_backtrace
    kvm_nvhe_dump_backtrace -> hyp_dump_backtrace
    pkvm_dump_backtrace [label="void pkvm_dump_backtrace (unsigned long hyp_offset)
stacktrace.c:228"]
    pkvm_dump_backtrace -> this_cpu_ptr_nvhe_sym
    pkvm_dump_backtrace -> kvm_nvhe_dump_backtrace_start
    pkvm_dump_backtrace -> ARRAY_SIZE
    pkvm_dump_backtrace -> kvm_nvhe_sym
    pkvm_dump_backtrace -> kvm_nvhe_dump_backtrace_entry
    pkvm_dump_backtrace -> kvm_nvhe_dump_backtrace_end
    pkvm_dump_backtrace -> kvm_err
    kvm_nvhe_dump_backtrace_start [label="void kvm_nvhe_dump_backtrace_start (void)
stacktrace.c:158"]
    kvm_nvhe_dump_backtrace_start -> kvm_err
    kvm_nvhe_dump_backtrace_entry [label="bool kvm_nvhe_dump_backtrace_entry (void *arg, unsigned long where)
stacktrace.c:146"]
    kvm_nvhe_dump_backtrace_entry -> GENMASK_ULL
    kvm_nvhe_dump_backtrace_entry -> kvm_err
    kvm_nvhe_dump_backtrace_entry -> kaslr_offset
    kvm_nvhe_dump_backtrace_end [label="void kvm_nvhe_dump_backtrace_end (void)
stacktrace.c:163"]
    kvm_nvhe_dump_backtrace_end -> kvm_err
    hyp_dump_backtrace [label="void hyp_dump_backtrace (unsigned long hyp_offset)
stacktrace.c:178"]
    hyp_dump_backtrace -> stackinfo_get_overflow_kern_va
    hyp_dump_backtrace -> stackinfo_get_hyp_kern_va
    hyp_dump_backtrace -> ARRAY_SIZE
    hyp_dump_backtrace -> this_cpu_ptr_nvhe_sym
    hyp_dump_backtrace -> kvm_nvhe_unwind_init
    hyp_dump_backtrace -> kvm_nvhe_dump_backtrace_start
    hyp_dump_backtrace -> unwind
    hyp_dump_backtrace -> kvm_nvhe_dump_backtrace_entry
    hyp_dump_backtrace -> kvm_nvhe_dump_backtrace_end
    stackinfo_get_overflow_kern_va [label="struct stack_info stackinfo_get_overflow_kern_va (void)
stacktrace.c:37"]
    stackinfo_get_overflow_kern_va -> this_cpu_ptr_nvhe_sym
    stackinfo_get_hyp_kern_va [label="struct stack_info stackinfo_get_hyp_kern_va (void)
stacktrace.c:61"]
    stackinfo_get_hyp_kern_va -> this_cpu_ptr
    kvm_nvhe_unwind_init [label="kvm_nvhe_unwind_init()"]
    unwind [label="void unwind (struct unwind_state *state, stack_trace_consume_fn consume_entry, void *cookie)
stacktrace.c:126"]
    unwind -> unwind_next
    unwind_next [label="int unwind_next (struct unwind_state *state)
stacktrace.c:114"]
    unwind_next -> kvm_nvhe_stack_kern_record_va
    unwind_next -> unwind_next_frame_record
    kvm_nvhe_stack_kern_record_va [label="bool kvm_nvhe_stack_kern_record_va (unsigned long *addr)
stacktrace.c:109"]
    kvm_nvhe_stack_kern_record_va -> kvm_nvhe_stack_kern_va
    kvm_nvhe_stack_kern_va [label="bool kvm_nvhe_stack_kern_va (unsigned long *addr, unsigned long size)
stacktrace.c:85"]
    kvm_nvhe_stack_kern_va -> stackinfo_get_hyp
    kvm_nvhe_stack_kern_va -> stackinfo_get_hyp_kern_va
    kvm_nvhe_stack_kern_va -> stackinfo_on_stack
    kvm_nvhe_stack_kern_va -> stackinfo_get_overflow
    kvm_nvhe_stack_kern_va -> stackinfo_get_overflow_kern_va
    stackinfo_get_hyp [label="struct stack_info stackinfo_get_hyp (void)
stacktrace.c:48"]
    stackinfo_get_hyp -> this_cpu_ptr_nvhe_sym
    stackinfo_on_stack [label="stackinfo_on_stack()"]
    stackinfo_get_overflow [label="struct stack_info stackinfo_get_overflow (void)
stacktrace.c:24"]
    stackinfo_get_overflow -> this_cpu_ptr_nvhe_sym
    unwind_next_frame_record [label="unwind_next_frame_record()"]
    panic [label="panic()"]
    pmu_visibility [label="unsigned int pmu_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:711"]
    pmu_visibility -> kvm_vcpu_has_pmu
    print_nv_trap_error [label="__init void print_nv_trap_error (const struct encoding_to_trap_config *tc, const char *type, int err)
emulate-nested.c:1686"]
    print_nv_trap_error -> kvm_err
    print_nv_trap_error -> sys_reg_Op0
    print_nv_trap_error -> sys_reg_Op1
    print_nv_trap_error -> sys_reg_CRn
    print_nv_trap_error -> sys_reg_CRm
    print_nv_trap_error -> sys_reg_Op2
    sys_reg_Op2 [label="sys_reg_Op2()"]
    ptrauth_visibility [label="unsigned int ptrauth_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1222"]
    ptrauth_visibility -> vcpu_has_ptrauth
    raz_visibility [label="unsigned int raz_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:1492"]
    read_sanitised_id_aa64dfr0_el1 [label="u64 read_sanitised_id_aa64dfr0_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1568"]
    read_sanitised_id_aa64dfr0_el1 -> read_sanitised_ftr_reg
    read_sanitised_id_aa64dfr0_el1 -> ID_REG_LIMIT_FIELD_ENUM
    read_sanitised_id_aa64dfr0_el1 -> kvm_vcpu_has_pmu
    read_sanitised_id_aa64dfr0_el1 -> SYS_FIELD_PREP
    read_sanitised_id_aa64dfr0_el1 -> kvm_arm_pmu_get_pmuver_limit
    ID_REG_LIMIT_FIELD_ENUM [label="ID_REG_LIMIT_FIELD_ENUM()"]
    read_sanitised_id_aa64pfr0_el1 [label="u64 read_sanitised_id_aa64pfr0_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1524"]
    read_sanitised_id_aa64pfr0_el1 -> read_sanitised_ftr_reg
    read_sanitised_id_aa64pfr0_el1 -> vcpu_has_sve
    read_sanitised_id_aa64pfr0_el1 -> arm64_get_spectre_v2_state
    read_sanitised_id_aa64pfr0_el1 -> SYS_FIELD_PREP_ENUM
    read_sanitised_id_aa64pfr0_el1 -> arm64_get_meltdown_state
    SYS_FIELD_PREP_ENUM [label="SYS_FIELD_PREP_ENUM()"]
    read_sanitised_id_dfr0_el1 [label="u64 read_sanitised_id_dfr0_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1623"]
    read_sanitised_id_dfr0_el1 -> pmuver_to_perfmon
    read_sanitised_id_dfr0_el1 -> kvm_arm_pmu_get_pmuver_limit
    read_sanitised_id_dfr0_el1 -> read_sanitised_ftr_reg
    read_sanitised_id_dfr0_el1 -> kvm_vcpu_has_pmu
    read_sanitised_id_dfr0_el1 -> SYS_FIELD_PREP
    read_sanitised_id_dfr0_el1 -> ID_REG_LIMIT_FIELD_ENUM
    pmuver_to_perfmon [label="u8 pmuver_to_perfmon (u8 pmuver)
sys_regs.c:1377"]
    reset_actlr [label="u64 reset_actlr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:684"]
    reset_actlr -> read_sysreg
    reset_actlr -> vcpu_write_sys_reg
    reset_amair_el1 [label="u64 reset_amair_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:677"]
    reset_amair_el1 -> read_sysreg
    reset_amair_el1 -> vcpu_write_sys_reg
    reset_bcr [label="u64 reset_bcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:595"]
    reset_bvr [label="u64 reset_bvr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:558"]
    reset_clidr [label="u64 reset_clidr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:1768"]
    reset_clidr -> read_sanitised_ftr_reg
    reset_clidr -> CLIDR_CTYPE_SHIFT
    reset_clidr -> kvm_has_mte
    reset_clidr -> CLIDR_TTYPE_SHIFT
    CLIDR_CTYPE_SHIFT [label="CLIDR_CTYPE_SHIFT()"]
    CLIDR_TTYPE_SHIFT [label="CLIDR_TTYPE_SHIFT()"]
    reset_mpidr [label="u64 reset_mpidr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:691"]
    reset_mpidr -> MPIDR_LEVEL_SHIFT
    reset_mpidr -> vcpu_write_sys_reg
    MPIDR_LEVEL_SHIFT [label="MPIDR_LEVEL_SHIFT()"]
    reset_pmcr [label="u64 reset_pmcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:762"]
    reset_pmcr -> kvm_supports_32bit_el0
    reset_pmevcntr [label="u64 reset_pmevcntr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:734"]
    reset_pmevcntr -> reset_unknown
    reset_pmevcntr -> GENMASK
    reset_unknown [label="reset_unknown()"]
    reset_pmevtyper [label="u64 reset_pmevtyper (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:742"]
    reset_pmevtyper -> kvm_vcpu_has_pmu
    reset_pmevtyper -> reset_unknown
    reset_pmevtyper -> kvm_pmu_evtyper_mask
    reset_pmselr [label="u64 reset_pmselr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:754"]
    reset_pmselr -> reset_unknown
    reset_pmu_reg [label="u64 reset_pmu_reg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r)
sys_regs.c:720"]
    reset_pmu_reg -> BIT
    reset_pmu_reg -> GENMASK
    reset_pmu_reg -> reset_unknown
    reset_wcr [label="u64 reset_wcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:670"]
    reset_wvr [label="u64 reset_wvr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:633"]
    set_bcr [label="int set_bcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:581"]
    set_bvr [label="int set_bvr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:544"]
    set_clidr [label="int set_clidr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:1820"]
    set_clidr -> read_sanitised_ftr_reg
    set_clidr -> CLIDR_LOC
    set_clidr -> CLIDR_LOUIS
    set_clidr -> CLIDR_LOUU
    CLIDR_LOC [label="CLIDR_LOC()"]
    CLIDR_LOUIS [label="CLIDR_LOUIS()"]
    CLIDR_LOUU [label="CLIDR_LOUU()"]
    set_gic_ap0r [label="int set_gic_ap0r (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:228"]
    set_gic_ap0r -> vgic_v3_max_apr_idx
    set_gic_ap0r -> set_apr_reg
    set_apr_reg [label="void set_apr_reg (struct kvm_vcpu *vcpu, u64 val, u8 apr, u8 idx)
vgic-sys-reg-v3.c:208"]
    set_gic_ap1r [label="int set_gic_ap1r (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:254"]
    set_gic_ap1r -> vgic_v3_max_apr_idx
    set_gic_ap1r -> set_apr_reg
    set_gic_bpr0 [label="int set_gic_bpr0 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:110"]
    set_gic_bpr0 -> vgic_get_vmcr
    set_gic_bpr0 -> FIELD_GET
    set_gic_bpr0 -> vgic_set_vmcr
    vgic_set_vmcr [label="vgic_set_vmcr()"]
    set_gic_bpr1 [label="int set_gic_bpr1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:133"]
    set_gic_bpr1 -> vgic_get_vmcr
    set_gic_bpr1 -> FIELD_GET
    set_gic_bpr1 -> vgic_set_vmcr
    set_gic_ctlr [label="int set_gic_ctlr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:13"]
    set_gic_ctlr -> vgic_get_vmcr
    set_gic_ctlr -> FIELD_GET
    set_gic_ctlr -> vgic_set_vmcr
    set_gic_grpen0 [label="int set_gic_grpen0 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:162"]
    set_gic_grpen0 -> vgic_get_vmcr
    set_gic_grpen0 -> FIELD_GET
    set_gic_grpen0 -> vgic_set_vmcr
    set_gic_grpen1 [label="int set_gic_grpen1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:185"]
    set_gic_grpen1 -> vgic_get_vmcr
    set_gic_grpen1 -> FIELD_GET
    set_gic_grpen1 -> vgic_set_vmcr
    set_gic_pmr [label="int set_gic_pmr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:87"]
    set_gic_pmr -> vgic_get_vmcr
    set_gic_pmr -> FIELD_GET
    set_gic_pmr -> vgic_set_vmcr
    set_gic_sre [label="int set_gic_sre (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
vgic-sys-reg-v3.c:280"]
    set_id_aa64dfr0_el1 [label="int set_id_aa64dfr0_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:1589"]
    set_id_aa64dfr0_el1 -> SYS_FIELD_GET
    set_id_aa64dfr0_el1 -> set_id_reg
    set_id_reg [label="int set_id_reg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:1691"]
    set_id_reg -> reg_to_encoding
    set_id_reg -> mutex_lock
    set_id_reg -> kvm_vm_has_ran_once
    set_id_reg -> read_id_reg
    set_id_reg -> mutex_unlock
    set_id_reg -> arm64_check_features
    set_id_reg -> IDREG
    arm64_check_features [label="int arm64_check_features (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:1324"]
    arm64_check_features -> reg_to_encoding
    arm64_check_features -> sysreg_visible_as_raz
    arm64_check_features -> get_arm64_ftr_reg
    arm64_check_features -> arm64_ftr_mask
    arm64_check_features -> arm64_ftr_value
    arm64_check_features -> kvm_arm64_ftr_safe_value
    sysreg_visible_as_raz [label="sysreg_visible_as_raz()"]
    get_arm64_ftr_reg [label="get_arm64_ftr_reg()"]
    arm64_ftr_mask [label="arm64_ftr_mask()"]
    arm64_ftr_value [label="arm64_ftr_value()"]
    kvm_arm64_ftr_safe_value [label="s64 kvm_arm64_ftr_safe_value (u32 id, const struct arm64_ftr_bits *ftrp, s64 new, s64 cur)
sys_regs.c:1286"]
    kvm_arm64_ftr_safe_value -> arm64_ftr_safe_value
    arm64_ftr_safe_value [label="arm64_ftr_safe_value()"]
    set_id_dfr0_el1 [label="int set_id_dfr0_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:1638"]
    set_id_dfr0_el1 -> SYS_FIELD_GET
    set_id_dfr0_el1 -> set_id_reg
    set_oslsr_el1 [label="int set_oslsr_el1 (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:425"]
    set_pmcr [label="int set_pmcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
sys_regs.c:1143"]
    set_pmcr -> mutex_lock
    set_pmcr -> kvm_vm_has_ran_once
    set_pmcr -> kvm_arm_pmu_get_max_counters
    set_pmcr -> mutex_unlock
    set_pmcr -> kvm_supports_32bit_el0
    set_pmreg [label="int set_pmreg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *r, u64 val)
sys_regs.c:994"]
    set_pmreg -> kvm_pmu_valid_counter_mask
    set_wcr [label="int set_wcr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:656"]
    set_wi_reg [label="int set_wi_reg (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:1738"]
    set_wvr [label="int set_wvr (struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd, u64 val)
sys_regs.c:619"]
    stage2_free_unlinked_table [label="void stage2_free_unlinked_table (void *addr, u32 level)
mmu.c:231"]
    stage2_free_unlinked_table -> virt_to_page
    stage2_free_unlinked_table -> set_page_private
    stage2_free_unlinked_table -> call_rcu
    stage2_free_unlinked_table -> stage2_free_unlinked_table_rcu_cb
    set_page_private [label="set_page_private()"]
    call_rcu [label="call_rcu()"]
    stage2_free_unlinked_table_rcu_cb [label="void stage2_free_unlinked_table_rcu_cb (struct rcu_head *head)
mmu.c:222"]
    stage2_free_unlinked_table_rcu_cb -> container_of
    stage2_free_unlinked_table_rcu_cb -> page_to_virt
    stage2_free_unlinked_table_rcu_cb -> page_private
    stage2_free_unlinked_table_rcu_cb -> kvm_pgtable_stage2_free_unlinked
    page_private [label="page_private()"]
    kvm_pgtable_stage2_free_unlinked [label="kvm_pgtable_stage2_free_unlinked()"]
    stage2_memcache_zalloc_page [label="void *stage2_memcache_zalloc_page (void *arg)
mmu.c:188"]
    stage2_memcache_zalloc_page -> kvm_mmu_memory_cache_alloc
    stage2_memcache_zalloc_page -> kvm_account_pgtable_pages
    kvm_mmu_memory_cache_alloc [label="kvm_mmu_memory_cache_alloc()"]
    sve_visibility [label="unsigned int sve_visibility (const struct kvm_vcpu *vcpu, const struct sys_reg_desc *rd)
sys_regs.c:1515"]
    sve_visibility -> vcpu_has_sve
    timer_irq_ack [label="void timer_irq_ack (struct irq_data *d)
arch_timer.c:1273"]
    timer_irq_domain_alloc [label="int timer_irq_domain_alloc (struct irq_domain *domain, unsigned int virq, unsigned int nr_irqs, void *arg)
arch_timer.c:1291"]
    timer_irq_domain_alloc -> irq_domain_set_hwirq_and_chip
    irq_domain_set_hwirq_and_chip [label="irq_domain_set_hwirq_and_chip()"]
    timer_irq_domain_free [label="void timer_irq_domain_free (struct irq_domain *domain, unsigned int virq, unsigned int nr_irqs)
arch_timer.c:1300"]
    timer_irq_eoi [label="void timer_irq_eoi (struct irq_data *d)
arch_timer.c:1267"]
    timer_irq_eoi -> irqd_is_forwarded_to_vcpu
    timer_irq_eoi -> irq_chip_eoi_parent
    irqd_is_forwarded_to_vcpu [label="irqd_is_forwarded_to_vcpu()"]
    irq_chip_eoi_parent [label="irq_chip_eoi_parent()"]
    timer_irq_set_irqchip_state [label="int timer_irq_set_irqchip_state (struct irq_data *d, enum irqchip_irq_state which, bool val)
arch_timer.c:1253"]
    timer_irq_set_irqchip_state -> irqd_is_forwarded_to_vcpu
    timer_irq_set_irqchip_state -> irq_chip_set_parent_state
    timer_irq_set_irqchip_state -> irq_chip_mask_parent
    timer_irq_set_irqchip_state -> irq_chip_unmask_parent
    irq_chip_set_parent_state [label="irq_chip_set_parent_state()"]
    irq_chip_mask_parent [label="irq_chip_mask_parent()"]
    irq_chip_unmask_parent [label="irq_chip_unmask_parent()"]
    timer_irq_set_vcpu_affinity [label="int timer_irq_set_vcpu_affinity (struct irq_data *d, void *vcpu)
arch_timer.c:1243"]
    timer_irq_set_vcpu_affinity -> irqd_set_forwarded_to_vcpu
    timer_irq_set_vcpu_affinity -> irqd_clr_forwarded_to_vcpu
    irqd_set_forwarded_to_vcpu [label="irqd_set_forwarded_to_vcpu()"]
    irqd_clr_forwarded_to_vcpu [label="irqd_clr_forwarded_to_vcpu()"]
    topup_hyp_memcache [label="int topup_hyp_memcache (struct kvm_hyp_memcache *mc, unsigned long min_pages)
mmu.c:1046"]
    topup_hyp_memcache -> is_protected_kvm_enabled
    topup_hyp_memcache -> hyp_mc_alloc_fn
    topup_hyp_memcache -> kvm_host_pa
    hyp_mc_alloc_fn [label="void *hyp_mc_alloc_fn (void *unused)
mmu.c:1034"]
    kvm_host_pa [label="phys_addr_t kvm_host_pa (void *addr)
mmu.c:263"]
    trap_bcr [label="bool trap_bcr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *rd)
sys_regs.c:565"]
    trap_bcr -> reg_to_dbg
    trap_bcr -> dbg_to_reg
    trap_bcr -> trace_trap_reg
    reg_to_dbg [label="void reg_to_dbg (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *rd, u64 *dbg_reg)
sys_regs.c:500"]
    reg_to_dbg -> get_access_mask
    reg_to_dbg -> vcpu_set_flag
    dbg_to_reg [label="void dbg_to_reg (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *rd, u64 *dbg_reg)
sys_regs.c:517"]
    dbg_to_reg -> get_access_mask
    trace_trap_reg [label="trace_trap_reg()"]
    trap_bvr [label="bool trap_bvr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *rd)
sys_regs.c:528"]
    trap_bvr -> reg_to_dbg
    trap_bvr -> dbg_to_reg
    trap_bvr -> trace_trap_reg
    trap_dbgauthstatus_el1 [label="bool trap_dbgauthstatus_el1 (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:439"]
    trap_dbgauthstatus_el1 -> ignore_write
    trap_dbgauthstatus_el1 -> read_sysreg
    trap_dbgdidr [label="bool trap_dbgdidr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:2593"]
    trap_dbgdidr -> ignore_write
    trap_dbgdidr -> IDREG
    trap_dbgdidr -> SYS_FIELD_GET
    trap_debug_regs [label="bool trap_debug_regs (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:478"]
    trap_debug_regs -> access_rw
    trap_debug_regs -> vcpu_set_flag
    trap_debug_regs -> trace_trap_reg
    access_rw [label="bool access_rw (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:181"]
    access_rw -> vcpu_write_sys_reg
    access_rw -> vcpu_read_sys_reg
    trap_loregion [label="bool trap_loregion (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:378"]
    trap_loregion -> IDREG
    trap_loregion -> reg_to_encoding
    trap_loregion -> kvm_inject_undefined
    trap_loregion -> write_to_read_only
    trap_loregion -> trap_raz_wi
    trap_raz_wi [label="bool trap_raz_wi (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:354"]
    trap_raz_wi -> ignore_write
    trap_raz_wi -> read_zero
    read_zero [label="read_zero()"]
    trap_oslar_el1 [label="bool trap_oslar_el1 (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:396"]
    trap_oslar_el1 -> read_from_write_only
    trap_oslsr_el1 [label="bool trap_oslsr_el1 (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:414"]
    trap_oslsr_el1 -> write_to_read_only
    trap_undef [label="bool trap_undef (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:364"]
    trap_undef -> kvm_inject_undefined
    trap_wcr [label="bool trap_wcr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *rd)
sys_regs.c:640"]
    trap_wcr -> reg_to_dbg
    trap_wcr -> dbg_to_reg
    trap_wcr -> trace_trap_reg
    trap_wvr [label="bool trap_wvr (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *rd)
sys_regs.c:602"]
    trap_wvr -> reg_to_dbg
    trap_wvr -> dbg_to_reg
    trap_wvr -> trace_trap_reg
    undef_access [label="bool undef_access (struct kvm_vcpu *vcpu, struct sys_reg_params *p, const struct sys_reg_desc *r)
sys_regs.c:1208"]
    undef_access -> kvm_inject_undefined
    vgic_v3_cpu_sysregs_uaccess [label="int vgic_v3_cpu_sysregs_uaccess (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr, bool is_write)
vgic-sys-reg-v3.c:351"]
    vgic_v3_cpu_sysregs_uaccess -> attr_to_id
    vgic_v3_cpu_sysregs_uaccess -> kvm_sys_reg_set_user
    vgic_v3_cpu_sysregs_uaccess -> ARRAY_SIZE
    vgic_v3_cpu_sysregs_uaccess -> kvm_sys_reg_get_user
    attr_to_id [label="u64 attr_to_id (u64 attr)
vgic-sys-reg-v3.c:333"]
    attr_to_id -> ARM64_SYS_REG
    attr_to_id -> FIELD_GET
    ARM64_SYS_REG [label="ARM64_SYS_REG()"]
    vgic_v3_has_cpu_sysregs_attr [label="int vgic_v3_has_cpu_sysregs_attr (struct kvm_vcpu *vcpu, struct kvm_device_attr *attr)
vgic-sys-reg-v3.c:342"]
    vgic_v3_has_cpu_sysregs_attr -> get_reg_by_id
    vgic_v3_has_cpu_sysregs_attr -> attr_to_id
    vgic_v3_has_cpu_sysregs_attr -> ARRAY_SIZE
}
